(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["system"],{1422:function(e,t,a){e.exports={op:"Fence_op_1V_MP",submit:"Fence_submit_Thr33",point:"Fence_point_16SnX",map:"Fence_map_1p_ia",mask:"Fence_mask_3vxkV"}},"1b8b":function(e,t,a){"use strict";var n=a("6558"),o=a.n(n);t["default"]=o.a},"2c1b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200,isSmall:!0},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},o=[],r=(a("c5f6"),a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("ae85"),m=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"ID",sortable:!0,width:220},{prop:"name",label:"协议名称",width:220},{prop:"port",label:"协议端口号",width:220},{prop:"effect",label:"协议作用",width:220},{prop:"content",label:"协议内容",width:220}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除协议".concat(e.id,"?")).then(function(){return t.$http.post("/api/protocol/deleteProtocol",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){var n,o,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/protocol/getall",{pageSize:Number.MAX_VALUE,currentPage:1});case 5:r=e.sent,n=r.pagedData.datas,o=r.pagedData.totalCount||n.length,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:n});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()}]),t}(Object(d["c"])(f["a"]));m=p["a"]([d["b"]],m);var h=m,b=h,g=a("2877"),v=Object(g["a"])(b,n,o,!1,null,null,null);t["default"]=v.exports},"42de":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{filterable:"","default-first-option":"",multiple:!!e.multiple,disabled:!!e.disabled,"collapse-tags":""},on:{change:e.change},model:{value:e.currValue,callback:function(t){e.currValue=t},expression:"currValue"}},[e.canEmpty?a("el-option",{attrs:{label:"--",value:void 0}}):e._e(),e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)},o=[],r=(a("7514"),a("7f7f"),a("ac6a"),a("d225")),i=a("b0b4"),s=a("308d"),l=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),d=a("2fe1"),f=a("60a3"),m=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.options=[],e.currValue=null,e}return Object(c["a"])(t,e),Object(i["a"])(t,[{key:"created",value:function(){var e=this;this.$http.get(this.url,{pageSize:1e6,currentPage:1}).then(function(t){e.options=t.pagedData.datas.map(function(t){return{id:t[e.keys.id||"id"],name:t[e.keys.name],data:t}}),e.multiple?e.currValue=[]:e.canEmpty||(e.currValue=null==e.value||""===e.value?e.options[0].id:e.value),e.change(e.currValue)}).catch(console.error)}},{key:"change",value:function(e){var t=this;this.$emit("input",e),Array.isArray(e)||(e=[e]),this.$emit("change",e.map(function(e){return t.options.find(function(t){return t.id===e})}))}}]),t}(p["default"]);u["a"]([Object(f["d"])()],m.prototype,"url",void 0),u["a"]([Object(f["d"])()],m.prototype,"value",void 0),u["a"]([Object(f["d"])()],m.prototype,"multiple",void 0),u["a"]([Object(f["d"])()],m.prototype,"disabled",void 0),u["a"]([Object(f["d"])({default:function(){return!1}})],m.prototype,"canEmpty",void 0),u["a"]([Object(f["d"])({default:function(){return{id:"id",name:"name"}}})],m.prototype,"keys",void 0),m=u["a"]([d["b"]],m);var h=m,b=h,g=a("2877"),v=Object(g["a"])(b,n,o,!1,null,null,null);t["a"]=v.exports},"54b6":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{paste:function(t){return e.paste(t)}}},e._l(new Array(e.length).fill(1),function(t,n){return a("el-input",{key:n,ref:"ip",refInFor:!0,class:e.$style.ip,on:{input:function(t){return e.next(n)}},model:{value:e.value[n],callback:function(t){e.$set(e.value,n,t)},expression:"value[i]"}},[n<e.length-1?a("span",{attrs:{slot:"append"},slot:"append"},[e._v(".")]):e._e()])}),1)},o=[],r=(a("c5f6"),a("fca0"),a("ac4d"),a("8a81"),a("28a5"),a("ac6a"),a("5df3"),a("1c4c"),a("20d6"),a("d225")),i=a("b0b4"),s=a("308d"),l=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),d=a("2fe1"),f=a("60a3"),m=function(e){function t(){return Object(r["a"])(this,t),Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(i["a"])(t,[{key:"next",value:function(e){var t=this.value[e],a=this.parseIp(t);return this.$set(this.value,e,a),(a.length>=(this.max+"").length||/^\d+\.$/.test(t))&&e<this.length-1&&this.$refs.ip[e+1].focus(),t.length<=0&&e>0&&this.$refs.ip[e-1].focus(),this.value}},{key:"paste",value:function(e){var t=this,a=this.$refs.ip.findIndex(function(t){return t.$refs.input===e.target});if(a>-1)for(var n=0,o=Array.from(e.clipboardData.items);n<o.length;n++){var r=o[n];"text/plain"===r.type&&r.getAsString(function(e){return t.pasteHandler(e,a)})}return this.value}},{key:"pasteHandler",value:function(e,t){this.$refs.ip;var a=!0,n=!1,o=void 0;try{for(var r,i=e.split(".")[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){var s=r.value;if(t>this.length-1)break;s&&this.$set(this.value,t++,this.parseIp(s).substr(0,3))}}catch(l){n=!0,o=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw o}}}},{key:"parseIp",value:function(e){var t=parseInt(e,10);return Number.isFinite(t)?(t=Math.max(this.min,Math.min(t,this.max)),t+""):""}}]),t}(p["default"]);u["a"]([Object(f["d"])({default:function(){return[]}})],m.prototype,"value",void 0),u["a"]([Object(f["d"])({default:function(){return 0}})],m.prototype,"min",void 0),u["a"]([Object(f["d"])({default:function(){return 255}})],m.prototype,"max",void 0),u["a"]([Object(f["d"])({default:function(){return 4}})],m.prototype,"length",void 0),u["a"]([Object(f["b"])("input")],m.prototype,"next",null),u["a"]([Object(f["b"])("input")],m.prototype,"paste",null),m=u["a"]([d["b"]],m);var h=m,b=h,g=a("1b8b"),v=a("2877");function y(e){this["$style"]=g["default"].locals||g["default"]}var k=Object(v["a"])(b,n,o,!1,y,null,null);t["a"]=k.exports},6558:function(e,t,a){e.exports={ip:"IpInput_ip_1-NJb"}},6807:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticStyle:{padding:"10% 8%"},attrs:{model:e.form,"label-width":"auto"}},[e.showId?a("el-form-item",{attrs:{label:"分组号",prop:"groupCode",required:"",rules:{pattern:/^[0-9A-Fa-f]{1,4}$/,message:"groupCode is not a hexadecimal string less than 4 in length"}}},[a("el-input",{model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1):e._e(),a("el-form-item",{attrs:{label:"最大基站数",prop:"groupBaseSize",required:""}},[a("el-input-number",{attrs:{min:0,"step-strictly":""},model:{value:e.form.groupBaseSize,callback:function(t){e.$set(e.form,"groupBaseSize",t)},expression:"form.groupBaseSize"}})],1),a("el-form-item",{attrs:{label:"最小基站数",prop:"minBaseSize",required:""}},[a("el-input-number",{attrs:{min:0,"step-strictly":""},model:{value:e.form.minBaseSize,callback:function(t){e.$set(e.form,"minBaseSize",t)},expression:"form.minBaseSize"}})],1),a("el-form-item",{attrs:{label:"算法类型",required:""}},[a("el-cascader",{attrs:{options:e.algorithm},model:{value:e.algorithmType,callback:function(t){e.algorithmType=t},expression:"algorithmType"}})],1),a("el-form-item",{attrs:{label:"分组描述"}},[a("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"所属地图"}},[a("app-select",{attrs:{url:"/api/map/getall"},model:{value:e.form.mapId,callback:function(t){e.$set(e.form,"mapId",t)},expression:"form.mapId"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)},o=[],r=(a("c5f6"),a("28a5"),a("f576"),a("cebc")),i=(a("96cf"),a("3b8d")),s=a("d225"),l=a("b0b4"),c=a("308d"),u=a("6bb5"),p=a("4e2b"),d=a("9ab4"),f=a("2b0e"),m=a("60a3"),h=a("42de"),b=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.algorithmType=[],e.algorithm=[[0,1,2],[1,2],[1,2]].map(function(e,t){return{value:t+1,label:["一","二","三"][t]+"维算法",children:e.map(function(e){return{value:e,label:"序号"+e}})}}),e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.getAlgorithmType()}},{key:"onSubmit",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.elForm.validate();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return");case 8:t=Object(r["a"])({},this.form),t.algorithmType=+this.algorithmType.join(""),t.groupCode=t.groupCode.padStart(4,"0"),this.$http.post("/api/basegroup/".concat(this.showId?"addGroup":"updateGroup"),t,{"Content-Type":"application/json"}).then(function(){a.showId?(a.$message.success("添加成功"),a.elForm.resetFields()):a.$message.success("更新成功")}).catch(console.log),this.$emit("input",t);case 13:case"end":return e.stop()}},e,this,[[0,5]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"getAlgorithmType",value:function(){var e=null==this.form.algorithmType?"10":this.form.algorithmType+"";this.algorithmType=e.split("").map(Number)}}]),t}(f["default"]);d["a"]([Object(m["d"])({default:function(){return{description:""}}})],b.prototype,"form",void 0),d["a"]([Object(m["d"])({default:function(){return!0}})],b.prototype,"showId",void 0),d["a"]([Object(m["e"])("form")],b.prototype,"elForm",void 0),d["a"]([Object(m["f"])("form.algorithmType")],b.prototype,"getAlgorithmType",null),b=d["a"]([Object(m["a"])({components:{"app-select":h["a"]}})],b);var g=b,v=g,y=a("2877"),k=Object(y["a"])(v,n,o,!1,null,null,null);t["default"]=k.exports},"6efb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":120},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},o=[],r=(a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("cda1"),m=a("ae85"),h=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"摄像头ID",sortable:!0,width:140},{prop:"ip",label:"摄像头IP",width:260},{prop:"port",label:"设备端口号",width:200},{prop:"groupCode",label:"所属组号",sortable:!0,width:200},{prop:"username",label:"用户名",width:220},{prop:"windowSplit",label:"窗口分割数",width:140}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除摄像头".concat(e.id,"?")).then(function(){return t.$http.post("/api/camera/deleteCamera",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){var n,o,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/camera/getall",{pageSize:a,currentPage:t});case 5:r=e.sent,n=r.pagedData.datas,o=r.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:n});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()}]),t}(Object(d["c"])(m["a"]));p["a"]([f["a"]],h.prototype,"baseUrl",void 0),h=p["a"]([d["b"]],h);var b=h,g=b,v=a("2877"),y=Object(v["a"])(g,n,o,!1,null,null,null);t["default"]=y.exports},"7d65":function(e,t,a){e.exports={alert:"Submissio_alert_pkBiZ"}},"93f1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{staticClass:"card"},[a("div",{class:e.$style.alert},[e._v("协议下发 请选择")]),a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"选择基站：",prop:"base",required:""}},[a("el-cascader",{attrs:{options:e.base,props:{expandTrigger:"hover"},filterable:"","show-all-levels":!1},model:{value:e.form.base,callback:function(t){e.$set(e.form,"base",t)},expression:"form.base"}})],1),a("el-form-item",{attrs:{label:"选择协议：",prop:"protocol",required:""}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.protocol,callback:function(t){e.$set(e.form,"protocol",t)},expression:"form.protocol"}},e._l(e.protocols,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"端口号："}},[a("el-radio",{attrs:{label:5e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    50000端口\n                ")]),a("el-radio",{attrs:{label:6e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    60000端口\n                ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                    立即提交\n                ")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)],1)},o=[],r=a("768b"),i=(a("ffc1"),a("ac6a"),a("7f7f"),a("d225")),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("2b0e"),m=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e.base=[],e.tags=[],e.protocols=[],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init(),this.getData()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){Date.now();var a={ip:e.form.base[1],port:e.form.port,protocol:e.form.protocol};e.$http.post("/api/protocol/sendProtocol",a).then(function(t){e.$message.success(t.message),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={base:[],port:5e4,protocol:"",tagNo:""}}},{key:"getData",value:function(){var e=this;this.$http.get("/api/base/getall",{pageSize:1e7,currentPage:1}).then(this.toTree.bind(this)).catch(console.error),this.$http.get("/api/tag/getall",{pageSize:1e7,currentPage:1}).then(function(e){return e.pagedData.datas.map(function(e){return{value:e.tagNo,label:"".concat(e.name,": ").concat(e.tagNo)}})}).then(function(t){return e.tags=t}).catch(console.error),this.$http.get("/api/protocol/getall",{pageSize:1e7,currentPage:1}).then(function(t){e.protocols=t.pagedData.datas.map(function(e){return{value:e.content,label:e.name}})}).catch(console.error)}},{key:"toTree",value:function(e){this.base.length=0;var t={};e.pagedData.datas.forEach(function(e){(t[e.groupCode]||(t[e.groupCode]=[])).push({value:e.ip,label:"".concat(e.name,": ").concat(e.baseNo,"; ").concat(e.main?"主":"从","基站")})});for(var a=0,n=Object.entries(t);a<n.length;a++){var o=Object(r["a"])(n[a],2),i=o[0],s=o[1];this.base.push({label:"分组".concat(i),children:s})}}}]),t}(f["default"]);m=p["a"]([d["b"]],m);var h=m,b=h,g=a("a810"),v=a("2877");function y(e){this["$style"]=g["default"].locals||g["default"]}var k=Object(v["a"])(b,n,o,!1,y,null,null);t["default"]=k.exports},9826:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-page",{attrs:{tabs:e.tabs}})},o=[],r=a("d225"),i=a("308d"),s=a("6bb5"),l=a("4e2b"),c=a("9ab4"),u=a("2fe1"),p=a("2b0e"),d=a("9973"),f=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(i["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.tabs=[{title:"电子围栏",to:"/system/fence",icon:"el-icon-crop"},{title:"标签绑定",to:"/system/bind",icon:"el-icon-connection"},{title:"分组配置",to:"group",icon:"el-icon-folder",children:[{title:"分组列表",to:"/system/group/list",icon:"el-icon-folder-opened"},{title:"分组添加",to:"/system/group/add",icon:"el-icon-folder-add"}]},{title:"摄像头",to:"camera",icon:"el-icon-video-camera",children:[{title:"摄像头添加",to:"/system/camera/add",icon:"el-icon-circle-plus-outline"},{title:"摄像头列表",to:"/system/camera/list",icon:"el-icon-tickets"}]},{title:"协议",to:"protocol",icon:"el-icon-document",children:[{title:"协议添加",to:"/system/protocol/add",icon:"el-icon-document-add"},{title:"协议列表",to:"/system/protocol/list",icon:"el-icon-document-copy"},{title:"下发协议",to:"/system/protocol/submissio",icon:"el-icon-takeaway-box"}]}],e}return Object(l["a"])(t,e),t}(p["default"]);f=c["a"]([Object(u["b"])({components:{"app-page":d["a"]}})],f);var m=f,h=m,b=a("2877"),g=Object(b["a"])(h,n,o,!1,null,null,null);t["default"]=g.exports},"9b6a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"摄像头品牌："}},[a("el-select",{model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},e._l(["海康","大华"],function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t+1}})}),1)],1),a("el-form-item",{attrs:{label:"摄像头IP：",required:""}},[a("ip-input",{model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),a("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),a("el-form-item",{attrs:{label:"用户名：",prop:"username",required:""}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),a("el-input",{staticClass:"hidden"})],1),a("el-form-item",{attrs:{label:"密码：",prop:"password",required:""}},[a("el-input",{staticClass:"hidden",attrs:{type:"password"}}),a("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("el-form-item",{attrs:{label:"窗口分割数: ",prop:"windowSplit",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.windowSplit,callback:function(t){e.$set(e.form,"windowSplit",t)},expression:"form.windowSplit"}},e._l([1,2,3,4],function(e){return a("el-option",{key:e,attrs:{value:e,label:e+"X"+e}})}),1)],1),a("el-form-item",{attrs:{label:"所在组号：",prop:"groupCode",required:""}},[a("el-input",{model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},o=[],r=a("cebc"),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("2b0e"),m=a("54b6"),h=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.form.ip.every(function(e){return!isNaN(+e)}),a=this.$refs.form;a.validate(function(a){if(!t)return e.$message.warning("摄像头ip不完整");if(isNaN(e.form.groupCode))return e.$message.warning("组号只能包含数字");if(a){Date.now();var n=Object(r["a"])({},e.form);n.ip=e.form.ip.join("."),n.createTime=n.updateTime=Date.now(),n.createUser=n.updateUser="string",e.$http.post("/api/camera/addCamera",n,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={username:"",ip:["","","",""],port:"",groupCode:"",windowSplit:1,password:"",brand:1}}}]),t}(f["default"]);h=p["a"]([Object(d["b"])({components:{"ip-input":m["a"]}})],h);var b=h,g=b,v=a("2877"),y=Object(v["a"])(g,n,o,!1,null,null,null);t["default"]=y.exports},a810:function(e,t,a){"use strict";var n=a("7d65"),o=a.n(n);t["default"]=o.a},ace6:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{staticStyle:{height:"100%"},attrs:{"body-style":e.bodyStyle}},[a("el-carousel",{staticStyle:{width:"100%"},attrs:{autoplay:!1,"indicator-position":"outside",type:e.rootWidth>=1300?"card":"",trigger:"click",arrow:e.bindings.length>1?"hover":"never"},on:{change:function(t){e.index=t}}},e._l(e.bindings,function(t,n){return a("el-carousel-item",{key:t.id},[a("el-transfer",{staticClass:"flex-center",attrs:{type:"card",data:e.data[n],titles:["标签数据","绑定标签"]},model:{value:t.tags,callback:function(a){e.$set(t,"tags",a)},expression:"v.tags"}},[a("el-input",{staticStyle:{transform:"translateY(-1px)"},attrs:{slot:"left-footer",placeholder:"标签名/编号",type:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSource(n)}},slot:"left-footer",model:{value:e.keyWord[n],callback:function(t){e.$set(e.keyWord,n,t)},expression:"keyWord[i]"}}),a("div",{staticClass:"flex-center",staticStyle:{height:"100%"},attrs:{slot:"right-footer"},slot:"right-footer"},[-1!==t.id?[a("el-tooltip",{attrs:{effect:"dark",content:"更新",placement:"left"}},[a("el-button",{attrs:{disabled:e.index!==n,size:"mini",type:"primary",circle:"",icon:"el-icon-refresh"},on:{click:function(t){return e.doUpdata(n)}}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"right"}},[a("el-button",{attrs:{disabled:e.index!==n,size:"mini",type:"danger",circle:"",icon:"el-icon-delete"},on:{click:function(t){return e.doDelete(n)}}})],1)]:a("el-tooltip",{attrs:{effect:"dark",content:"添加",placement:"right"}},[a("el-button",{attrs:{disabled:e.index!==n,size:"mini",type:"success",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.doAdd(n)}}})],1)],2)],1)],1)}),1)],1)],1)},o=[],r=a("75fc"),i=(a("ac6a"),a("96cf"),a("3b8d")),s=(a("7f7f"),a("bd86")),l=a("d225"),c=a("b0b4"),u=a("308d"),p=a("6bb5"),d=a("4e2b"),f=a("9ab4"),m=a("2b0e"),h=a("2fe1"),b=a("cda1"),g=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(u["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.bodyStyle=Object(s["a"])({height:"100%",display:"flex"},"align-items","center"),e.data=[],e.bindings=[],e.keyWord=[],e.index=0,e}return Object(d["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){this.initData()}},{key:"getSource",value:function(e){var t=this;return this.$http.get("/api/tag/getall",{pageSize:100,currentPage:1,tagNo:this.keyWord[e]}).then(function(a){var n=a.pagedData.datas.map(function(e){return{key:e.tagNo,label:e.name,disabled:!1}});return t.assignBindings(n,e),!0}).catch(console.log)}},{key:"doAdd",value:function(e){console.log(e)}},{key:"doDelete",value:function(e){console.log(e)}},{key:"doUpdata",value:function(e){console.log(e)}},{key:"initData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.bindings=[{id:1,tags:["00000004","00000005"]},{id:2,tags:["00000001","00000008"]},{id:3,tags:["00000001","00000011"]}],this.bindings.unshift({id:-1,tags:[]}),e.next=4,this.getSource(0);case 4:if(t=e.sent,t)for(a=this.data[0],n=1;n<this.bindings.length;n++)this.assignBindings(a,n);case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"assignBindings",value:function(e,t){var a=[];this.bindings[t].tags.forEach(function(t){e.some(function(e){return e.key===e})||a.push({key:t,label:"标签"+t,disabled:!1})}),this.$set(this.data,t,[].concat(Object(r["a"])(e),a))}}]),t}(m["default"]);f["a"]([b["a"]],g.prototype,"rootWidth",void 0),g=f["a"]([h["b"]],g);var v=g,y=v,k=a("2877"),x=Object(k["a"])(y,n,o,!1,null,null,null);t["default"]=x.exports},b1fa:function(e,t,a){"use strict";var n=a("1422"),o=a.n(n);t["default"]=o.a},be03:function(e,t,a){e.exports={ip:"ProtocolAdd_ip_2eYu2"}},c3e5:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[a("h3",{staticStyle:{color:"#009688"}},[e._v("\n        协议添加\n    ")]),a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"协议名称：",prop:"name",required:""}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"协议作用：",prop:"effect",required:""}},[a("el-input",{model:{value:e.form.effect,callback:function(t){e.$set(e.form,"effect",t)},expression:"form.effect"}})],1),a("el-form-item",{attrs:{label:"协议内容：",prop:"content",required:""}},[a("el-input",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),a("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},o=[],r=a("cebc"),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("2b0e"),m=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){var a=Object(r["a"])({},e.form);a.createTime=a.updateTime=Date.now(),a.createUser=a.updateUser="string",e.$http.post("/api/protocol/addProtocol",a,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={name:"",port:"",effect:"",content:""}}}]),t}(f["default"]);m=p["a"]([d["b"]],m);var h=m,b=h,g=a("d34c"),v=a("2877");function y(e){this["$style"]=g["default"].locals||g["default"]}var k=Object(v["a"])(b,n,o,!1,y,null,null);t["default"]=k.exports},cda1:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("2fe1"),o=a("2f62"),r=i("computed",o["e"]);i("computed",o["c"]),i("methods",o["b"]),i("methods",o["d"]);function i(e,t){function a(a,o){return Object(n["a"])(function(n,r){n[e]||(n[e]={});var i,s=(i={},i[r]=a,i);n[e][r]=void 0!==o?t(o,s)[r]:t(s)[r]})}function o(e,t){if("string"===typeof t){var n=t,o=e;return a(n,void 0)(o,n)}var r=s(t),i=e;return a(i,r)}return o}function s(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}},d34c:function(e,t,a){"use strict";var n=a("be03"),o=a.n(n);t["default"]=o.a},f9cb:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200},on:{del:e.del,setting:function(t){e.group=t},updateData:e.getData,toExcel:e.toExcel}})],1),e.group?[a("el-dialog",{attrs:{title:"更改分组信息",visible:!0,"modal-append-to-body":!1,width:"80%"},on:{close:function(t){e.group=null}}},[a("group-add",{staticStyle:{padding:"0"},attrs:{form:e.group,"show-id":!1}})],1)]:e._e()],2)},o=[],r=(a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2fe1"),f=a("ae85"),m=a("6807"),h=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.group=null,e.colCfg=[{prop:"groupCode",label:"组号",width:140},{prop:"minBaseSize",label:"最小基站数",width:140},{prop:"groupBaseSize",label:"最大基站数",width:140},{prop:"description",label:"描述",width:260},{prop:"mapId",label:"所属地图",width:140}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除分组".concat(e.groupCode)).then(function(){return t.$http.post("/api/basegroup/deleteGroup",{groupCode:e.groupCode})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){var n,o,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/basegroup/getall",{pageSize:a,currentPage:t});case 5:r=e.sent,n=r.pagedData.datas,o=r.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:n});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"op",get:function(){return[{type:"danger",name:"del",desc:"删除"},{type:"primary",name:"setting",desc:"编辑"}]}}]),t}(Object(d["c"])(f["a"]));h=p["a"]([Object(d["b"])({components:{"group-add":m["default"]}})],h);var b=h,g=b,v=a("2877"),y=Object(v["a"])(g,n,o,!1,null,null,null);t["default"]=y.exports},fc9b:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map-box"},[a("div",{ref:"map",class:e.$style.map}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isDrawing,expression:"isDrawing"}],class:[e.$style.map,e.$style.mask],on:{pointermove:e.move,pointerup:e.addPoint}}),a("div",{staticClass:"map-tool-bar",staticStyle:{display:"flex","align-items":"center"}},[a("map-select",{directives:[{name:"show",rawName:"v-show",value:!e.isDrawing,expression:"!isDrawing"}],staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}}),e.isDrawing?a("div",{staticStyle:{"padding-left":"10%",width:"100%"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-d-arrow-left",disabled:!e.points.length},on:{click:e.prev}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-d-arrow-right",disabled:!e.popPoints.length},on:{click:e.next}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-check"},on:{click:e.ok}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-close"},on:{click:e.cancel}})],1):e._e()],1),a("el-collapse",{directives:[{name:"show",rawName:"v-show",value:!e.isDrawing,expression:"!isDrawing"}],class:e.$style.op,model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[e.permission.get?a("el-collapse-item",{attrs:{name:"info",title:"区域信息"}},[a("app-table",{class:e.$style.table,attrs:{"max-height":255,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.operation,"op-width":200,noPrint:!0,isSmall:!0},on:{updateData:e.getData,del:e.del,setting:function(t){e.zone=t},display:e.display}})],1):e._e(),e.permission.post?a("el-collapse-item",{attrs:{title:"添加区域",name:"add"}},[a("zone-input",{attrs:{"form-height":"calc(100vh - 500px)",groups:e.groups},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("el-form-item",{attrs:{label:"区域顶点"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.enterDrawingMode}},[e._v("\n                        设置\n                    ")])],1)],1),a("el-button",{class:e.$style.submit,attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                提交\n            ")])],1):e._e()],1),e.zone?[a("el-dialog",{attrs:{title:"更改区域信息",visible:!!e.zone,"modal-append-to-body":!1},on:{close:function(t){e.zone=null}}},[a("zone-input",{attrs:{groups:e.groups},model:{value:e.zone,callback:function(t){e.zone=t},expression:"zone"}}),a("template",{slot:"footer"},[a("el-button",{on:{click:function(t){e.zone=null}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],2)]:e._e()],2)},o=[],r=a("cebc"),i=(a("20d6"),a("7f7f"),a("96cf"),a("3b8d")),s=a("d225"),l=a("b0b4"),c=a("308d"),u=a("6bb5"),p=a("4e2b"),d=a("9ab4"),f=a("2fe1"),m=a("ae85"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticStyle:{overflow:"auto"},style:{"max-height":e.formHeight},attrs:{model:e.zone,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"区域名称",required:""}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.zone.name,callback:function(t){e.$set(e.zone,"name",t)},expression:"zone.name"}})],1),a("el-form-item",{attrs:{label:"区域模式"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.zone.mode,callback:function(t){e.$set(e.zone,"mode",t)},expression:"zone.mode"}},[a("el-option",{attrs:{label:"进入区域",value:e.zoneMode.in}}),a("el-option",{attrs:{label:"离开区域",value:e.zoneMode.out}}),e.groups.length>=2?a("el-option",{attrs:{label:"切换区域",value:e.zoneMode.switch}}):e._e(),a("el-option",{attrs:{label:"分组区域",value:e.zoneMode.group}}),a("el-option",{attrs:{label:"其他",value:e.zoneMode.other}})],1)],1),e.zone.mode===e.zoneMode.group?a("el-form-item",{attrs:{label:"相关分组",required:""}},[a("el-select",{model:{value:e.zone.baseNo1,callback:function(t){e.$set(e.zone,"baseNo1",t)},expression:"zone.baseNo1"}},e._l(e.groups,function(e){return a("el-option",{key:e,attrs:{value:e}})}),1)],1):e.zone.mode===e.zoneMode.switch?[a("el-form-item",{attrs:{label:"基站分组1",required:""}},[a("el-select",{model:{value:e.zone.baseNo1,callback:function(t){e.$set(e.zone,"baseNo1",t)},expression:"zone.baseNo1"}},e._l(e.groups,function(t){return a("el-option",{key:t,attrs:{value:t,disabled:t===e.zone.baseNo2}})}),1)],1),a("el-form-item",{attrs:{label:"基站分组2",required:""}},[a("el-select",{model:{value:e.zone.baseNo2,callback:function(t){e.$set(e.zone,"baseNo2",t)},expression:"zone.baseNo2"}},e._l(e.groups,function(t){return a("el-option",{key:t,attrs:{value:t,disabled:t===e.zone.baseNo1}})}),1)],1)]:e.zone.mode!==e.zoneMode.other?a("el-form-item",{attrs:{label:"围栏阈值",required:""}},[a("el-input-number",{attrs:{min:0},model:{value:e.zone.threshold,callback:function(t){e.$set(e.zone,"threshold",t)},expression:"zone.threshold"}})],1):e._e(),e._t("default"),a("el-form-item",{attrs:{label:"启动"}},[a("el-switch",{attrs:{"active-text":"true","inactive-text":"false"},model:{value:e.zone.open,callback:function(t){e.$set(e.zone,"open",t)},expression:"zone.open"}})],1)],2)},b=[],g=a("2b0e"),v=a("60a3"),y=a("cda1"),k=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.zone={},e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.value||console.error("组件缺少v-model绑定!"),this.zone=this.value||{}}},{key:"getVlaue",value:function(e){this.zone=e}},{key:"setValue",value:function(e){}}]),t}(g["default"]);d["a"]([y["a"]],k.prototype,"zoneMode",void 0),d["a"]([Object(v["d"])({default:function(){return"none"}})],k.prototype,"formHeight",void 0),d["a"]([Object(v["d"])()],k.prototype,"groups",void 0),d["a"]([Object(v["c"])("change")],k.prototype,"value",void 0),d["a"]([Object(v["f"])("value",{deep:!0})],k.prototype,"getVlaue",null),d["a"]([Object(v["b"])("change"),Object(v["f"])("zone",{deep:!0})],k.prototype,"setValue",null),k=d["a"]([v["a"]],k);var x,O=k,j=O,w=a("2877"),$=Object(w["a"])(j,h,b,!1,null,null,null),z=$.exports,_=(a("7514"),a("ac6a"),a("75fc")),S=a("b3c9"),C=a("c860"),N=a("0876");function E(e,t,a,n){var o=D(e,t,a),r=D(e,t,n),i=D(a,n,e),s=D(a,n,t);return o*r>0||i*s>0?{isCollinear:!1,result:!1}:0===o&&0===r?{isCollinear:!0,result:M(e,t,a,n)}:{isCollinear:!1,result:!0}}function D(e,t,a){return(a.x-e.x)*(t.y-e.y)-(a.y-e.y)*(t.x-e.x)}function M(e,t,a,n){return Math.min(e.y,t.y)<=Math.max(a.y,n.y)&&Math.max(e.y,t.y)>=Math.min(a.y,n.y)&&Math.min(e.x,t.x)<=Math.max(a.x,n.x)&&Math.max(e.x,t.x)>=Math.min(a.x,n.x)}var I=x=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.isDrawing=!1,e.points=[],e.popPoints=[],e.isClose=!1,e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"move",value:function(e){if(this.mgr&&this.points.length&&this.container){this.mgr.lineMgr.remove(x.LINE_NAME);var t=this.container.getBoundingClientRect(),a=this.getCoord(e.x-t.left,e.y-t.top);this.mgr.addLine([].concat(Object(_["a"])(this.points),[Object(r["a"])({},a,{z:9})]),x.LINE_STYLE,x.LINE_NAME,!0)}}},{key:"addPoint",value:function(e){if(this.mgr&&this.container){this.isClose&&(this.mgr.lineMgr.remove(x.LINE_NAME),this.isClose=!1);var t=this.container.getBoundingClientRect(),a=this.getCoord(e.x-t.left,e.y-t.top);this.hasIntersection(a)||(this._addPoint(a),this.popPoints.length=0)}}},{key:"enterDrawingMode",value:function(){this.isClose&&this.rePaint(),this.isDrawing=!0,this.isClose=!1}},{key:"prev",value:function(){var e=this.points.pop();e&&(this.popPoints.push(e),this.mgr&&(this.mgr.remove(JSON.stringify({x:e.x,y:e.y})),this.rePaint()))}},{key:"next",value:function(){var e=this.popPoints.pop();e&&this._addPoint(e)}},{key:"cancel",value:function(){var e=this;this.$confirm("清除当前图形并退出绘制模式?").then(function(){e.remove(),e.isDrawing=!1}).catch(console.log)}},{key:"ok",value:function(){if(this.isClose=!0,this.rePaint(),this.mgr&&this.mgr.appendLine(x.LINE_NAME,[this.points[0]],!0),this.hasIntersection(this.points[0]))return this.$message.warning("当前图形存在相交线段，请重新设置");this.isDrawing=!1}},{key:"initData",value:function(){this.points.length=0,this.popPoints.length=0,this.isDrawing=!1,this.isClose=!1}},{key:"bindEvents",value:function(){var e=this;this.mgr.on("loadComplete",function(){return e.tagAnchor()})}},{key:"remove",value:function(){var e=this;return this.mgr&&(this.points.forEach(function(t){return e.mgr.remove(JSON.stringify({x:t.x,y:t.y}))}),this.mgr.lineMgr.remove()),this.points.length=0,this}},{key:"_addPoint",value:function(e){this.mgr&&(this.points.push(Object(r["a"])({},this.mgr.addImage({x:e.x,y:e.y,url:"/images/blueImageMarker.png",size:32,height:2},JSON.stringify({x:e.x,y:e.y})),{z:9})),this.points.length>1&&(this.mgr.lineMgr.find(x.LINE_NAME).length?this.mgr.appendLine(x.LINE_NAME,[Object(r["a"])({},e,{z:9})],!0):this.mgr.addLine(Object(_["a"])(this.points),x.LINE_STYLE,x.LINE_NAME,!0)))}},{key:"hasIntersection",value:function(e){var t=this.points[this.points.length-1];if(t)for(var a=0;a<this.points.length-1;a++){var n=E(this.points[a],this.points[a+1],t,e),o=n.isCollinear,r=n.result;if(r&&(o||this.points[a+1]!==t&&this.points[a]!==e))return!0}return!1}},{key:"rePaint",value:function(){this.mgr&&(this.mgr.lineMgr.remove(x.LINE_NAME),this.points.length>1&&this.mgr.addLine(Object(_["a"])(this.points),x.LINE_STYLE,x.LINE_NAME,!0))}},{key:"getCoord",value:function(e,t){if(this.mgr instanceof C["a"])return this.mgr.map.coordScreenToMap(e,t,9);if(this.mgr instanceof N["a"]){var a=this.mgr.stage.toLocal(new PIXI.Point(e,t));return Object(r["a"])({},a,{z:9})}return console.warn("地图错误...."),{x:e,y:t,z:9}}}]),t}(Object(f["c"])(S["a"]));I.LINE_NAME="zone_line",I.LINE_STYLE={lineType:fengmap.FMLineType.FULL,lineWidth:2,smooth:!1,color:"#e00",colorNum:15597568},I=x=d["a"]([f["b"]],I);var T=I,P=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.activeNames=["info","add"],e.zone=null,e.colCfg=[{prop:"name",label:"区域",sortable:!0,width:90},{prop:"status",label:"状态",width:60}],e.operation=[{type:{default:"primary"},name:"display",desc:{default:"显示"}}],e.form={name:"",mode:2,open:!0},e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.permission.delete&&this.operation.push({type:"danger",name:"del",desc:"删除"}),this.permission.put&&this.operation.push({type:"warning",name:"setting",desc:"设置"}),this.form.mode=this.zoneMode.in}},{key:"del",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("确认删除区域".concat(t.name,"?"),"确认删除");case 3:return e.next=5,this.$http.post("/api/zone/deleteZone",{id:t.id});case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",console.log(e.t0));case 10:this.refresh().display(t,a,!0).$message.success("删除成功");case 11:case"end":return e.stop()}},e,this,[[0,7]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"display",value:function(e,t,a){var n=this.operation.findIndex(function(e){return"display"===e.name});if(n>-1){var o=this.operation[n];o.type[t]||a?(o.type[t]=void 0,this.mgr&&this.mgr.remove(e.name)):(o.type[t]="success",this.mgr&&this.mgr.zoneOpen(e)),o.desc[t]=o.desc[t]||a?void 0:"隐藏",this.$set(this.operation,n,o)}return this}},{key:"onSubmit",value:function(){if(!this.form.name)return this.$message.error("区域名称不能为空");var e=this.points.length;return e<3?this.$message.warning("区域坐标最少设置3个"):this.form.mode===this.zoneMode.switch&&4!==e?this.$message.warning("切换区域坐标必须为4个"):void this.put()}},{key:"update",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.zone){e.next=19;break}if(this.zone.name){e.next=3;break}return e.abrupt("return",this.$message.error("区域名称不能为空"));case 3:if(this.zone.mode!==this.zoneMode.switch){e.next=17;break}if(t=this.zone.position.length,!(t<4)){e.next=7;break}return e.abrupt("return",this.$message.warning("此区域坐标数少于4, 不能设置为切换区域"));case 7:if(!(t>4)){e.next=17;break}return e.prev=8,e.next=11,this.$confirm("此区域坐标数为".concat(t,", 将删除最后的").concat(t-4,"个坐标点"));case 11:this.zone.position=this.zone.position.slice(0,4),e.next=17;break;case 14:return e.prev=14,e.t0=e["catch"](8),e.abrupt("return");case 17:a=Object(r["a"])({},this.zone,{position:JSON.stringify(this.zone.position),updateTime:Date.now(),enable:this.zone.open?1:0}),this.$http.post("/api/zone/updateZone",a,{"Content-Type":"application/json"}).then(function(){return n.refresh().$message.success("修改区域信息成功")}).catch(console.log);case 19:case"end":return e.stop()}},e,this,[[8,14]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"fetch",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,a){var n,o,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/zone/getall",{pageSize:a,currentPage:t});case 5:r=e.sent,n=r.pagedData.datas.map(function(e){return e.status=e.enable?"开启":"关闭",e.position=JSON.parse(e.position),e.open=!!e.enable,e.mode=null==e.mode?0:e.mode,e}),o=r.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:n});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"put",value:function(){var e=this;this.$confirm("请确定当前区域范围","提示",{type:"info"}).then(this.submitAddZone.bind(this)).then(function(){return e.remove().resetForm().refresh().$message.success("添加成功")}).catch(console.log)}},{key:"submitAddZone",value:function(){var e=this,t=Date.now();if(!this.mgr)return this.$message.error("地图不存在, 提交失败!"),Promise.reject("地图不存在");var a=Object.assign({},this.form,{position:JSON.stringify(this.points.map(function(t){return e.mgr.getCoordinate(t)})),enable:this.form.open?1:0,createTime:t,updateTime:t});return this.$http.post("/api/zone/addZone",a,{"Content-Type":"application/json"})}},{key:"resetForm",value:function(){return this.form={name:"",mode:this.zoneMode.in,open:!0},this}}]),t}(Object(f["c"])(m["a"],T));d["a"]([y["a"]],P.prototype,"zoneMode",void 0),P=d["a"]([Object(f["b"])({components:{"zone-input":z}})],P);var L=P,A=L,q=a("b1fa");function F(e){this["$style"]=q["default"].locals||q["default"]}var R=Object(w["a"])(A,n,o,!1,F,null,null);t["default"]=R.exports},fca0:function(e,t,a){var n=a("5ca1"),o=a("7726").isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&o(e)}})}}]);
//# sourceMappingURL=system.5d291ebd.js.map