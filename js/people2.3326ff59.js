(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["people2"],{"0a49":function(t,e,n){var a=n("9b43"),r=n("626a"),o=n("4bf8"),i=n("9def"),c=n("cd1c");t.exports=function(t,e){var n=1==t,s=2==t,u=3==t,l=4==t,p=6==t,h=5==t||p,f=e||c;return function(e,c,d){for(var b,g,m=o(e),v=r(m),y=a(c,d,3),x=i(v.length),w=0,j=n?f(e,x):s?f(e,0):void 0;x>w;w++)if((h||w in v)&&(b=v[w],g=y(b,w,m),t))if(n)j[w]=g;else if(g)switch(t){case 3:return!0;case 5:return b;case 6:return w;case 2:j.push(b)}else if(l)return!1;return p?-1:u||l?l:j}}},1169:function(t,e,n){var a=n("2d95");t.exports=Array.isArray||function(t){return"Array"==a(t)}},"1c13":function(t,e,n){t.exports={thead:"Table_thead_gYJvz"}},"3c06":function(t,e,n){"use strict";var a=n("1c13"),r=n.n(a);e["default"]=r.a},7514:function(t,e,n){"use strict";var a=n("5ca1"),r=n("0a49")(5),o="find",i=!0;o in[]&&Array(1)[o](function(){i=!1}),a(a.P+a.F*i,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},ae85:function(t,e,n){"use strict";n("ac6a"),n("96cf");var a=n("3b8d"),r=n("d225"),o=n("b0b4"),i=n("308d"),c=n("6bb5"),s=n("4e2b"),u=n("9ab4"),l=n("2b0e"),p=n("2fe1"),h=n("d8c9"),f=n("60a3"),d="data:application/vnd.ms-excel;base64,";function b(t){return window.btoa(decodeURIComponent(encodeURIComponent(t)))}function g(t){return'<html><head><meta charset="UTF-8"></head><body><table border="1">'.concat(t,"</table></body></html>")}function m(t){window.open(d+b(g(t)),"block")}var v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{staticStyle:{"margin-bottom":"10px"},attrs:{data:t.tableData,border:!0,"header-row-class-name":t.$style.thead,"max-height":t.maxHeight}},[t._l(t.colCfg,function(e,a){return n("el-table-column",{key:a,attrs:{prop:e.prop,label:e.label,sortable:!!e.sortable,resizable:!0,width:null==e.width?void 0:e.width*t.scale}})}),t.op&&t.op.length?n("el-table-column",{attrs:{label:"操作",fixed:"right",resizable:!0,"min-width":null==t.opWidth?void 0:t.opWidth*t.scale},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"flex-center"},t._l(t.op,function(a,r){return n("el-button",{key:r,attrs:{size:"mini",type:t._f("parse")(a.type,e.$index)},on:{click:function(n){return t.emit(a.name,e.row,e.$index)}}},[t._v("\n                        "+t._s(t._f("parse")(a.desc,e.$index))+"\n                    ")])}),1)]}}],null,!1,3211734680)}):t._e()],2),n("div",{staticClass:"flex-center",staticStyle:{"justify-content":"space-between"}},[t.noPrint?t._e():n("el-button",{attrs:{size:"mini",icon:"el-icon-printer"},on:{click:function(e){return t.emit("toExcel")}}},[t._v("\n            导出\n        ")]),n("el-pagination",{attrs:{"current-page":t.page,"page-size":t.pageSize,layout:(t.isSmall?"":"sizes, ")+"prev, pager, next",total:t.totalCount,small:!!t.isSmall,"hide-on-single-page":!!t.isSmall,"pager-count":5},on:{"size-change":function(e){return t.updateData("pageSize",e)},"current-change":function(e){return t.updateData("page",e)}}})],1)],1)},y=[],x=n("d70b"),w=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(i["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.pageSize=10,t.page=1,t.scale=1,t}return Object(s["a"])(e,t),Object(o["a"])(e,[{key:"emit",value:function(t,e,n){t=k(t,n),this.$emit(t,e,n)}},{key:"updateData",value:function(t,e){var n=this;this[t]=e,this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(function(){return n.$emit("updateData",n.page,n.pageSize)},200)}},{key:"scaleRoot",value:function(){document.body.clientWidth<=x["h"]?this.scale=x["h"]/x["d"]:this.scale=1}}]),e}(l["default"]);u["a"]([Object(f["b"])()],w.prototype,"maxHeight",void 0),u["a"]([Object(f["b"])()],w.prototype,"tableData",void 0),u["a"]([Object(f["b"])()],w.prototype,"totalCount",void 0),u["a"]([Object(f["b"])()],w.prototype,"colCfg",void 0),u["a"]([Object(f["b"])()],w.prototype,"op",void 0),u["a"]([Object(f["b"])()],w.prototype,"noPrint",void 0),u["a"]([Object(f["b"])()],w.prototype,"isSmall",void 0),u["a"]([Object(f["b"])()],w.prototype,"opWidth",void 0),w=u["a"]([Object(p["b"])({filters:{parse:k}})],w);var j=w;function k(t,e){return"string"===typeof t?t:t[e]||t.default||"404"}var O=j,z=n("3c06"),$=n("2877");function S(t){this["$style"]=z["default"].locals||z["default"]}var D=Object($["a"])(O,v,y,!1,S,null,null),_=D.exports,C=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(i["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.totalCount=0,t.tableData=[],t.maxHeight=100,t.colCfg=[],t.pageSize=10,t.page=1,t}return Object(s["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){this.getData(1,10)}},{key:"mounted",value:function(){this.getMaxHeight()}},{key:"getData",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e,n){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.pageSize=n,this.page=e,t.next=4,this.fetch(e,n);case 4:a=t.sent,this.totalCount=a.count,this.tableData=a.data;case 7:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"toExcel",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.bodyStr();case 2:e=t.sent,m(this.headStr()+e);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"fetch",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",{count:0,data:[]});case 1:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"refresh",value:function(t){null==t&&(t=this.tableData.length>1?this.page:this.page-1),this.getData(Math.max(1,t),this.pageSize)}},{key:"getMaxHeight",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$refs.table,!e){t.next=13;break}if(n=e.$el||e,!n){t.next=13;break}return t.prev=4,t.next=7,Object(h["e"])(function(){return!!n.offsetHeight});case 7:this.maxHeight=.85*n.offsetHeight,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),console.log(t.t0);case 13:case"end":return t.stop()}},t,this,[[4,10]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"headStr",value:function(){var t=["<thead><tr>"];return this.colCfg.forEach(function(e){return t.push("<th>".concat(e.label,"</th>"))}),t.push("</tr></thead>"),t.join("")}},{key:"bodyStr",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(1,this.totalCount);case 2:return e=t.sent.data,n=["<tbody>"],e.forEach(function(t){n.push("<tr>"),a.colCfg.forEach(function(e){return n.push("<td>".concat(t[e.prop],"</td>"))}),n.push("</tr>")}),n.push("</tbody>"),t.abrupt("return",n.join(""));case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}]),e}(l["default"]);u["a"]([Object(f["c"])("$store.state.rootScale")],C.prototype,"getMaxHeight",null),C=u["a"]([Object(p["b"])({components:{"app-table":_}})],C);e["a"]=C},cd1c:function(t,e,n){var a=n("e853");t.exports=function(t,e){return new(a(t))(e)}},e853:function(t,e,n){var a=n("d3f4"),r=n("1169"),o=n("2b4c")("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),a(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},ffd2:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{padding:"5%",height:"100%"}},[n("el-card",{ref:"table",staticClass:"card"},[n("app-table",{attrs:{"max-height":t.maxHeight,"table-data":t.tableData,"col-cfg":t.colCfg,"total-count":t.totalCount,op:[{type:"danger",name:"del",desc:"删除"},{type:"primary",name:"setting",desc:"配置"}],"op-width":200},on:{del:t.del,setting:t.setting,updateData:t.getData,toExcel:t.toExcel}})],1),t.person?[n("el-dialog",{attrs:{title:"更改标签信息",visible:!!t.person,"modal-append-to-body":!1},on:{close:function(e){t.person=null}}},[n("el-form",{attrs:{model:t.person}},[n("el-form-item",{attrs:{label:"区域"}},[n("el-select",{model:{value:t.person.zone,callback:function(e){t.$set(t.person,"zone",e)},expression:"person.zone"}},t._l(t.zones.pagedData.datas,function(t){return n("el-option",{key:t.id,attrs:{value:t.id+"",label:t.name}})}),1)],1),n("el-form-item",{attrs:{label:"等级"}},[n("el-select",{model:{value:t.person.level,callback:function(e){t.$set(t.person,"level",e)},expression:"person.level"}},t._l([1,2,3],function(t){return n("el-option",{key:t,attrs:{value:"T"+t}})}),1)],1),n("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[n("el-input",{staticStyle:{width:"80%"},model:{value:t.person.name,callback:function(e){t.$set(t.person,"name",e)},expression:"person.name"}})],1)],1),n("template",{slot:"footer"},[n("el-button",{on:{click:function(e){t.person=null}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],2)]:t._e()],2)},r=[],o=(n("7514"),n("ac6a"),n("5df3"),n("768b")),i=(n("96cf"),n("3b8d")),c=(n("7f7f"),n("d225")),s=n("b0b4"),u=n("308d"),l=n("6bb5"),p=n("4e2b"),h=n("9ab4"),f=n("2fe1"),d=n("ae85"),b=n("60a3"),g=function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(u["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.person=null,t.colCfg=[{prop:"id",label:"ID",sortable:!0,width:120},{prop:"name",label:"名称",width:160},{prop:"tagNo",label:"编号",width:120},{prop:"department",label:"部门",width:160},{prop:"job",label:"职位",width:160},{prop:"level",label:"等级",sortable:!0,width:120},{prop:"zoneName",label:"区域",width:220}],t}return Object(p["a"])(e,t),Object(s["a"])(e,[{key:"del",value:function(t){var e=this;this.$confirm("删除标签".concat(t.name,"?")).then(function(){return e.$http.post("/api/tag/deleteTag",{id:t.id})}).then(function(){e.$message.success("删除成功"),e.refresh()}).catch(console.log)}},{key:"setting",value:function(t){this.person=t}},{key:"submit",value:function(){var t=this;if(!this.person.name)return this.$message.warning("name is required!");this.person.updateTime=Date.now(),this.$confirm("确认修改?").then(function(){return t.$http.post("/api/tag/updateTag",t.person,{"Content-Type":"application/json"})}).then(function(){t.$message.success("修改成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e,n){var a,r,i,c,s,u,l=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=[],r=0,t.prev=2,t.next=5,Promise.all([this.$http.get("/api/tag/getall",{pageSize:n,currentPage:e,type:this.type||1}),Promise.resolve().then(function(){return l.zones||l.$http.get("/api/zone/getall",{pageSize:1e6,currentPage:1})})]);case 5:i=t.sent,c=Object(o["a"])(i,2),s=c[0],u=c[1],a=s.pagedData.datas.map(function(t){var e=u.pagedData.datas.find(function(e){return+e.id===+t.zone});return t.zoneName=e?e.name:"未知区域",t}),r=s.pagedData.totalCount,this.zones=u,t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](2),console.log(t.t0);case 17:return t.abrupt("return",{count:r,data:a});case 18:case"end":return t.stop()}},t,this,[[2,14]])}));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"routeUpdate",value:function(){this.getData(1,10)}}]),e}(Object(f["c"])(d["a"]));h["a"]([Object(b["b"])()],g.prototype,"type",void 0),h["a"]([Object(b["c"])("$route.params.type")],g.prototype,"routeUpdate",null),g=h["a"]([f["b"]],g);var m=g,v=m,y=n("2877"),x=Object(y["a"])(v,a,r,!1,null,null,null);e["default"]=x.exports}}]);
//# sourceMappingURL=people2.3326ff59.js.map