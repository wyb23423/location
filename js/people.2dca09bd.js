(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["people"],{"2ddd":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-page",{attrs:{tabs:e.tabs}})},i=[],n=a("d225"),o=a("308d"),s=a("6bb5"),l=a("4e2b"),c=a("9ab4"),u=a("2fe1"),p=a("2b0e"),d=a("9973"),f=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.tabs=[{title:"标签列表",to:"list",icon:"el-icon-user",children:[{title:"常驻标签",to:"/people/list/1",icon:"el-icon-user-solid"},{title:"临时标签",to:"/people/list/2",icon:"el-icon-s-custom"}]},{title:"标签添加",to:"/people/add",icon:"el-icon-document-add"}],e}return Object(l["a"])(t,e),t}(p["default"]);f=c["a"]([Object(u["b"])({components:{"app-page":d["a"]}})],f);var h=f,v=h,m=a("2877"),b=Object(m["a"])(v,r,i,!1,null,null,null);t["default"]=b.exports},"42de":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{filterable:"","default-first-option":"",multiple:!!e.multiple,disabled:!!e.disabled,"collapse-tags":""},on:{change:e.change},model:{value:e.currValue,callback:function(t){e.currValue=t},expression:"currValue"}},[e.canEmpty?a("el-option",{attrs:{label:"--",value:void 0}}):e._e(),e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)},i=[],n=(a("7514"),a("7f7f"),a("ac6a"),a("cebc")),o=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2b0e"),f=a("2fe1"),h=a("60a3"),v=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.options=[],e.currValue=null,e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){var e=this;this.$http.get(this.url,Object(n["a"])({pageSize:1e6,currentPage:1},this.filters)).then(function(t){e.options=t.pagedData.datas.map(function(t){return{id:t[e.keys.id||"id"],name:t[e.keys.name],data:t}}),e.multiple?e.currValue=[]:e.canEmpty||(e.currValue=null==e.value||""===e.value?e.options[0].id:e.value),e.change(e.currValue)}).catch(console.error)}},{key:"change",value:function(e){var t=this;this.$emit("input",e),Array.isArray(e)||(e=[e]),this.$emit("change",e.map(function(e){return t.options.find(function(t){return t.id===e})}))}}]),t}(d["default"]);p["a"]([Object(h["d"])()],v.prototype,"url",void 0),p["a"]([Object(h["d"])()],v.prototype,"value",void 0),p["a"]([Object(h["d"])()],v.prototype,"multiple",void 0),p["a"]([Object(h["d"])()],v.prototype,"disabled",void 0),p["a"]([Object(h["d"])({default:function(){return!1}})],v.prototype,"canEmpty",void 0),p["a"]([Object(h["d"])({default:function(){return{}}})],v.prototype,"filters",void 0),p["a"]([Object(h["d"])({default:function(){return{id:"id",name:"name"}}})],v.prototype,"keys",void 0),v=p["a"]([f["b"]],v);var m=v,b=m,g=a("2877"),y=Object(g["a"])(b,r,i,!1,null,null,null);t["a"]=y.exports},6138:function(e,t,a){"use strict";var r=a("c94b"),i=a.n(r);t["default"]=i.a},"65f9":function(e,t,a){"use strict";var r=a("de30"),i=a.n(r);i.a},8346:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[a("h3",{staticStyle:{color:"#009688"}},[e._v("添加标签")]),a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"头像："}},[a("app-avator",{ref:"avator",model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}})],1),a("el-form-item",{attrs:{label:"标签名称：",prop:"name",required:""}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"标签号：",prop:"tagNo",required:"",rules:{pattern:/^[0-9A-Fa-f]{8}$/,message:"tagNo is not a hexadecimal string of length 8"}}},[a("el-input",{model:{value:e.form.tagNo,callback:function(t){e.$set(e.form,"tagNo",t)},expression:"form.tagNo"}})],1),a("el-form-item",{attrs:{label:"区域: "}},[a("app-select",{attrs:{url:"/api/zone/getall",canEmpty:!0},model:{value:e.form.zone,callback:function(t){e.$set(e.form,"zone",t)},expression:"form.zone"}})],1),a("el-form-item",{attrs:{label:"其他属性："}},[a("el-input",{attrs:{placeholder:"性别: 女, 部门: 研发"},model:{value:e.form.properties,callback:function(t){e.$set(e.form,"properties",t)},expression:"form.properties"}})],1),a("el-form-item",{attrs:{label:"标签类型：",prop:"type"}},[a("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:1}},[e._v("常驻")]),a("el-radio",{attrs:{label:2}},[e._v("临时")])],1)],1),2===e.form.type?a("el-form-item",{attrs:{label:"添加原因："}},[a("el-input",{model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},i=[],n=a("768b"),o=(a("7f7f"),a("d225")),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("2b0e"),f=a("60a3"),h=a("42de"),v=a("d1d2"),m=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={type:1,reason:"",avatar:"",properties:""},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"onSubmit",value:function(){var e=this;this.elForm.validate().then(function(){return e.avator.getImgUrl(e.form.name)}).then(function(t){var a=Object(n["a"])(t,2),r=a[0],i=a[1],o=Date.now(),s=Object.assign({createTime:o,updateTime:o,locked:!0,photo:r.resultMap.photoUrl},e.form);return s.avatar=i.resultMap.avatarUrl,e.$http.post("/api/tag/addTag",s,{"Content-Type":"application/json"})}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.form.avatar=this.form.properties=""}}]),t}(d["default"]);p["a"]([Object(f["e"])("form")],m.prototype,"elForm",void 0),p["a"]([Object(f["e"])("avator")],m.prototype,"avator",void 0),m=p["a"]([Object(f["a"])({components:{"app-select":h["a"],"app-avator":v["a"]}})],m);var b=m,g=b,y=a("2877"),x=Object(y["a"])(g,r,i,!1,null,null,null);t["default"]=x.exports},9973:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{click:function(t){e.isMini&&(e.display=!1)}}},[a("div",{staticClass:"main"},[a("div",{staticStyle:{"overflow-y":"auto",height:"calc(100vh - 60px)"}},[e.hasRouter?a("router-view"):e._e(),e._t("default")],2)]),a("app-aside",{class:e.$style.aside,style:{left:e.display?"0":"-65px"},attrs:{tabs:e.tabs}}),e.isMini?a("el-button",{class:e.$style.btn,style:{left:e.display?"45px":"-15px"},attrs:{icon:"el-icon-caret-"+(e.display?"left":"right"),type:"success",circle:"",plain:""},on:{click:function(t){t.stopPropagation(),e.display=!e.display}}}):e._e()],1)},i=[],n=a("d225"),o=a("b0b4"),s=a("308d"),l=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),d=a("2fe1"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{background:"#393d49",height:"calc(100vh - 60px)"},on:{click:function(e){e.stopPropagation()}}},[a("el-tooltip",{attrs:{effect:"dark",content:e.isCollapse?"展开":"收起",placement:"right"}},[a("div",{class:e.$style.icon,on:{click:e.collapse}},[a("i",{staticClass:"el-icon-menu"})])]),a("el-menu",{staticStyle:{"text-align":"center","border-right":"none"},attrs:{"background-color":"#393d49","text-color":"#fff","active-text-color":"#ffd04b","default-active":e.defaultActive,router:!0,"unique-opened":!0,collapse:e.isCollapse},on:{click:e.collapse}},[e._l(e.currTabs,function(t,r){var i;return[t.children?a("el-submenu",{key:t.to,attrs:{index:r+""}},[a("div",{class:(i={},i[e.$style.active]=t.to===e.activeTitle,i),attrs:{slot:"title"},slot:"title"},[a("i",{class:t.icon||"el-icon-paperclip"}),a("span",[e._v(e._s(t.title))])]),e._l(t.children,function(t){return a("el-menu-item",{key:t.to,attrs:{index:t.to}},[t.icon?a("i",{class:t.icon}):e._e(),e._v("\n                    "+e._s(t.title)+"\n                ")])})],2):a("el-menu-item",{key:t.to,attrs:{index:t.to}},[a("i",{class:t.icon||"el-icon-paperclip"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]})],2)],1)},h=[],v=(a("7f7f"),a("cebc")),m=(a("ac4d"),a("8a81"),a("ac6a"),a("28a5"),a("60a3")),b=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.defaultActive="",e.isCollapse=!0,e.activeTitle="",e.currTabs=[],e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.currTabs=this.parseTabs(this.tabs),this.modifyActiveIndex()}},{key:"collapse",value:function(){this.isCollapse=!this.isCollapse}},{key:"modifyActiveIndex",value:function(){if(this.defaultActive=this.$route.path,this.$route.path.split("/").length<3){var e=this.currTabs||[];e.length&&(this.defaultActive=this.defaultTo(e))}this.activeTitle=this.defaultActive.split("/")[2]}},{key:"defaultTo",value:function(e){var t=e[0];return t.children&&t.children.length?this.defaultTo(t.children):t.to}},{key:"parseTabs",value:function(e){var t=[],a=!0,r=!1,i=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var s=n.value;if(s.children){var l=this.parseTabs(s.children);l.length&&t.push(Object(v["a"])({},s,{children:l}))}else"404"!==this.$router.resolve(s.to).resolved.name&&t.push(s)}}catch(c){r=!0,i=c}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return t}}]),t}(p["default"]);u["a"]([Object(m["d"])()],b.prototype,"tabs",void 0),u["a"]([Object(m["f"])("$route",{deep:!0})],b.prototype,"modifyActiveIndex",null),b=u["a"]([d["b"]],b);var g=b,y=g,x=a("6138"),j=a("2877");function w(e){this["$style"]=x["default"].locals||x["default"]}var O=Object(j["a"])(y,f,h,!1,w,null,null),k=O.exports,_=a("93f3"),$=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.display=!0,e.isMini=!1,e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.resize();var e=this.resize.bind(this);window.addEventListener("resize",e,!1),this.removeListener=function(){window.removeEventListener("resize",e,!1)}}},{key:"destroyed",value:function(){this.removeListener&&this.removeListener()}},{key:"resize",value:function(){this.isMini=document.body.offsetWidth<=_["r"],this.display=!this.isMini}}]),t}(p["default"]);u["a"]([Object(m["d"])()],$.prototype,"tabs",void 0),u["a"]([Object(m["d"])({default:function(){return!0}})],$.prototype,"hasRouter",void 0),$=u["a"]([Object(d["b"])({components:{"app-aside":k}})],$);var z=$,S=z,C=a("ec62");function D(e){this["$style"]=C["default"].locals||C["default"]}var I=Object(j["a"])(S,r,i,!1,D,null,null);t["a"]=I.exports},a105:function(e,t,a){e.exports={avatar:"Avator_avatar_3VCAB",selected:"Avator_selected_2BR72",btn:"Avator_btn_39J0o",divider:"Avator_divider_1IQL1",preview:"Avator_preview_2rP2g",model:"Avator_model_1ajrj",tip:"Avator_tip_Ym_vq",center:"Avator_center_hykGz"}},a7c1:function(e,t,a){"use strict";var r=a("a105"),i=a.n(r);t["default"]=i.a},ae85:function(e,t,a){"use strict";a("ac6a"),a("96cf");var r=a("3b8d"),i=a("d225"),n=a("b0b4"),o=a("308d"),s=a("6bb5"),l=a("4e2b"),c=a("9ab4"),u=a("2b0e"),p=a("2fe1"),d=a("d8c9"),f=a("60a3"),h=a("ab30"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{"margin-bottom":"10px"},attrs:{data:e.tableData,border:!0,"max-height":e.maxHeight,"header-row-class-name":"table-thead"}},[e._l(e.colCfg,function(t,r){return a("el-table-column",{key:r,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label,resizable:!0,"min-width":null==t.width?void 0:t.width*e.scale}})}),e.op&&e.op.length?a("el-table-column",{attrs:{label:"操作",resizable:!0,"min-width":null==e.opWidth?void 0:e.opWidth*e.scale},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"flex-center"},e._l(e.op,function(r,i){return a("el-button",{key:i,attrs:{size:"mini","v-show":!t.row.hidden,type:e._f("parse")(r.type,t.$index),disabled:!!r.isDisable&&r.isDisable(t.row)},on:{click:function(a){return e.emit(r.name,t.row,t.$index)}}},[e._v("\n                        "+e._s(e._f("parse")(r.desc,t.$index))+"\n                    ")])}),1)]}}],null,!1,750415020)}):e._e()],2),a("div",{staticClass:"flex-center",staticStyle:{"justify-content":"space-between"}},[e.noPrint?e._e():a("el-button",{attrs:{size:"mini",icon:"el-icon-printer"},on:{click:function(t){return e.emit("toExcel")}}},[e._v("\n            导出\n        ")]),a("el-pagination",{attrs:{"current-page":e.page,"page-size":e.pageSize,layout:(e.isSmall?"":"sizes, ")+"prev, pager, next",total:e.totalCount,small:!!e.isSmall,"hide-on-single-page":!!e.isSmall,"pager-count":5},on:{"size-change":function(t){return e.updateData("pageSize",t)},"current-change":function(t){return e.updateData("page",t)}}})],1)],1)},m=[],b=a("93f3"),g=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.pageSize=10,e.page=1,e.scale=1,e}return Object(l["a"])(t,e),Object(n["a"])(t,[{key:"emit",value:function(e,t,a){e=x(e,a),this.$emit(e,t,a)}},{key:"updateData",value:function(e,t){var a=this;this[e]=t,this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(function(){return a.$emit("updateData",a.page,a.pageSize)},200)}},{key:"scaleRoot",value:function(){document.body.clientWidth<=b["r"]?this.scale=b["r"]/b["f"]:this.scale=1}}]),t}(u["default"]);c["a"]([Object(f["d"])()],g.prototype,"maxHeight",void 0),c["a"]([Object(f["d"])()],g.prototype,"tableData",void 0),c["a"]([Object(f["d"])()],g.prototype,"totalCount",void 0),c["a"]([Object(f["d"])()],g.prototype,"colCfg",void 0),c["a"]([Object(f["d"])()],g.prototype,"op",void 0),c["a"]([Object(f["d"])()],g.prototype,"noPrint",void 0),c["a"]([Object(f["d"])()],g.prototype,"isSmall",void 0),c["a"]([Object(f["d"])()],g.prototype,"opWidth",void 0),g=c["a"]([Object(p["b"])({filters:{parse:x}})],g);var y=g;function x(e,t){return"string"===typeof e?e:e[t]||e.default||"404"}var j=y,w=a("2877"),O=Object(w["a"])(j,v,m,!1,null,null,null),k=O.exports,_=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.totalCount=0,e.tableData=[],e.maxHeight=100,e.colCfg=[],e.pageSize=10,e.page=1,e}return Object(l["a"])(t,e),Object(n["a"])(t,[{key:"created",value:function(){this.getData(1,10)}},{key:"mounted",value:function(){this.getMaxHeight()}},{key:"getData",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.pageSize=a,this.page=t,e.next=4,this.fetch(t,a);case 4:r=e.sent,this.totalCount=r.count,this.tableData=r.data;case 7:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"toExcel",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.bodyStr();case 2:t=e.sent,Object(h["c"])(this.headStr()+t);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"fetch",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{count:0,data:[]});case 1:case"end":return e.stop()}},e)}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"refresh",value:function(e){return null==e&&(e=this.tableData.length>1?this.page:this.page-1),this.getData(Math.max(1,e),this.pageSize),this}},{key:"headStr",value:function(){var e=["<thead><tr>"];return this.colCfg.forEach(function(t){return e.push("<th>".concat(t.label,"</th>"))}),e.push("</tr></thead>"),e.join("")}},{key:"bodyStr",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.page,Math.min(this.totalCount,2e3));case 2:return t=e.sent.data,a=["<tbody>"],t.forEach(function(e){a.push("<tr>"),r.colCfg.forEach(function(t){return a.push("<td style=\"mso-number-format:'@'\">".concat(null==e[t.prop]?" ":e[t.prop],"</td>"))}),a.push("</tr>")}),a.push("</tbody>"),e.abrupt("return",a.join(""));case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getMaxHeight",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs.table,!t){e.next=13;break}if(a=t.$el||t,!a){e.next=13;break}return e.prev=4,e.next=7,Object(d["h"])(function(){return!!a.offsetHeight});case 7:this.maxHeight=.85*a.offsetHeight,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](4),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[4,10]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"op",get:function(){return this.permission&&this.permission.delete?[{type:"danger",name:"del",desc:"删除"}]:[]}}]),t}(u["default"]);c["a"]([Object(f["d"])()],_.prototype,"permission",void 0),_=c["a"]([Object(p["b"])({components:{"app-table":k}})],_);t["a"]=_},c8ec:function(e,t,a){e.exports={aside:"Page_aside_1TrfA",btn:"Page_btn_2-Wvo"}},c94b:function(e,t,a){e.exports={icon:"Aside_icon_3B2Yj",active:"Aside_active_1U2zf"}},d1d2:function(e,t,a){"use strict";var r=function(){var e,t,a,r=this,i=r.$createElement,n=r._self._c||i;return n("div",[n("div",{on:{click:r.selectAvator}},[n("el-tooltip",{attrs:{effect:"dark",content:"人员",placement:"bottom-end"}},[n("el-image",{class:(e={},e[r.$style.avatar]=!0,e[r.$style.selected]=0===r.imgIndex,e),attrs:{src:r.pImg,fit:"contain","data-index":"0"}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"物品",placement:"bottom-end"}},[n("el-image",{class:(t={},t[r.$style.avatar]=!0,t[r.$style.selected]=1===r.imgIndex,t),attrs:{src:r.itemImg,fit:"contain","data-index":"1"}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"自定义",placement:"bottom-end"}},[n("el-image",{class:(a={},a[r.$style.avatar]=!0,a[r.$style.selected]=2===r.imgIndex,a),attrs:{src:r.customUrl||"/images/true.png",fit:"contain","data-index":"2"}})],1)],1),n("el-dialog",{class:r.$style.model,attrs:{visible:r.visible,"modal-append-to-body":!1,"append-to-body":"",width:"70%",top:"5vh",title:"裁剪头像"},on:{"update:visible":function(e){r.visible=e}}},[n("div",{staticClass:"el-divider el-divider--horizontal",class:r.$style.divider}),n("div",{class:r.$style.btn},[n("span",{staticStyle:{"margin-right":"20px"}},[r._v("本地上传")]),n("el-upload",{attrs:{accept:"image/jpeg, image/png","auto-upload":!1,action:"","show-file-list":!1,"on-change":r.changeUpload}},[n("el-button",{attrs:{size:"small",type:"primary"}},[r._v("选择文件")])],1)],1),n("el-row",{staticStyle:{margin:"20px 0"}},[n("el-col",{staticStyle:{height:"400px"},attrs:{span:16,xs:24}},[r.url?n("VueCropper",{ref:"cropper",attrs:{img:r.url,autoCrop:!0,fixed:!0,fixedNumber:[1,1],outputType:"webp"},on:{realTime:r.realTime}}):n("el-upload",{staticClass:"avatar-upload",attrs:{drag:"",accept:"image/jpeg, image/png","auto-upload":!1,action:"","show-file-list":!1,"on-change":r.changeUpload}},[n("div",{class:r.$style.center},[n("div",[n("i",{staticClass:"el-icon-upload"}),n("div",{class:r.$style.tip},[r._v("\n                                将文件拖到此处，或\n                                "),n("em",{staticStyle:{color:"#66ccff"}},[r._v("选择文件")])]),n("div",{class:r.$style.tip},[r._v("\n                                只能上传jpg/png文件，且不超过5M\n                            ")])])])])],1),n("el-col",{attrs:{span:7,xs:23,offset:1}},[n("el-row",[n("el-col",{class:r.$style.preview,style:Object.assign({},r.previewBox,{zoom:200/r.preview.w}),attrs:{span:24,xs:10}},[n("div",{style:r.preview.div},[n("img",{style:r.preview.img,attrs:{src:r.preview.url}})])]),n("el-col",{class:r.$style.preview,style:Object.assign({},r.previewBox,{zoom:100/r.preview.w}),attrs:{span:24,ofsset:1,xs:8}},[n("div",{style:r.preview.div},[n("img",{style:r.preview.img,attrs:{src:r.preview.url}})])]),n("el-col",{class:r.$style.preview,style:Object.assign({},r.previewBox,{zoom:50/r.preview.w}),attrs:{span:24,ofsset:1,xs:4}},[n("div",{style:r.preview.div},[n("img",{style:r.preview.img,attrs:{src:r.preview.url}})])])],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:6,xs:24}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:r.ok}},[r._v("\n                    确 定\n                ")])],1)],1)],1)],1)},i=[],n=(a("ac6a"),a("5df3"),a("d225")),o=a("b0b4"),s=a("308d"),l=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),d=a("2fe1"),f=a("60a3"),h=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.url="",e.visible=!1,e.previewBox={width:"1024px",height:"1024px"},e.preview=null,e.imgIndex=0,e.customUrl="",e.pImg="/images/P.png",e.itemImg="/images/item.png",e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.preview={url:"/images/true.png",div:this.previewBox,w:1024},this.avatar?this.avatar===this.itemImg?this.imgIndex=1:this.avatar!==this.pImg&&(this.imgIndex=2,this.preview.url=this.url=this.customUrl=this.avatar):this.$emit("change",this.pImg)}},{key:"changeUpload",value:function(e){return"image/png"!==e.raw.type&&"image/jpeg"!==e.raw.type?this.$message.error("只能上传jpg/png文件!"):e.size/1024/1024>5?this.$message.error("上传文件大小不能超过 5MB!"):void(this.url=URL.createObjectURL(e.raw))}},{key:"realTime",value:function(e){this.preview=e,this.previewBox={width:e.w+"px",height:e.h+"px"}}},{key:"ok",value:function(){var e=this,t=this.$refs.cropper;t?t.getCropData(function(t){e.customUrl=t,e.$emit("change",t),e.$message.success("设置成功"),e.imgIndex=2,e.visible=!1}):this.$message.warning("请选择图片!!!")}},{key:"selectAvator",value:function(e){var t=+e.target.dataset.index;if(!isNaN(t)&&t>=0&&t<=2){var a=this.imgIndex;t<2?this.imgIndex=t:2===t&&(this.customUrl&&(this.imgIndex=2),this.visible=!0),a!==this.imgIndex&&this.$emit("change",this.getUrl())}}},{key:"getImgUrl",value:function(e){var t=this,a=this.getUrl(),r=this.getcanvas(a,e).then(function(e){return t.$http.post("/api/tag/upload/tagPhoto",{tagPhoto:e.toDataURL("image/png",1)})}),i=Promise.resolve({code:200,message:"",pagedData:{currentPage:1,datas:[],pageSize:0,totalCount:0},success:!0,resultMap:{avatarUrl:a}});return this.imgIndex>1&&(i=this.$http.post("/api/tag/upload/avatar",{avatar:this.customUrl})),Promise.all([r,i])}},{key:"getcanvas",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.createElement("canvas"),r=new Image;return r.src=e,new Promise(function(e,i){r.onload=function(){a.width=100,a.height=t?100:70;var i=a.getContext("2d");t&&("20px Arial"!==i.font&&(i.font="20px Arial"),"blue"!==i.strokeStyle&&(i.strokeStyle="blue"),"center"!==i.textAlign&&(i.textAlign="center"),i.fillText(t,50,80)),i.drawImage(r,25,10,50,50),e(a)},r.onerror=i})}},{key:"getUrl",value:function(){return[this.pImg,this.itemImg,this.customUrl][this.imgIndex]}}]),t}(p["default"]);u["a"]([Object(f["c"])("change")],h.prototype,"avatar",void 0),h=u["a"]([d["b"]],h);var v=h,m=v,b=a("a7c1"),g=(a("65f9"),a("2877"));function y(e){this["$style"]=b["default"].locals||b["default"]}var x=Object(g["a"])(m,r,i,!1,y,null,null);t["a"]=x.exports},de30:function(e,t,a){},ec62:function(e,t,a){"use strict";var r=a("c8ec"),i=a.n(r);t["default"]=i.a},ffd2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200},on:{del:e.del,setting:e.setting,updateData:e.getData,toExcel:e.toExcel}})],1),e.person?[a("el-dialog",{attrs:{title:"更改标签信息",visible:!!e.person,"modal-append-to-body":!1},on:{close:function(t){e.person=null}}},[a("el-form",{attrs:{model:e.person,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"头像："}},[a("app-avator",{ref:"avator",model:{value:e.person.avatar,callback:function(t){e.$set(e.person,"avatar",t)},expression:"person.avatar"}})],1),a("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.person.name,callback:function(t){e.$set(e.person,"name",t)},expression:"person.name"}})],1),a("el-form-item",{attrs:{label:"区域"}},[a("el-select",{model:{value:e.person.zone,callback:function(t){e.$set(e.person,"zone",t)},expression:"person.zone"}},[a("el-option",{attrs:{value:void 0,label:"--"}}),e._l(e.zones.pagedData.datas,function(e){return a("el-option",{key:e.id,attrs:{value:e.id+"",label:e.name}})})],2)],1),a("el-form-item",{attrs:{label:"属性"}},[a("el-input",{attrs:{placeholder:"性别: 女, 部门: 研发"},model:{value:e.person.properties,callback:function(t){e.$set(e.person,"properties",t)},expression:"person.properties"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{on:{click:function(t){e.person=null}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],2)]:e._e()],2)},i=[],n=(a("7514"),a("ac6a"),a("5df3"),a("768b")),o=(a("96cf"),a("3b8d")),s=a("cebc"),l=(a("7f7f"),a("d225")),c=a("b0b4"),u=a("308d"),p=a("6bb5"),d=a("4e2b"),f=a("9ab4"),h=a("2fe1"),v=a("ae85"),m=a("60a3"),b=a("d1d2"),g=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(u["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.person=null,e.colCfg=[{prop:"id",label:"ID",sortable:!0,width:100},{prop:"name",label:"名称",width:120},{prop:"tagNo",label:"编号",width:120},{prop:"zoneName",label:"区域",width:120},{prop:"properties",label:"属性",width:200}],e}return Object(d["a"])(t,e),Object(c["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除标签".concat(e.name,"?")).then(function(){return t.$http.post("/api/tag/deleteTag",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"setting",value:function(e){this.person=e,this.oldData=Object(s["a"])({},e)}},{key:"submit",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.person&&this.oldData){e.next=2;break}return e.abrupt("return");case 2:if(this.person.name){e.next=4;break}return e.abrupt("return",this.$message.warning("name is required!"));case 4:return e.prev=4,e.next=7,this.$confirm("确认修改?");case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](4),e.abrupt("return");case 12:if(this.person.updateTime=Date.now(),this.person.name===this.oldData.name&&this.person.avatar===this.oldData.avatar){e.next=17;break}return e.next=16,this.avator.getImgUrl(this.person.name);case 16:this.person.photo=e.sent[0].resultMap.photoUrl;case 17:this.$http.post("/api/tag/updateTag",this.person,{"Content-Type":"application/json"}).then(function(){t.$message.success("修改成功"),t.refresh()}).catch(console.log);case 18:case"end":return e.stop()}},e,this,[[4,9]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"fetch",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,a){var r,i,o,s,l,c,u=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=[],i=0,e.prev=2,e.next=5,Promise.all([this.$http.get("/api/tag/getall",{pageSize:a,currentPage:t,type:this.type||1}),Promise.resolve().then(function(){return u.zones||u.$http.get("/api/zone/getall",{pageSize:1e6,currentPage:1})})]);case 5:o=e.sent,s=Object(n["a"])(o,2),l=s[0],c=s[1],r=l.pagedData.datas.map(function(e){var t=c.pagedData.datas.find(function(t){return+t.id===+e.zone});return e.zoneName=t?t.name:"未知区域",e}),i=l.pagedData.totalCount,this.zones=c,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),console.log(e.t0);case 17:return e.abrupt("return",{count:i,data:r});case 18:case"end":return e.stop()}},e,this,[[2,14]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"routeUpdate",value:function(){this.getData(1,10)}},{key:"op",get:function(){var e=[];return this.permission.delete&&e.push({type:"danger",name:"del",desc:"删除"}),this.permission.put&&e.push({type:"primary",name:"setting",desc:"配置"}),e}}]),t}(Object(h["c"])(v["a"]));f["a"]([Object(m["d"])()],g.prototype,"type",void 0),f["a"]([Object(m["d"])()],g.prototype,"permission",void 0),f["a"]([Object(m["e"])("avator")],g.prototype,"avator",void 0),f["a"]([Object(m["f"])("$route.params.type")],g.prototype,"routeUpdate",null),g=f["a"]([Object(h["b"])({components:{"app-avator":b["a"]}})],g);var y=g,x=y,j=a("2877"),w=Object(j["a"])(x,r,i,!1,null,null,null);t["default"]=w.exports}}]);
//# sourceMappingURL=people.2dca09bd.js.map