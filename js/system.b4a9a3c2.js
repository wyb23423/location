(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["system"],{1422:function(e,t,n){e.exports={op:"Fence_op_1V_MP",submit:"Fence_submit_Thr33",point:"Fence_point_16SnX",map:"Fence_map_1p_ia",mask:"Fence_mask_3vxkV"}},"1b8b":function(e,t,n){"use strict";var a=n("6558"),o=n.n(a);t["default"]=o.a},"20d6":function(e,t,n){"use strict";var a=n("5ca1"),o=n("0a49")(6),i="findIndex",r=!0;i in[]&&Array(1)[i](function(){r=!1}),a(a.P+a.F*r,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(i)},"2c1b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"5%",height:"100%"}},[n("el-card",{ref:"table",staticClass:"card"},[n("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200,isSmall:!0},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},o=[],i=(n("c5f6"),n("96cf"),n("3b8d")),r=n("d225"),s=n("b0b4"),l=n("308d"),c=n("6bb5"),u=n("4e2b"),p=n("9ab4"),f=n("2fe1"),d=n("ae85"),h=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"ID",sortable:!0,width:220},{prop:"name",label:"协议名称",width:220},{prop:"port",label:"协议端口号",width:220},{prop:"effect",label:"协议作用",width:220},{prop:"content",label:"协议内容",width:220}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除协议".concat(e.id,"?")).then(function(){return t.$http.post("/api/protocol/deleteProtocol",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var a,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/protocol/getall",{pageSize:Number.MAX_VALUE,currentPage:1});case 5:i=e.sent,a=i.pagedData.datas,o=i.pagedData.totalCount||a.length,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:a});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,n){return e.apply(this,arguments)}return t}()}]),t}(Object(f["c"])(d["a"]));h=p["a"]([f["b"]],h);var m=h,b=m,v=n("2877"),g=Object(v["a"])(b,a,o,!1,null,null,null);t["default"]=g.exports},"54b6":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{paste:function(t){return e.paste(t)}}},e._l(new Array(e.length).fill(1),function(t,a){return n("el-input",{key:a,ref:"ip",refInFor:!0,class:e.$style.ip,on:{input:function(t){return e.next(a)}},model:{value:e.value[a],callback:function(t){e.$set(e.value,a,t)},expression:"value[i]"}},[a<e.length-1?n("span",{attrs:{slot:"append"},slot:"append"},[e._v(".")]):e._e()])}),1)},o=[],i=(n("c5f6"),n("fca0"),n("ac4d"),n("8a81"),n("28a5"),n("ac6a"),n("5df3"),n("1c4c"),n("20d6"),n("d225")),r=n("b0b4"),s=n("308d"),l=n("6bb5"),c=n("4e2b"),u=n("9ab4"),p=n("2b0e"),f=n("2fe1"),d=n("60a3"),h=function(e){function t(){return Object(i["a"])(this,t),Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"next",value:function(e){var t=this.value[e],n=this.parseIp(t);return this.$set(this.value,e,n),(n.length>=(this.max+"").length||/^\d+\.$/.test(t))&&e<this.length-1&&this.$refs.ip[e+1].focus(),t.length<=0&&e>0&&this.$refs.ip[e-1].focus(),this.value}},{key:"paste",value:function(e){var t=this,n=this.$refs.ip.findIndex(function(t){return t.$refs.input===e.target});if(n>-1)for(var a=0,o=Array.from(e.clipboardData.items);a<o.length;a++){var i=o[a];"text/plain"===i.type&&i.getAsString(function(e){return t.pasteHandler(e,n)})}return this.value}},{key:"pasteHandler",value:function(e,t){this.$refs.ip;var n=!0,a=!1,o=void 0;try{for(var i,r=e.split(".")[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;if(t>this.length-1)break;s&&this.$set(this.value,t++,this.parseIp(s).substr(0,3))}}catch(l){a=!0,o=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}}},{key:"parseIp",value:function(e){var t=parseInt(e,10);return Number.isFinite(t)?(t=Math.max(this.min,Math.min(t,this.max)),t+""):""}}]),t}(p["default"]);u["a"]([Object(d["d"])({default:function(){return[]}})],h.prototype,"value",void 0),u["a"]([Object(d["d"])({default:function(){return 0}})],h.prototype,"min",void 0),u["a"]([Object(d["d"])({default:function(){return 255}})],h.prototype,"max",void 0),u["a"]([Object(d["d"])({default:function(){return 4}})],h.prototype,"length",void 0),u["a"]([Object(d["b"])("input")],h.prototype,"next",null),u["a"]([Object(d["b"])("input")],h.prototype,"paste",null),h=u["a"]([f["b"]],h);var m=h,b=m,v=n("1b8b"),g=n("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var k=Object(g["a"])(b,a,o,!1,y,null,null);t["a"]=k.exports},6558:function(e,t,n){e.exports={ip:"IpInput_ip_1-NJb"}},"6efb":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"5%",height:"100%"}},[n("el-card",{ref:"table",staticClass:"card"},[n("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":120},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},o=[],i=(n("96cf"),n("3b8d")),r=n("d225"),s=n("b0b4"),l=n("308d"),c=n("6bb5"),u=n("4e2b"),p=n("9ab4"),f=n("2fe1"),d=n("cda1"),h=n("ae85"),m=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"摄像头ID",sortable:!0,width:140},{prop:"ip",label:"摄像头IP",width:260},{prop:"port",label:"设备端口号",width:200},{prop:"groupCode",label:"所属组号",sortable:!0,width:200},{prop:"username",label:"用户名",width:220},{prop:"windowSplit",label:"窗口分割数",width:140}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除摄像头".concat(e.id,"?")).then(function(){return t.$http.post("/api/camera/deleteCamera",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var a,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/camera/getall",{pageSize:n,currentPage:t});case 5:i=e.sent,a=i.pagedData.datas,o=i.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:a});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,n){return e.apply(this,arguments)}return t}()}]),t}(Object(f["c"])(h["a"]));p["a"]([d["a"]],m.prototype,"baseUrl",void 0),m=p["a"]([f["b"]],m);var b=m,v=b,g=n("2877"),y=Object(g["a"])(v,a,o,!1,null,null,null);t["default"]=y.exports},"7d65":function(e,t,n){e.exports={alert:"Submissio_alert_pkBiZ"}},"93f1":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"5%",height:"100%"}},[n("el-card",{staticClass:"card"},[n("div",{class:e.$style.alert},[e._v("协议下发 请选择")]),n("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[n("el-form-item",{attrs:{label:"选择基站：",prop:"base",required:""}},[n("el-cascader",{attrs:{options:e.base,props:{expandTrigger:"hover"},filterable:"","show-all-levels":!1},model:{value:e.form.base,callback:function(t){e.$set(e.form,"base",t)},expression:"form.base"}})],1),n("el-form-item",{attrs:{label:"选择协议：",prop:"protocol",required:""}},[n("el-select",{attrs:{filterable:""},model:{value:e.form.protocol,callback:function(t){e.$set(e.form,"protocol",t)},expression:"form.protocol"}},e._l(e.protocols,function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),n("el-form-item",{attrs:{label:"端口号："}},[n("el-radio",{attrs:{label:5e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    50000端口\n                ")]),n("el-radio",{attrs:{label:6e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    60000端口\n                ")])],1),n("el-form-item",[n("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                    立即提交\n                ")]),n("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)],1)},o=[],i=n("768b"),r=(n("ffc1"),n("ac6a"),n("7f7f"),n("d225")),s=n("b0b4"),l=n("308d"),c=n("6bb5"),u=n("4e2b"),p=n("9ab4"),f=n("2fe1"),d=n("2b0e"),h=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e.base=[],e.tags=[],e.protocols=[],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init(),this.getData()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){Date.now();var n={ip:e.form.base[1],port:e.form.port,protocol:e.form.protocol};e.$http.post("/api/protocol/sendProtocol",n).then(function(t){e.$message.success(t.message),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={base:[],port:5e4,protocol:"",tagNo:""}}},{key:"getData",value:function(){var e=this;this.$http.get("/api/base/getall",{pageSize:1e7,currentPage:1}).then(this.toTree.bind(this)).catch(console.error),this.$http.get("/api/tag/getall",{pageSize:1e7,currentPage:1}).then(function(e){return e.pagedData.datas.map(function(e){return{value:e.tagNo,label:"".concat(e.name,": ").concat(e.tagNo)}})}).then(function(t){return e.tags=t}).catch(console.error),this.$http.get("/api/protocol/getall",{pageSize:1e7,currentPage:1}).then(function(t){e.protocols=t.pagedData.datas.map(function(e){return{value:e.content,label:e.name}})}).catch(console.error)}},{key:"toTree",value:function(e){this.base.length=0;var t={};e.pagedData.datas.forEach(function(e){(t[e.groupCode]||(t[e.groupCode]=[])).push({value:e.ip,label:"".concat(e.name,": ").concat(e.baseNo,"; ").concat(e.main?"主":"从","基站")})});for(var n=0,a=Object.entries(t);n<a.length;n++){var o=Object(i["a"])(a[n],2),r=o[0],s=o[1];this.base.push({label:"分组".concat(r),children:s})}}}]),t}(d["default"]);h=p["a"]([f["b"]],h);var m=h,b=m,v=n("a810"),g=n("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var k=Object(g["a"])(b,a,o,!1,y,null,null);t["default"]=k.exports},9826:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-page",{attrs:{tabs:e.tabs}})},o=[],i=n("d225"),r=n("308d"),s=n("6bb5"),l=n("4e2b"),c=n("9ab4"),u=n("2fe1"),p=n("2b0e"),f=n("9973"),d=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(r["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.tabs=[{title:"电子围栏",to:"/system/fence",icon:"el-icon-crop"},{title:"标签绑定",to:"/system/bind",icon:"el-icon-connection"},{title:"摄像头",to:"camera",icon:"el-icon-video-camera",children:[{title:"摄像头添加",to:"/system/camera/add",icon:"el-icon-circle-plus-outline"},{title:"摄像头列表",to:"/system/camera/list",icon:"el-icon-tickets"}]},{title:"协议",to:"protocol",icon:"el-icon-document",children:[{title:"协议添加",to:"/system/protocol/add",icon:"el-icon-document-add"},{title:"协议列表",to:"/system/protocol/list",icon:"el-icon-document-copy"},{title:"下发协议",to:"/system/protocol/submissio",icon:"el-icon-takeaway-box"}]}],e}return Object(l["a"])(t,e),t}(p["default"]);d=c["a"]([Object(u["b"])({components:{"app-page":f["a"]}})],d);var h=d,m=h,b=n("2877"),v=Object(b["a"])(m,a,o,!1,null,null,null);t["default"]=v.exports},"9b6a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[n("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[n("el-form-item",{attrs:{label:"摄像头品牌："}},[n("el-select",{model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},e._l(["海康","大华"],function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t+1}})}),1)],1),n("el-form-item",{attrs:{label:"摄像头IP：",required:""}},[n("ip-input",{model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),n("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[n("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),n("el-form-item",{attrs:{label:"用户名：",prop:"username",required:""}},[n("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),n("el-input",{staticClass:"hidden"})],1),n("el-form-item",{attrs:{label:"密码：",prop:"password",required:""}},[n("el-input",{staticClass:"hidden",attrs:{type:"password"}}),n("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",{attrs:{label:"窗口分割数: ",prop:"windowSplit",required:""}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.windowSplit,callback:function(t){e.$set(e.form,"windowSplit",t)},expression:"form.windowSplit"}},e._l([1,2,3,4],function(e){return n("el-option",{key:e,attrs:{value:e,label:e+"X"+e}})}),1)],1),n("el-form-item",{attrs:{label:"所在组号：",prop:"groupCode",required:""}},[n("el-input",{model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),n("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},o=[],i=n("cebc"),r=n("d225"),s=n("b0b4"),l=n("308d"),c=n("6bb5"),u=n("4e2b"),p=n("9ab4"),f=n("2fe1"),d=n("2b0e"),h=n("54b6"),m=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.form.ip.every(function(e){return!isNaN(+e)}),n=this.$refs.form;n.validate(function(n){if(!t)return e.$message.warning("摄像头ip不完整");if(isNaN(e.form.groupCode))return e.$message.warning("组号只能包含数字");if(n){Date.now();var a=Object(i["a"])({},e.form);a.ip=e.form.ip.join("."),a.createTime=a.updateTime=Date.now(),a.createUser=a.updateUser="string",e.$http.post("/api/camera/addCamera",a,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={username:"",ip:["","","",""],port:"",groupCode:"",windowSplit:1,password:"",brand:1}}}]),t}(d["default"]);m=p["a"]([Object(f["b"])({components:{"ip-input":h["a"]}})],m);var b=m,v=b,g=n("2877"),y=Object(g["a"])(v,a,o,!1,null,null,null);t["default"]=y.exports},a810:function(e,t,n){"use strict";var a=n("7d65"),o=n.n(a);t["default"]=o.a},ace6:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"5%",height:"100%"}},[n("el-card",{staticStyle:{height:"100%"},attrs:{"body-style":e.bodyStyle}},[n("el-carousel",{staticStyle:{width:"100%"},attrs:{autoplay:!1,"indicator-position":"outside",type:e.rootWidth>=1300?"card":"",trigger:"click",arrow:e.bindings.length>1?"hover":"never"},on:{change:function(t){e.index=t}}},e._l(e.bindings,function(t,a){return n("el-carousel-item",{key:t.id},[n("el-transfer",{staticClass:"flex-center",attrs:{type:"card",data:e.data[a],titles:["标签数据","绑定标签"]},model:{value:t.tags,callback:function(n){e.$set(t,"tags",n)},expression:"v.tags"}},[n("el-input",{staticStyle:{transform:"translateY(-1px)"},attrs:{slot:"left-footer",placeholder:"标签名/编号",type:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSource(a)}},slot:"left-footer",model:{value:e.keyWord[a],callback:function(t){e.$set(e.keyWord,a,t)},expression:"keyWord[i]"}}),n("div",{staticClass:"flex-center",staticStyle:{height:"100%"},attrs:{slot:"right-footer"},slot:"right-footer"},[-1!==t.id?[n("el-tooltip",{attrs:{effect:"dark",content:"更新",placement:"left"}},[n("el-button",{attrs:{disabled:e.index!==a,size:"mini",type:"primary",circle:"",icon:"el-icon-refresh"},on:{click:function(t){return e.doUpdata(a)}}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"right"}},[n("el-button",{attrs:{disabled:e.index!==a,size:"mini",type:"danger",circle:"",icon:"el-icon-delete"},on:{click:function(t){return e.doDelete(a)}}})],1)]:n("el-tooltip",{attrs:{effect:"dark",content:"添加",placement:"right"}},[n("el-button",{attrs:{disabled:e.index!==a,size:"mini",type:"success",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.doAdd(a)}}})],1)],2)],1)],1)}),1)],1)],1)},o=[],i=n("75fc"),r=(n("ac6a"),n("96cf"),n("3b8d")),s=(n("7f7f"),n("bd86")),l=n("d225"),c=n("b0b4"),u=n("308d"),p=n("6bb5"),f=n("4e2b"),d=n("9ab4"),h=n("2b0e"),m=n("2fe1"),b=n("cda1"),v=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(u["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.bodyStyle=Object(s["a"])({height:"100%",display:"flex"},"align-items","center"),e.data=[],e.bindings=[],e.keyWord=[],e.index=0,e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){this.initData()}},{key:"getSource",value:function(e){var t=this;return this.$http.get("/api/tag/getall",{pageSize:100,currentPage:1,tagNo:this.keyWord[e]}).then(function(n){var a=n.pagedData.datas.map(function(e){return{key:e.tagNo,label:e.name,disabled:!1}});return t.assignBindings(a,e),!0}).catch(console.log)}},{key:"doAdd",value:function(e){console.log(e)}},{key:"doDelete",value:function(e){console.log(e)}},{key:"doUpdata",value:function(e){console.log(e)}},{key:"initData",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.bindings=[{id:1,tags:["00000004","00000005"]},{id:2,tags:["00000001","00000008"]},{id:3,tags:["00000001","00000011"]}],this.bindings.unshift({id:-1,tags:[]}),e.next=4,this.getSource(0);case 4:if(t=e.sent,t)for(n=this.data[0],a=1;a<this.bindings.length;a++)this.assignBindings(n,a);case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"assignBindings",value:function(e,t){var n=[];this.bindings[t].tags.forEach(function(t){e.some(function(e){return e.key===e})||n.push({key:t,label:"标签"+t,disabled:!1})}),this.$set(this.data,t,[].concat(Object(i["a"])(e),n))}}]),t}(h["default"]);d["a"]([b["a"]],v.prototype,"rootWidth",void 0),v=d["a"]([m["b"]],v);var g=v,y=g,k=n("2877"),x=Object(k["a"])(y,a,o,!1,null,null,null);t["default"]=x.exports},b1fa:function(e,t,n){"use strict";var a=n("1422"),o=n.n(a);t["default"]=o.a},be03:function(e,t,n){e.exports={ip:"ProtocolAdd_ip_2eYu2"}},c3e5:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[n("h3",{staticStyle:{color:"#009688"}},[e._v("\n        协议添加\n    ")]),n("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[n("el-form-item",{attrs:{label:"协议名称：",prop:"name",required:""}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"协议作用：",prop:"effect",required:""}},[n("el-input",{model:{value:e.form.effect,callback:function(t){e.$set(e.form,"effect",t)},expression:"form.effect"}})],1),n("el-form-item",{attrs:{label:"协议内容：",prop:"content",required:""}},[n("el-input",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),n("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[n("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),n("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},o=[],i=n("cebc"),r=n("d225"),s=n("b0b4"),l=n("308d"),c=n("6bb5"),u=n("4e2b"),p=n("9ab4"),f=n("2fe1"),d=n("2b0e"),h=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){var n=Object(i["a"])({},e.form);n.createTime=n.updateTime=Date.now(),n.createUser=n.updateUser="string",e.$http.post("/api/protocol/addProtocol",n,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={name:"",port:"",effect:"",content:""}}}]),t}(d["default"]);h=p["a"]([f["b"]],h);var m=h,b=m,v=n("d34c"),g=n("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var k=Object(g["a"])(b,a,o,!1,y,null,null);t["default"]=k.exports},cda1:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("2fe1"),o=n("2f62"),i=r("computed",o["e"]);r("computed",o["c"]),r("methods",o["b"]),r("methods",o["d"]);function r(e,t){function n(n,o){return Object(a["a"])(function(a,i){a[e]||(a[e]={});var r,s=(r={},r[i]=n,r);a[e][i]=void 0!==o?t(o,s)[i]:t(s)[i]})}function o(e,t){if("string"===typeof t){var a=t,o=e;return n(a,void 0)(o,a)}var i=s(t),r=e;return n(r,i)}return o}function s(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}},d34c:function(e,t,n){"use strict";var a=n("be03"),o=n.n(a);t["default"]=o.a},fc9b:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-box"},[n("div",{ref:"map",class:e.$style.map}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isDrawing,expression:"isDrawing"}],class:[e.$style.map,e.$style.mask],on:{pointermove:e.move,pointerup:e.addPoint}}),n("div",{staticClass:"map-tool-bar",staticStyle:{display:"flex","align-items":"center"}},[n("map-select",{directives:[{name:"show",rawName:"v-show",value:!e.isDrawing,expression:"!isDrawing"}],staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}}),e.isDrawing?n("div",{staticStyle:{"padding-left":"10%",width:"100%"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-d-arrow-left",disabled:!e.points.length},on:{click:e.prev}}),n("el-button",{attrs:{size:"mini",icon:"el-icon-d-arrow-right",disabled:!e.popPoints.length},on:{click:e.next}}),n("el-button",{attrs:{size:"mini",icon:"el-icon-check"},on:{click:e.ok}}),n("el-button",{attrs:{size:"mini",icon:"el-icon-close"},on:{click:e.cancel}})],1):e._e()],1),n("el-collapse",{directives:[{name:"show",rawName:"v-show",value:!e.isDrawing,expression:"!isDrawing"}],class:e.$style.op,model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[e.permission.get?n("el-collapse-item",{attrs:{name:"info",title:"区域信息"}},[n("app-table",{class:e.$style.table,attrs:{"max-height":255,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.operation,"op-width":200,noPrint:!0,isSmall:!0},on:{updateData:e.getData,del:e.del,setting:function(t){e.zone=t},display:e.display}})],1):e._e(),e.permission.post?n("el-collapse-item",{attrs:{title:"添加区域",name:"add"}},[n("zone-input",{attrs:{"form-height":"calc(100vh - 500px)",groups:e.groups},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[n("el-form-item",{attrs:{label:"区域顶点"}},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.enterDrawingMode}},[e._v("\n                        设置\n                    ")])],1)],1),n("el-button",{class:e.$style.submit,attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                提交\n            ")])],1):e._e()],1),e.zone?[n("el-dialog",{attrs:{title:"更改区域信息",visible:!!e.zone,"modal-append-to-body":!1},on:{close:function(t){e.zone=null}}},[n("zone-input",{attrs:{groups:e.groups},model:{value:e.zone,callback:function(t){e.zone=t},expression:"zone"}}),n("template",{slot:"footer"},[n("el-button",{on:{click:function(t){e.zone=null}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],2)]:e._e()],2)},o=[],i=n("cebc"),r=(n("20d6"),n("7f7f"),n("96cf"),n("3b8d")),s=n("d225"),l=n("b0b4"),c=n("308d"),u=n("6bb5"),p=n("4e2b"),f=n("9ab4"),d=n("2fe1"),h=n("ae85"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{staticStyle:{overflow:"auto"},style:{"max-height":e.formHeight},attrs:{model:e.zone,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"区域名称",required:""}},[n("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.zone.name,callback:function(t){e.$set(e.zone,"name",t)},expression:"zone.name"}})],1),n("el-form-item",{attrs:{label:"区域模式"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.zone.mode,callback:function(t){e.$set(e.zone,"mode",t)},expression:"zone.mode"}},[n("el-option",{attrs:{label:"进入区域",value:e.zoneMode.in}}),n("el-option",{attrs:{label:"离开区域",value:e.zoneMode.out}}),e.groups.length>=2?n("el-option",{attrs:{label:"切换区域",value:e.zoneMode.switch}}):e._e(),n("el-option",{attrs:{label:"分组区域",value:e.zoneMode.group}}),n("el-option",{attrs:{label:"其他",value:e.zoneMode.other}})],1)],1),e.zone.mode===e.zoneMode.group?n("el-form-item",{attrs:{label:"相关分组",required:""}},[n("el-select",{model:{value:e.zone.baseNo1,callback:function(t){e.$set(e.zone,"baseNo1",t)},expression:"zone.baseNo1"}},e._l(e.groups,function(e){return n("el-option",{key:e,attrs:{value:e}})}),1)],1):e._e(),e.zone.mode===e.zoneMode.switch?[n("el-form-item",{attrs:{label:"基站分组1",required:""}},[n("el-select",{model:{value:e.zone.baseNo1,callback:function(t){e.$set(e.zone,"baseNo1",t)},expression:"zone.baseNo1"}},e._l(e.groups,function(t){return n("el-option",{key:t,attrs:{value:t,disabled:t===e.zone.baseNo2}})}),1)],1),n("el-form-item",{attrs:{label:"基站分组2",required:""}},[n("el-select",{model:{value:e.zone.baseNo2,callback:function(t){e.$set(e.zone,"baseNo2",t)},expression:"zone.baseNo2"}},e._l(e.groups,function(t){return n("el-option",{key:t,attrs:{value:t,disabled:t===e.zone.baseNo1}})}),1)],1)]:e._e(),e._t("default"),n("el-form-item",{attrs:{label:"启动"}},[n("el-switch",{attrs:{"active-text":"true","inactive-text":"false"},model:{value:e.zone.open,callback:function(t){e.$set(e.zone,"open",t)},expression:"zone.open"}})],1)],2)},b=[],v=n("2b0e"),g=n("60a3"),y=n("cda1"),k=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.zone={},e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.value||console.error("组件缺少v-model绑定!"),this.zone=this.value||{}}},{key:"getVlaue",value:function(e){this.zone=e}},{key:"setValue",value:function(e){}}]),t}(v["default"]);f["a"]([y["a"]],k.prototype,"zoneMode",void 0),f["a"]([Object(g["d"])({default:function(){return"none"}})],k.prototype,"formHeight",void 0),f["a"]([Object(g["d"])()],k.prototype,"groups",void 0),f["a"]([Object(g["c"])("change")],k.prototype,"value",void 0),f["a"]([Object(g["f"])("value",{deep:!0})],k.prototype,"getVlaue",null),f["a"]([Object(g["b"])("change"),Object(g["f"])("zone",{deep:!0})],k.prototype,"setValue",null),k=f["a"]([g["a"]],k);var x,w=k,O=w,j=n("2877"),$=Object(j["a"])(O,m,b,!1,null,null,null),_=$.exports,z=(n("7514"),n("ac6a"),n("75fc")),N=n("b3c9"),S=n("c860"),C=n("0876");function D(e,t,n,a){var o=E(e,t,n),i=E(e,t,a),r=E(n,a,e),s=E(n,a,t);return o*i>0||r*s>0?{isCollinear:!1,result:!1}:0===o&&0===i?{isCollinear:!0,result:M(e,t,n,a)}:{isCollinear:!1,result:!0}}function E(e,t,n){return(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x)}function M(e,t,n,a){return Math.min(e.y,t.y)<=Math.max(n.y,a.y)&&Math.max(e.y,t.y)>=Math.min(n.y,a.y)&&Math.min(e.x,t.x)<=Math.max(n.x,a.x)&&Math.max(e.x,t.x)>=Math.min(n.x,a.x)}var I=x=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.isDrawing=!1,e.points=[],e.popPoints=[],e.isClose=!1,e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"move",value:function(e){if(this.mgr&&this.points.length&&this.container){this.mgr.lineMgr.remove(x.LINE_NAME);var t=this.container.getBoundingClientRect(),n=this.getCoord(e.x-t.left,e.y-t.top);this.mgr.addLine([].concat(Object(z["a"])(this.points),[Object(i["a"])({},n,{z:9})]),x.LINE_STYLE,x.LINE_NAME,!0)}}},{key:"addPoint",value:function(e){if(this.mgr&&this.container){this.isClose&&(this.mgr.lineMgr.remove(x.LINE_NAME),this.isClose=!1);var t=this.container.getBoundingClientRect(),n=this.getCoord(e.x-t.left,e.y-t.top);this.hasIntersection(n)||(this._addPoint(n),this.popPoints.length=0)}}},{key:"enterDrawingMode",value:function(){this.isClose&&this.rePaint(),this.isDrawing=!0,this.isClose=!1}},{key:"prev",value:function(){var e=this.points.pop();e&&(this.popPoints.push(e),this.mgr&&(this.mgr.remove(JSON.stringify({x:e.x,y:e.y})),this.rePaint()))}},{key:"next",value:function(){var e=this.popPoints.pop();e&&this._addPoint(e)}},{key:"cancel",value:function(){var e=this;this.$confirm("清除当前图形并退出绘制模式?").then(function(){e.remove(),e.isDrawing=!1}).catch(console.log)}},{key:"ok",value:function(){if(this.isClose=!0,this.rePaint(),this.mgr&&this.mgr.appendLine(x.LINE_NAME,[this.points[0]],!0),this.hasIntersection(this.points[0]))return this.$message.warning("当前图形存在相交线段，请重新设置");this.isDrawing=!1}},{key:"initData",value:function(){this.points.length=0,this.popPoints.length=0,this.isDrawing=!1,this.isClose=!1}},{key:"bindEvents",value:function(){var e=this;this.mgr.on("loadComplete",function(){return e.tagAnchor()})}},{key:"remove",value:function(){var e=this;return this.mgr&&(this.points.forEach(function(t){return e.mgr.remove(JSON.stringify({x:t.x,y:t.y}))}),this.mgr.lineMgr.remove()),this.points.length=0,this}},{key:"_addPoint",value:function(e){this.mgr&&(this.points.push(Object(i["a"])({},this.mgr.addImage({x:e.x,y:e.y,url:"/images/blueImageMarker.png",size:32,height:2},JSON.stringify({x:e.x,y:e.y})),{z:9})),this.points.length>1&&(this.mgr.lineMgr.find(x.LINE_NAME).length?this.mgr.appendLine(x.LINE_NAME,[Object(i["a"])({},e,{z:9})],!0):this.mgr.addLine(Object(z["a"])(this.points),x.LINE_STYLE,x.LINE_NAME,!0)))}},{key:"hasIntersection",value:function(e){var t=this.points[this.points.length-1];if(t)for(var n=0;n<this.points.length-1;n++){var a=D(this.points[n],this.points[n+1],t,e),o=a.isCollinear,i=a.result;if(i&&(o||this.points[n+1]!==t&&this.points[n]!==e))return!0}return!1}},{key:"rePaint",value:function(){this.mgr&&(this.mgr.lineMgr.remove(x.LINE_NAME),this.points.length>1&&this.mgr.addLine(Object(z["a"])(this.points),x.LINE_STYLE,x.LINE_NAME,!0))}},{key:"getCoord",value:function(e,t){if(this.mgr instanceof S["a"])return this.mgr.map.coordScreenToMap(e,t,9);if(this.mgr instanceof C["a"]){var n=this.mgr.stage.toLocal(new PIXI.Point(e,t));return Object(i["a"])({},n,{z:9})}return console.warn("地图错误...."),{x:e,y:t,z:9}}}]),t}(Object(d["c"])(N["a"]));I.LINE_NAME="zone_line",I.LINE_STYLE={lineType:fengmap.FMLineType.FULL,lineWidth:2,smooth:!1,color:"#e00",colorNum:15597568},I=x=f["a"]([d["b"]],I);var P=I,L=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.activeNames=["info","add"],e.zone=null,e.colCfg=[{prop:"name",label:"区域",sortable:!0,width:90},{prop:"status",label:"状态",width:60}],e.operation=[{type:{default:"primary"},name:"display",desc:{default:"显示"}}],e.form={name:"",mode:2,open:!0},e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.permission.delete&&this.operation.push({type:"danger",name:"del",desc:"删除"}),this.permission.put&&this.operation.push({type:"warning",name:"setting",desc:"设置"}),this.form.mode=this.zoneMode.in}},{key:"del",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("确认删除区域".concat(t.name,"?"),"确认删除");case 3:return e.next=5,this.$http.post("/api/zone/deleteZone",{id:t.id});case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",console.log(e.t0));case 10:this.refresh().display(t,n,!0).$message.success("删除成功");case 11:case"end":return e.stop()}},e,this,[[0,7]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"display",value:function(e,t,n){var a=this.operation.findIndex(function(e){return"display"===e.name});if(a>-1){var o=this.operation[a];o.type[t]||n?(o.type[t]=void 0,this.mgr&&this.mgr.remove(e.name)):(o.type[t]="success",this.mgr&&this.mgr.zoneOpen(e)),o.desc[t]=o.desc[t]||n?void 0:"隐藏",this.$set(this.operation,a,o)}return this}},{key:"onSubmit",value:function(){if(!this.form.name)return this.$message.error("区域名称不能为空");var e=this.points.length;return e<3?this.$message.warning("区域坐标最少设置3个"):this.form.mode===this.zoneMode.switch&&4!==e?this.$message.warning("切换区域坐标必须为4个"):void this.put()}},{key:"update",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.zone){e.next=19;break}if(this.zone.name){e.next=3;break}return e.abrupt("return",this.$message.error("区域名称不能为空"));case 3:if(this.zone.mode!==this.zoneMode.switch){e.next=17;break}if(t=this.zone.position.length,!(t<4)){e.next=7;break}return e.abrupt("return",this.$message.warning("此区域坐标数少于4, 不能设置为切换区域"));case 7:if(!(t>4)){e.next=17;break}return e.prev=8,e.next=11,this.$confirm("此区域坐标数为".concat(t,", 将删除最后的").concat(t-4,"个坐标点"));case 11:this.zone.position=this.zone.position.slice(0,4),e.next=17;break;case 14:return e.prev=14,e.t0=e["catch"](8),e.abrupt("return");case 17:n=Object(i["a"])({},this.zone,{position:JSON.stringify(this.zone.position),updateTime:Date.now(),enable:this.zone.open?1:0}),this.$http.post("/api/zone/updateZone",n,{"Content-Type":"application/json"}).then(function(){return a.refresh().$message.success("修改区域信息成功")}).catch(console.log);case 19:case"end":return e.stop()}},e,this,[[8,14]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"fetch",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){var a,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/zone/getall",{pageSize:n,currentPage:t});case 5:i=e.sent,a=i.pagedData.datas.map(function(e){return e.status=e.enable?"开启":"关闭",e.position=JSON.parse(e.position),e.open=!!e.enable,e.mode=null==e.mode?0:e.mode,e}),o=i.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:a});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"put",value:function(){var e=this;this.$confirm("请确定当前区域范围","提示",{type:"info"}).then(this.submitAddZone.bind(this)).then(function(){return e.remove().resetForm().refresh().$message.success("添加成功")}).catch(console.log)}},{key:"submitAddZone",value:function(){var e=this,t=Date.now();if(!this.mgr)return this.$message.error("地图不存在, 提交失败!"),Promise.reject("地图不存在");var n=Object.assign({},this.form,{position:JSON.stringify(this.points.map(function(t){return e.mgr.getCoordinate(t)})),enable:this.form.open?1:0,createTime:t,updateTime:t});return this.$http.post("/api/zone/addZone",n,{"Content-Type":"application/json"})}},{key:"resetForm",value:function(){return this.form={name:"",mode:this.zoneMode.in,open:!0},this}}]),t}(Object(d["c"])(h["a"],P));f["a"]([y["a"]],L.prototype,"zoneMode",void 0),L=f["a"]([Object(d["b"])({components:{"zone-input":_}})],L);var A=L,T=A,F=n("b1fa");function q(e){this["$style"]=F["default"].locals||F["default"]}var R=Object(j["a"])(T,a,o,!1,q,null,null);t["default"]=R.exports},fca0:function(e,t,n){var a=n("5ca1"),o=n("7726").isFinite;a(a.S,"Number",{isFinite:function(e){return"number"==typeof e&&o(e)}})}}]);
//# sourceMappingURL=system.b4a9a3c2.js.map