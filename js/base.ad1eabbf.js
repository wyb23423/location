(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["base"],{1253:function(e,t,a){"use strict";var r=a("ad31"),o=a.n(r);t["default"]=o.a},"1b8b":function(e,t,a){"use strict";var r=a("b7e7"),o=a.n(r);t["default"]=o.a},"1c4c":function(e,t,a){"use strict";var r=a("9b43"),o=a("5ca1"),n=a("4bf8"),l=a("1fa8"),i=a("33a4"),s=a("9def"),c=a("f1ae"),u=a("27ee");o(o.S+o.F*!a("5cc5")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,o,p,f=n(e),d="function"==typeof this?this:Array,m=arguments.length,b=m>1?arguments[1]:void 0,h=void 0!==b,v=0,g=u(f);if(h&&(b=r(b,m>2?arguments[2]:void 0,2)),void 0==g||d==Array&&i(g))for(t=s(f.length),a=new d(t);t>v;v++)c(a,v,h?b(f[v],v):f[v]);else for(p=g.call(f),a=new d;!(o=p.next()).done;v++)c(a,v,h?l(p,b,[o.value,v],!0):o.value);return a.length=v,a}})},"2f21":function(e,t,a){"use strict";var r=a("79e5");e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},"34d6":function(e,t,a){"use strict";var r=a("72d8"),o=a.n(r);t["default"]=o.a},"42de":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{filterable:"","default-first-option":"",multiple:!!e.multiple,disabled:!!e.disabled,"collapse-tags":""},on:{change:e.change},model:{value:e.currValue,callback:function(t){e.currValue=t},expression:"currValue"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)},o=[],n=(a("7514"),a("7f7f"),a("ac6a"),a("d225")),l=a("b0b4"),i=a("308d"),s=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),f=a("2fe1"),d=a("60a3"),m=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(i["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.options=[],e.currValue=null,e}return Object(c["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=this;this.$http.get(this.url,{pageSize:1e6,currentPage:1}).then(function(t){e.options=t.pagedData.datas.map(function(t){return{id:t[e.keys.id||"id"],name:t[e.keys.name],data:t}}),e.multiple?e.currValue=[]:e.currValue=null==e.value||""===e.value?e.options[0].id:e.value}).catch(console.error)}},{key:"change",value:function(e){var t=this;this.$emit("input",e),Array.isArray(e)||(e=[e]),this.$emit("change",e.map(function(e){return t.options.find(function(t){return t.id===e})}))}}]),t}(p["default"]);u["a"]([Object(d["b"])()],m.prototype,"url",void 0),u["a"]([Object(d["b"])()],m.prototype,"value",void 0),u["a"]([Object(d["b"])({default:function(){return{id:"id",name:"name"}}})],m.prototype,"keys",void 0),u["a"]([Object(d["b"])()],m.prototype,"multiple",void 0),u["a"]([Object(d["b"])()],m.prototype,"disabled",void 0),m=u["a"]([f["b"]],m);var b=m,h=b,v=a("2877"),g=Object(v["a"])(h,r,o,!1,null,null,null);t["a"]=g.exports},"53cd":function(e,t,a){"use strict";var r=a("8dfd"),o=a.n(r);t["default"]=o.a},"53e2e":function(e,t,a){"use strict";var r=a("c6e3"),o=a.n(r);t["default"]=o.a},"54b6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{paste:function(t){return e.paste(t)}}},e._l(new Array(e.length).fill(1),function(t,r){return a("el-input",{key:r,ref:"ip",refInFor:!0,class:e.$style.ip,on:{input:function(t){return e.next(r)}},model:{value:e.value[r],callback:function(t){e.$set(e.value,r,t)},expression:"value[i]"}},[r<e.length-1?a("span",{attrs:{slot:"append"},slot:"append"},[e._v(".")]):e._e()])}),1)},o=[],n=(a("c5f6"),a("fca0"),a("ac4d"),a("8a81"),a("28a5"),a("ac6a"),a("5df3"),a("1c4c"),a("20d6"),a("d225")),l=a("b0b4"),i=a("308d"),s=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),f=a("2fe1"),d=a("60a3"),m=function(e){function t(){return Object(n["a"])(this,t),Object(i["a"])(this,Object(s["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(l["a"])(t,[{key:"next",value:function(e){var t=this.value[e],a=this.parseIp(t);return this.$set(this.value,e,a),a.length>=(this.max+"").length&&e<this.length-1&&this.$refs.ip[e+1].focus(),t.length<=0&&e>0&&this.$refs.ip[e-1].focus(),this.value}},{key:"paste",value:function(e){var t=this,a=this.$refs.ip.findIndex(function(t){return t.$refs.input===e.target});if(a>-1)for(var r=0,o=Array.from(e.clipboardData.items);r<o.length;r++){var n=o[r];"text/plain"===n.type&&n.getAsString(function(e){return t.pasteHandler(e,a)})}return this.value}},{key:"pasteHandler",value:function(e,t){this.$refs.ip;var a=!0,r=!1,o=void 0;try{for(var n,l=e.split(".")[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var i=n.value;if(t>this.length-1)break;i&&this.$set(this.value,t++,this.parseIp(i).substr(0,3))}}catch(s){r=!0,o=s}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}}},{key:"parseIp",value:function(e){var t=parseInt(e,10);return Number.isFinite(t)?(t=Math.max(this.min,Math.min(t,this.max)),t+""):""}}]),t}(p["default"]);u["a"]([Object(d["b"])({default:function(){return[]}})],m.prototype,"value",void 0),u["a"]([Object(d["b"])({default:function(){return 0}})],m.prototype,"min",void 0),u["a"]([Object(d["b"])({default:function(){return 255}})],m.prototype,"max",void 0),u["a"]([Object(d["b"])({default:function(){return 4}})],m.prototype,"length",void 0),u["a"]([Object(d["a"])("input")],m.prototype,"next",null),u["a"]([Object(d["a"])("input")],m.prototype,"paste",null),m=u["a"]([f["b"]],m);var b=m,h=b,v=a("1b8b"),g=a("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var x=Object(g["a"])(h,r,o,!1,y,null,null);t["a"]=x.exports},"55dd":function(e,t,a){"use strict";var r=a("5ca1"),o=a("d8e8"),n=a("4bf8"),l=a("79e5"),i=[].sort,s=[1,2,3];r(r.P+r.F*(l(function(){s.sort(void 0)})||!l(function(){s.sort(null)})||!a("2f21")(i)),"Array",{sort:function(e){return void 0===e?i.call(n(this)):i.call(n(this),o(e))}})},6692:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.base?a("div",{class:e.$style.info},[a("el-page-header",{staticStyle:{"margin-bottom":"20px"},on:{back:function(t){return e.look(null)}}}),a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"设备信息",name:"info"}},[a("base-info",{attrs:{data:e.base}})],1),e.permission.post?a("el-tab-pane",{attrs:{label:"基本属性设置",name:"primary"}},[a("base-primary",{attrs:{data:e.base}})],1):e._e(),e.permission.post?a("el-tab-pane",{attrs:{label:"网络参数设置",name:"net"}},[a("base-net",{attrs:{data:e.base}})],1):e._e(),e.permission.post?a("el-tab-pane",{attrs:{label:"位置设置",name:"position"}},[a("base-position",{attrs:{data:e.base}})],1):e._e()],1)],1):a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200},on:{del:e.del,look:e.look,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},o=[],n=(a("96cf"),a("3b8d")),l=(a("7f7f"),a("d225")),i=a("b0b4"),s=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),d=a("ae85"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:18}},[a("ul",{class:e.$style.info},[a("li",{class:e.$style.name},[a("span",[e._v("设备名称："+e._s(e.data.name))]),a("span",[e._v(e._s(" ".repeat(30)))]),a("span",[e._v("设备分组："+e._s(e.data.groupCode))])]),a("li",{staticStyle:{"min-height":"100px"}},[e._v("\n                设备简介："+e._s(e.data.description||"暂无简介")+"\n            ")]),a("li",[a("div",[a("span",{class:e.$style.title},[e._v("设备坐标：")]),a("span",[e._v("\n                        "+e._s("{ x: "+e.data.coordx+", y: "+e.data.coordy+" }")+"\n                    ")])]),a("div",[a("span",{class:e.$style.title},[e._v("设备地址：")]),a("span",[e._v(e._s(e.data.location))])])]),a("li",[a("div",[a("span",{class:e.$style.title},[e._v("IP地址：")]),a("span",[e._v(e._s(e.data.ip))])]),a("div",[a("span",{class:e.$style.title},[e._v("数据类型：")]),a("span",[e._v("\n                        "+e._s(e.data.uploadType?"上行":"单基站数据")+"\n                    ")])])]),a("li",[a("div",[a("span",{class:e.$style.title},[e._v("是否工作：")]),a("span",[e._v(e._s(!!e.data.work))])]),a("div",[a("span",{class:e.$style.title},[e._v("安装时间：")]),a("span",[e._v(e._s(e.data.installTime||"保密"))])])]),a("li",[a("div",[a("span",{class:e.$style.title},[e._v("所属区域：")]),a("span",[e._v(e._s(e.data.zone))])]),a("div",[a("span",{class:e.$style.title},[e._v("安装负责人：")]),a("span",[e._v(e._s(e.data.owner||"保密"))])])]),a("li",[a("div",[a("span",{class:e.$style.title},[e._v("掉帧率：")]),a("span",[e._v(e._s(e.data.loseRate||0))])]),a("div",[a("span",{class:e.$style.title},[e._v("报警次数：")]),a("span",[e._v(e._s(e.data.alarm||0))])])])])]),a("el-col",{staticStyle:{"text-align":"right"},attrs:{offset:1,span:5}},[a("el-image",{staticStyle:{width:"100%"},attrs:{src:"/images/80530151701.png",fit:"contain"}},[a("div",{class:e.$style["image-slot"],attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1)],1)},b=[],h=a("2b0e"),v=a("60a3"),g=function(e){function t(){return Object(l["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),t}(h["default"]);p["a"]([Object(v["b"])()],g.prototype,"data",void 0),g=p["a"]([f["b"]],g);var y=g,x=y,_=a("34d6"),$=a("2877");function k(e){this["$style"]=_["default"].locals||_["default"]}var j=Object($["a"])(x,m,b,!1,k,null,null),O=j.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticStyle:{"padding-right":"20%"},attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"所属组号",required:"",prop:"groupCode"}},[a("el-input",{model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1),a("el-form-item",{attrs:{label:"基站类型"}},[a("el-radio-group",{model:{value:e.form.main,callback:function(t){e.$set(e.form,"main",t)},expression:"form.main"}},[a("el-radio",{attrs:{label:85}},[e._v("从基站")]),a("el-radio",{attrs:{label:170}},[e._v("主基站")])],1)],1),a("el-form-item",{attrs:{label:"基站模式"}},[a("el-radio-group",{model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[a("el-radio",{attrs:{label:17}},[e._v("单基站")]),a("el-radio",{attrs:{label:34}},[e._v("下行模式")]),a("el-radio",{attrs:{label:51}},[e._v("上行模式")])],1)],1),a("el-form-item",{attrs:{label:"距离参数",required:"",prop:"distance",rules:{type:"number"}}},[a("el-input",{model:{value:e.form.distance,callback:function(t){e.$set(e.form,"distance",e._n(t))},expression:"form.distance"}},[a("template",{slot:"append"},[e._v("\n                cm\n            ")])],2)],1),a("el-form-item",{attrs:{label:"基站信道"}},[a("el-radio-group",{model:{value:e.form.channel,callback:function(t){e.$set(e.form,"channel",t)},expression:"form.channel"}},[a("el-radio",{attrs:{label:2}}),a("el-radio",{attrs:{label:5}})],1)],1),a("el-form-item",{attrs:{label:"时间补偿",required:"",prop:"time",rules:{type:"number"}}},[a("el-input",{attrs:{"prefix-icon":"el-icon-timer"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",e._n(t))},expression:"form.time"}})],1),a("el-form-item",{attrs:{label:"频率等级"}},[a("el-rate",{attrs:{colors:e.colors,"show-score":""},model:{value:e.form.power,callback:function(t){e.$set(e.form,"power",t)},expression:"form.power"}})],1),a("el-form-item",{attrs:{label:"发送等级"}},[a("el-rate",{attrs:{colors:e.colors,max:3,"low-threshold":1,"high-threshold":3,"show-score":""},model:{value:e.form.send,callback:function(t){e.$set(e.form,"send",t)},expression:"form.send"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("设置")])],1)],1)},S=[],z=(a("6b54"),a("f576"),a("768b")),C=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colors=["#99A9BF","#F7BA2A","#FF9900"],e.form={power:1,main:85,channel:2,send:1,mode:17},e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"created",value:function(){}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate().then(function(){return e.$confirm("确认设置?")}).then(function(){return e.$http.post("/api/protocol/sendProtocol",{ip:e.data.ip,port:5e4,protocol:"41"+e.parse(e.form)})}).then(function(){return e.$message.success("设置成功")}).catch(console.log)}},{key:"parse",value:function(e){var t=[["groupCode",2],["main",1],["mode",1],["distance",2],["channel",1],["time",4],["power",1],["send",1]];if("string"===typeof e){var a={},r=0;return t.forEach(function(t){var o=Object(z["a"])(t,2),n=o[0],l=o[1];a[n]=+("0x"+e.substr(r,2*l)),r+=2*l}),a}return t.reduce(function(t,a){var r=Object(z["a"])(a,2),o=r[0],n=r[1];return t.push(e[o].toString(16).padStart(2*n,"0")),t},[]).join("")}}]),t}(h["default"]);p["a"]([Object(v["b"])()],C.prototype,"data",void 0),C=p["a"]([f["b"]],C);var I=C,P=I,q=Object($["a"])(P,w,S,!1,null,null,null),B=q.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticStyle:{"padding-right":"20%"},attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"基站IP",required:""}},[a("ip-input",{model:{value:e.form.baseIp,callback:function(t){e.$set(e.form,"baseIp",t)},expression:"form.baseIp"}})],1),a("el-form-item",{attrs:{label:"基站MASK",required:""}},[a("ip-input",{model:{value:e.form.mask,callback:function(t){e.$set(e.form,"mask",t)},expression:"form.mask"}})],1),a("el-form-item",{attrs:{label:"基站MAC",required:""}},[a("ip-input",{attrs:{length:6},model:{value:e.form.mac,callback:function(t){e.$set(e.form,"mac",t)},expression:"form.mac"}})],1),a("el-form-item",{attrs:{label:"基站端口",required:"",prop:"basePort"}},[a("el-input",{model:{value:e.form.basePort,callback:function(t){e.$set(e.form,"basePort",t)},expression:"form.basePort"}})],1),a("el-form-item",{attrs:{label:"服务器IP",required:""}},[a("ip-input",{model:{value:e.form.serverIp,callback:function(t){e.$set(e.form,"serverIp",t)},expression:"form.serverIp"}})],1),a("el-form-item",{attrs:{label:"服务器端口",required:"",prop:"serverPort"}},[a("el-input",{model:{value:e.form.serverPort,callback:function(t){e.$set(e.form,"serverPort",t)},expression:"form.serverPort"}})],1),a("el-form-item",{attrs:{label:"传输模式"}},[a("el-radio-group",{model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[a("el-radio",{attrs:{label:85}},[e._v("UDP")]),a("el-radio",{attrs:{label:170}},[e._v("TCP")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("设置")])],1)],1)},D=[],A=(a("ac6a"),a("4917"),a("54b6")),T=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={baseIp:[],serverIp:[],mask:[],mac:[],mode:85},e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"onSubmit",value:function(){var e=this;if(!0===this.isValid){var t=this.$refs.form;t.validate().then(function(){return e.$confirm("确认设置?")}).then(function(){return e.$http.post("/api/protocol/sendProtocol",{ip:e.data.ip,port:5e4,protocol:"42"+e.parse(e.form)})}).then(function(){return e.$message.success("设置成功")}).catch(console.log)}}},{key:"parse",value:function(e){var t=[["baseIp",4,!0],["mask",4,!0],["mac",6,!0],["basePort",2,!1],["serverIp",4,!0],["serverPort",2,!1],["mode",1,!1]];return"string"===typeof e?this.str2obj(t,e):this.obj2str(t,e)}},{key:"str2obj",value:function(e,t){var a=function(e){return+("0x"+e)},r=function(e,r){var o=t.substr(e,r).match(/\d{2}/g)||[];return o.map(a)},o={},n=0;return e.forEach(function(e){var l=Object(z["a"])(e,3),i=l[0],s=l[1],c=l[2],u=2*s;o[i]=c?r(n,u):a(t.substr(n,u)),n+=u}),o}},{key:"obj2str",value:function(e,t){return e.reduce(function(e,a){var r=Object(z["a"])(a,2),o=r[0],n=r[1],l=t[o];return l=Array.isArray(l)?l.map(function(e){return e.toString(16).padStart(2,"0")}).join(""):(+l).toString(16).padStart(2*n,"0"),e.push(l),e},[]).join("")}},{key:"isValid",get:function(){return 4!==this.form.baseIp.length?this.$message.error("基站IP格式错误"):4!==this.form.mask.length?this.$message.error("基站mask格式错误"):6!==this.form.mac.length?this.$message.error("基站mac格式错误"):4===this.form.serverIp.length||this.$message.error("服务器IP格式错误")}}]),t}(h["default"]);p["a"]([Object(v["b"])()],T.prototype,"data",void 0),T=p["a"]([Object(f["b"])({components:{"ip-input":A["a"]}})],T);var E=T,F=E,M=Object($["a"])(F,N,D,!1,null,null,null),V=M.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticStyle:{"padding-right":"20%"},attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"区域："}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.zone,callback:function(t){e.$set(e.form,"zone",t)},expression:"form.zone"}},e._l(e.zones,function(e,t){return a("el-option",{key:t,attrs:{label:e[1],value:e[0]}})}),1)],1),a("el-form-item",{attrs:{label:"坐标X：",prop:"coordx",required:""}},[a("el-input",{staticStyle:{"max-width":"300px"},model:{value:e.form.coordx,callback:function(t){e.$set(e.form,"coordx",e._n(t))},expression:"form.coordx"}})],1),a("el-form-item",{attrs:{label:"坐标Y：",prop:"coordy",required:""}},[a("el-input",{staticStyle:{"max-width":"300px"},model:{value:e.form.coordy,callback:function(t){e.$set(e.form,"coordy",e._n(t))},expression:"form.coordy"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("设置")])],1)],1)},H=[],U=(a("aef6"),function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={coordx:0,coordy:0,zone:"0"},e.zones=[],e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"created",value:function(){var e=this;this.form.coordx=this.data.coordx,this.form.coordy=this.data.coordy,this.form.zone=this.data.zone,this.$http.get("/api/zone/getall",{currentPage:1,pageSize:1e4}).then(function(t){e.zones=t.pagedData.datas.map(function(e){return[e.id+"",e.name+(e.name.endsWith("区域")?"":"区域")]}),e.zones.every(function(t){return t[0]!==e.form.zone})&&(e.form.zone=e.zones[0][0])}).catch(console.error)}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){var a=Object.assign({},e.form,{updateUser:"....",updateTime:Date.now(),id:e.data.id});e.$confirm("确认修改").then(function(){return e.$http.post("/api/base/updateBase",a,{"Content-Type":"application/json"})}).then(function(){return e.$message.success("修改成功")}).catch(console.log)}})}}]),t}(h["default"]));p["a"]([Object(v["b"])()],U.prototype,"data",void 0),U=p["a"]([f["b"]],U);var W=U,J=W,K=Object($["a"])(J,R,H,!1,null,null,null),Q=K.exports,Y=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"基站ID",sortable:!0,width:150},{prop:"baseNo",label:"基站编号",width:175},{prop:"name",label:"基站名称",width:175},{prop:"main",label:"主基站",width:145},{prop:"zone",label:"基站区域",width:170},{prop:"ip",label:"基站IP",width:210}],e.base=null,e.activeTab="info",e}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除基站".concat(e.name,"?")).then(function(){return t.$http.post("/api/base/deleteBase",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"look",value:function(e){this.base=e}},{key:"fetch",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,a){var r,o,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/base/getall",{pageSize:a,currentPage:t});case 5:n=e.sent,r=n.pagedData.datas,o=n.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:o,data:r});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"op",get:function(){var e=[{type:"success",name:"look",desc:"查看详情"}];return this.permission.delete&&e.push({type:"danger",name:"del",desc:"删除"}),e}}]),t}(Object(f["c"])(d["a"]));Y=p["a"]([Object(f["b"])({components:{"base-info":O,"base-primary":B,"base-net":V,"base-position":Q}})],Y);var G=Y,X=G,L=a("53e2e");function Z(e){this["$style"]=L["default"].locals||L["default"]}var ee=Object($["a"])(X,r,o,!1,Z,null,null);t["default"]=ee.exports},"72d8":function(e,t,a){e.exports={"image-slot":"BaseInfo_image-slot_SElQN",info:"BaseInfo_info_32r3t",name:"BaseInfo_name_1idnK",title:"BaseInfo_title_2RQ1y"}},"8dfd":function(e,t,a){e.exports={"tool-bar":"BaseAdd_tool-bar_1jFU0",sel:"BaseAdd_sel_2oBY4",tool:"BaseAdd_tool_W3Iqe",btn:"BaseAdd_btn_2fMnU",back:"BaseAdd_back_NrfQ1"}},9396:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"table",staticStyle:{position:"relative",height:"100%"}},[a("el-steps",{class:e.$style["tool-bar"],attrs:{active:e.progress,simple:""}},[a("el-step",{attrs:{title:"添加基站",icon:"el-icon-plus"}}),a("el-step",{attrs:{title:"提交分组",icon:"el-icon-upload"}})],1),0===e.progress?[a("el-card",{class:e.$style.tool},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{"margin-right":"-40px"}},[e._v("选择地图")]),a("map-select",{staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}})],1),a("div",{class:e.$style.btn},[a("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("\r\n                    下一步\r\n                ")])],1)]),a("div",{ref:"map",staticStyle:{height:"100%",overflow:"hidden"}})]:a("div",{staticStyle:{padding:"5%","padding-top":"80px"}},[1===e.progress?[a("p",{staticStyle:{color:"#e00","font-size":"24px"}},[e._v("\r\n                添加基站\r\n                "),a("span",{staticStyle:{"font-size":"16px"}},[e._v("(已添加: "+e._s(e.bases.length)+") ")])]),a("el-form",{ref:"form",staticStyle:{"max-width":"800px"},attrs:{model:e.form,rules:e.rules,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"基站名称",required:"",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入基站名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"基站编号",required:"",prop:"baseNo"}},[a("el-input",{attrs:{placeholder:"请输入基站编号"},model:{value:e.form.baseNo,callback:function(t){e.$set(e.form,"baseNo",t)},expression:"form.baseNo"}})],1),a("el-form-item",{attrs:{label:"基站组号",required:"",prop:"groupCode"}},[a("el-input",{attrs:{placeholder:"请输入基站组号"},model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",e._n(t))},expression:"form.groupCode"}})],1),a("el-form-item",{attrs:{label:"基站ip",required:""}},[a("ip-input",{model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),a("el-form-item",{attrs:{label:"基站类型",required:""}},[a("el-radio-group",{model:{value:e.form.main,callback:function(t){e.$set(e.form,"main",t)},expression:"form.main"}},[a("el-radio",{attrs:{label:0}},[e._v("从基站")]),a("el-radio",{attrs:{label:1}},[e._v("主基站")])],1)],1),a("el-form-item",{attrs:{label:"区域",required:""}},[a("app-select",{attrs:{url:"/api/zone/getall"},model:{value:e.form.zone,callback:function(t){e.$set(e.form,"zone",t)},expression:"form.zone"}})],1),a("el-form-item",{attrs:{label:"基站位置"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{prop:"coordx",required:""}},[a("el-input",{attrs:{placeholder:"x"},model:{value:e.form.coordx,callback:function(t){e.$set(e.form,"coordx",e._n(t))},expression:"form.coordx"}})],1)],1),a("el-col",{attrs:{offset:1,span:6}},[a("el-form-item",{attrs:{prop:"coordy",required:""}},[a("el-input",{attrs:{placeholder:"y"},model:{value:e.form.coordy,callback:function(t){e.$set(e.form,"coordy",e._n(t))},expression:"form.coordy"}})],1)],1),a("el-col",{attrs:{offset:1,span:6}},[a("el-form-item",{attrs:{prop:"coordz",required:""}},[a("el-input",{attrs:{placeholder:"z"},model:{value:e.form.coordz,callback:function(t){e.$set(e.form,"coordz",e._n(t))},expression:"form.coordz"}})],1)],1)],1),a("el-form-item",{attrs:{label:"补偿值",required:"",prop:"timeCorrectionValue"}},[a("el-input",{attrs:{placeholder:"请输入补偿值"},model:{value:e.form.timeCorrectionValue,callback:function(t){e.$set(e.form,"timeCorrectionValue",t)},expression:"form.timeCorrectionValue"}})],1),a("el-form-item",{attrs:{label:"算法类型",required:"",prop:"algorithmType"}},[a("el-input",{attrs:{placeholder:"请输入算法类型"},model:{value:e.form.algorithmType,callback:function(t){e.$set(e.form,"algorithmType",e._n(t))},expression:"form.algorithmType"}})],1),a("el-form-item",{attrs:{label:"分组基站数量"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"groupBaseSize",required:""}},[a("el-input",{attrs:{placeholder:"基站总数"},model:{value:e.form.groupBaseSize,callback:function(t){e.$set(e.form,"groupBaseSize",e._n(t))},expression:"form.groupBaseSize"}})],1)],1),a("el-col",{attrs:{offset:2,span:8}},[a("el-form-item",{attrs:{prop:"minBaseSize",required:""}},[a("el-input",{attrs:{placeholder:"最小基站数"},model:{value:e.form.minBaseSize,callback:function(t){e.$set(e.form,"minBaseSize",e._n(t))},expression:"form.minBaseSize"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("\r\n                        添加\r\n                    ")]),a("el-button",{attrs:{type:"danger",disabled:!e.bases.length},on:{click:e.next}},[e._v("\r\n                        下一步\r\n                    ")])],1)],1)]:e.progress>=2?a("el-card",[a("el-page-header",{class:e.$style.back,attrs:{title:"返回上一步"},on:{back:function(t){e.progress--}}}),a("div",{staticStyle:{"text-align":"center","font-weight":"700","margin-bottom":"5px"}},[e._v("基站坐标")]),a("app-table",{staticStyle:{"max-width":"660px",margin:"0 auto"},attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:[{type:"danger",name:"del",desc:"删除"}],noPrint:!0,isSmall:!0},on:{del:e.del,updateData:e.getData}}),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交分组")])],1)],1):e._e()],2)],2)},o=[],n=(a("5df3"),a("20d6"),a("cebc")),l=(a("96cf"),a("3b8d")),i=(a("ac6a"),a("d225")),s=a("b0b4"),c=a("308d"),u=a("6bb5"),p=a("4e2b"),f=a("9ab4"),d=a("2fe1"),m=a("99d1"),b=a("42de"),h=a("54b6"),v=a("ae85"),g=a("d8c9"),y="origin",x=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.progress=1,e.coord=null,e.bases=[],e.form={main:0,zone:null,ip:[]},e.rules={},e.colCfg=[{prop:"name",label:"基站名称",width:140},{prop:"coordx",label:"相对原点x坐标",width:160},{prop:"coordy",label:"相对原点y坐标",width:160}],e.getNum=Object(g["d"])(),e}return Object(p["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){var e=this;["coordx","coordy","coordz","algorithmType","groupBaseSize","minBaseSize","groupCode"].forEach(function(t){e.rules[t]={type:"number",tigger:"change"}})}},{key:"next",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.progress||this.coord){e.next=9;break}return e.prev=1,e.next=4,this.$confirm("未选择原点, 是否使用默认的地图原点?");case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e["catch"](1),e.abrupt("return");case 9:this.dispose(),this.progress++,this.progress>=2&&this.getData(1,10);case 12:case"end":return e.stop()}},e,this,[[1,6]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"add",value:function(){var e=this,t=this.$refs.form;t.validate(function(a){if(4!==e.form.ip.length)return e.$message.warning("基站ip格式错误");a&&(e.bases.push(Object(n["a"])({},e.form,{flag:e.getNum()})),e.form={main:0,zone:null,ip:[]},e.$notify.success("添加成功"),t.resetFields())})}},{key:"del",value:function(e){var t=this,a=this.bases.findIndex(function(t){return t.flag===e.flag});a>-1?this.$confirm("确认删除该条数据?","确认").then(function(){t.bases.splice(a,1),t.getData(1,t.pageSize)}).catch(console.error):this.$message.error("数据不存在!")}},{key:"submit",value:function(){var e=this;this.$confirm("提交分组?").then(function(){var t=e.coord||{x:0,y:0,z:0},a=e.bases.map(function(a){var r=Object(n["a"])({},a,{ip:a.ip.join("."),alarm:0,work:!0,coordx:t.x+a.coordx,coordy:t.y+a.coordy,createTime:null,createUser:null,description:null,installTime:null,location:null,loseRate:"0",owner:null,updateTime:null,updateUser:"string",uploadType:"1",groupCode:a.groupCode+""});return delete r.flag,e.$http.post("/api/base/addBase",r,{"Content-Type":"application/json"})});return Promise.all(a)}).then(function(){e.$message.success("添加成功"),location.href=location.href}).catch(console.log)}},{key:"bindEvents",value:function(){var e=this;this.mgr.on("mapClickNode",function(t){t.nodeType!==fengmap.FMNodeType.IMAGE_MARKER&&e.$confirm("你是否在进行原点选取?").then(function(){return e.coord?e.$confirm("你已经选取点，是否更换原点?","确认"):"confirm"}).then(function(){var a=t.eventInfo.coord;e.addOrigin(a.x,a.y)}).catch(console.log)})}},{key:"fetch",value:function(e,t){return Promise.resolve({count:this.bases.length,data:this.bases.slice((e-1)*t,e*t)})}},{key:"addOrigin",value:function(e,t){this.mgr&&(this.mgr.remove(y),this.coord=this.mgr.getCoordinate(this.mgr.addImage({x:e,y:t,url:"/images/query_function_location.png",size:32,height:2},y)))}}]),t}(Object(d["c"])(m["a"],v["a"]));x=f["a"]([Object(d["b"])({components:{"app-select":b["a"],"ip-input":h["a"]}})],x);var _=x,$=_,k=a("53cd"),j=a("2877");function O(e){this["$style"]=k["default"].locals||k["default"]}var w=Object(j["a"])($,r,o,!1,O,null,null);t["default"]=w.exports},aa8c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main"},[a("div",{staticStyle:{"overflow-y":"auto"},style:{height:e.mainHeight}},[a("router-view")],1)]),a("app-aside",{attrs:{tabs:e.tabs}})],1)},o=[],n=a("d225"),l=a("308d"),i=a("6bb5"),s=a("4e2b"),c=a("9ab4"),u=a("2fe1"),p=a("3d13"),f=a("cda1"),d=a("2b0e"),m=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(i["a"])(t).apply(this,arguments)),e.tabs=[{title:"设备信息",to:"/base/info",icon:"el-icon-info"},{title:"设备添加",to:"/base/add",icon:"el-icon-circle-plus-outline"},{title:"校准值配置",to:"/base/calibration",icon:"el-icon-setting"}],e}return Object(s["a"])(t,e),t}(d["default"]);c["a"]([Object(f["a"])("mainHeight")],m.prototype,"mainHeight",void 0),m=c["a"]([Object(u["b"])({components:{"app-aside":p["a"]}})],m);var b=m,h=b,v=a("2877"),g=Object(v["a"])(h,r,o,!1,null,null,null);t["default"]=g.exports},ad31:function(e,t,a){e.exports={alert:"CalibrationSetting_alert_h2s9c","tag-form":"CalibrationSetting_tag-form_1Pmkj","base-form":"CalibrationSetting_base-form_2-OPE"}},aef6:function(e,t,a){"use strict";var r=a("5ca1"),o=a("9def"),n=a("d2c8"),l="endsWith",i=""[l];r(r.P+r.F*a("5147")(l),"String",{endsWith:function(e){var t=n(this,e,l),a=arguments.length>1?arguments[1]:void 0,r=o(t.length),s=void 0===a?r:Math.min(o(a),r),c=String(e);return i?i.call(t,c,s):t.slice(s-c.length,s)===c}})},b7e7:function(e,t,a){e.exports={ip:"IpInput_ip_1-NJb"}},c078:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:[{type:"primary",name:"setting",desc:"配置校准值"}],noPrint:!0},on:{setting:e.setting,updateData:e.getData}})],1),e.bases?[a("setting",{attrs:{visible:!!e.bases,bases:e.bases},on:{close:function(t){e.bases=null}}})]:e._e()],2)},o=[],n=a("768b"),l=(a("ac6a"),a("ffc1"),a("55dd"),a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),c=a("308d"),u=a("6bb5"),p=a("4e2b"),f=a("9ab4"),d=a("2fe1"),m=a("ae85"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"配置校准值",visible:!!e.visible,"modal-append-to-body":!1,width:"80%",top:"5vh"},on:{close:function(t){return e.$emit("close")}}},[a("app-table",{attrs:{"max-height":300,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,noPrint:!0,isSmall:!0},on:{updateData:e.getData}}),a("div",{class:e.$style.alert},[e._v("\n        校准者误差配置需要参数：基站坐标，标签实际坐标，标签距离基站距离(自动计算)，平均时间戳\n    ")]),a("el-divider",{attrs:{"content-position":"left"}},[e._v("输入标签参数")]),a("el-form",{ref:"tag",class:e.$style["tag-form"],attrs:{model:e.form,inline:!0,"label-width":"auto"}},[a("el-form-item",{staticStyle:{"margin-right":"10%"},attrs:{label:"标签编号"}},[a("el-input",{model:{value:e.form.tagNo,callback:function(t){e.$set(e.form,"tagNo",t)},expression:"form.tagNo"}})],1),a("el-form-item",{attrs:{label:"标签实际坐标",required:""}},[a("el-row",{staticStyle:{width:"388px"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{prop:"x",required:"",rules:{type:"number"}}},[a("el-input",{attrs:{placeholder:"x"},model:{value:e.form.x,callback:function(t){e.$set(e.form,"x",e._n(t))},expression:"form.x"}})],1)],1),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{prop:"y",required:"",rules:{type:"number"}}},[a("el-input",{attrs:{placeholder:"y"},model:{value:e.form.y,callback:function(t){e.$set(e.form,"y",e._n(t))},expression:"form.y"}})],1)],1),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",{attrs:{prop:"z",required:"",rules:{type:"number"}}},[a("el-input",{attrs:{placeholder:"z"},model:{value:e.form.z,callback:function(t){e.$set(e.form,"z",e._n(t))},expression:"form.z"}})],1)],1)],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("平均时间戳")]),a("el-form",{ref:"base",class:e.$style["base-form"],attrs:{model:e.form,inline:""}},e._l(e.tableData,function(t){return a("el-form-item",{key:t.baseNo,attrs:{prop:t.baseNo,required:"",label:t.baseNo+"基站平均时间戳",rules:{type:"number"}}},[a("el-input",{attrs:{"prefix-icon":"el-icon-timer"},model:{value:e.form[t.baseNo],callback:function(a){e.$set(e.form,t.baseNo,e._n(a))},expression:"form[v.baseNo]"}})],1)}),1),a("template",{slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("计 算")]),a("el-button",{on:{click:e.reset}},[e._v("重 置")]),a("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("取 消")])],1)],2)},h=[],v=(a("7514"),a("5df3"),a("60a3")),g=29970254700;function y(e,t,a){return a-2*_(e,t)/g}function x(e,t,a,r,o){var n=_(a,t),l=_(e,t),i=_(a,e);return r-o+(l-n-i)/g}function _(e,t){return Math.pow(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2),1)/2}var $=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.form={tagNo:"00000004"},e.colCfg=[{prop:"id",label:"ID",sortable:!0},{prop:"baseNo",label:"基站编号"},{prop:"name",label:"基站名称"},{prop:"main",label:"主基站"},{prop:"ip",label:"基站IP"}],e}return Object(p["a"])(t,e),Object(s["a"])(t,[{key:"submit",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,a,r,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([this.$refs.tag.validate(),this.$refs.base.validate()]);case 3:t=this.tableData.find(function(e){return!!e.main}),t&&(a={x:t.coordx,y:t.coordy,z:t.coordz},r=this.tableData.map(function(e){var r=e.main?y(a,o.form,o.form[t.baseNo]):x({x:e.coordx,y:e.coordy,z:e.coordz},o.form,a,o.form[t.baseNo],o.form[e.baseNo]);return e.timeCorrectionValue=r+"",o.$http.post("/api/base/updateBase",e)}),Promise.all(r).then(function(){return o.$message.success("修改成功")}).catch(console.log),this.reset()),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.$refs.base.resetFields(),this.$refs.tag.resetFields()}},{key:"fetch",value:function(e,t){return Promise.resolve({count:this.bases.length,data:this.bases.slice((e-1)*t,e*t)})}}]),t}(Object(d["c"])(m["a"]));f["a"]([Object(v["b"])()],$.prototype,"visible",void 0),f["a"]([Object(v["b"])()],$.prototype,"bases",void 0),$=f["a"]([d["b"]],$);var k=$,j=k,O=a("1253"),w=a("2877");function S(e){this["$style"]=O["default"].locals||O["default"]}var z=Object(w["a"])(j,b,h,!1,S,null,null),C=z.exports,I=a("d8c9"),P=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"分组id",sortable:!0},{prop:"code",label:"分组编号"},{prop:"count",label:"基站数量"}],e.bases=null,e.allBase=[],e}return Object(p["a"])(t,e),Object(s["a"])(t,[{key:"setting",value:function(e){this.bases=e.children}},{key:"fetch",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,a){var r,o,n,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=[],o=0,e.prev=2,this.allBase.length){e.next=8;break}return e.next=6,this.$http.get("/api/base/getall",{pageSize:1e7,currentPage:1});case 6:n=e.sent,this.allBase=n.pagedData.datas;case 8:l=this.toTree(),o=l.length,r=l.slice((t-1)*a,t*a),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),console.log(e.t0);case 16:return e.abrupt("return",{count:o,data:r});case 17:case"end":return e.stop()}},e,this,[[2,13]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"toTree",value:function(){var e=Object(I["a"])(this.allBase,"groupCode");return Object.entries(e).sort(function(e,t){return+e[0]-+t[0]}).map(function(e,t){var a=Object(n["a"])(e,2),r=a[0],o=a[1];return{id:t,count:o.length,code:r,children:o}})}}]),t}(Object(d["c"])(m["a"]));P=f["a"]([Object(d["b"])({components:{setting:C}})],P);var q=P,B=q,N=Object(w["a"])(B,r,o,!1,null,null,null);t["default"]=N.exports},c6e3:function(e,t,a){e.exports={info:"Info_info_gBV_v"}},f1ae:function(e,t,a){"use strict";var r=a("86cc"),o=a("4630");e.exports=function(e,t,a){t in e?r.f(e,t,o(0,a)):e[t]=a}},fca0:function(e,t,a){var r=a("5ca1"),o=a("7726").isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&o(e)}})}}]);
//# sourceMappingURL=base.ad1eabbf.js.map