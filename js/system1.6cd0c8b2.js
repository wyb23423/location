(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["system1"],{1422:function(e,t,n){e.exports={box:"Fence_box_2lT68","tool-bar":"Fence_tool-bar_2FZ4x",op:"Fence_op_1V_MP",form:"Fence_form_vw2BH",submit:"Fence_submit_Thr33",point:"Fence_point_16SnX"}},"20fd":function(e,t,n){"use strict";var a=n("d9f6"),o=n("aebd");e.exports=function(e,t,n){t in e?a.f(e,t,o(0,n)):e[t]=n}},"549b":function(e,t,n){"use strict";var a=n("d864"),o=n("63b6"),r=n("241e"),i=n("b0dc"),s=n("3702"),c=n("b447"),l=n("20fd"),f=n("7cd6");o(o.S+o.F*!n("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,o,u,p=r(e),m="function"==typeof this?this:Array,d=arguments.length,h=d>1?arguments[1]:void 0,b=void 0!==h,v=0,g=f(p);if(b&&(h=a(h,d>2?arguments[2]:void 0,2)),void 0==g||m==Array&&s(g))for(t=c(p.length),n=new m(t);t>v;v++)l(n,v,b?h(p[v],v):p[v]);else for(u=g.call(p),n=new m;!(o=u.next()).done;v++)l(n,v,b?i(u,h,[o.value,v],!0):o.value);return n.length=v,n}})},"54a1":function(e,t,n){n("6c1c"),n("1654"),e.exports=n("95d5")},"75fc":function(e,t,n){"use strict";var a=n("a745"),o=n.n(a);function r(e){if(o()(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var i=n("774e"),s=n.n(i),c=n("c8bb"),l=n.n(c);function f(e){if(l()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return s()(e)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(e){return r(e)||f(e)||u()}n.d(t,"a",function(){return p})},"774e":function(e,t,n){e.exports=n("d2d5")},"95d5":function(e,t,n){var a=n("40c3"),o=n("5168")("iterator"),r=n("481b");e.exports=n("584a").isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||r.hasOwnProperty(a(t))}},b1fa:function(e,t,n){"use strict";var a=n("1422"),o=n.n(a);t["default"]=o.a},ba16:function(e,t,n){var a=n("5ca1"),o=n("11e9").f,r=n("cb7c");a(a.S,"Reflect",{deleteProperty:function(e,t){var n=o(r(e),t);return!(n&&!n.configurable)&&delete e[t]}})},c8bb:function(e,t,n){e.exports=n("54a1")},d2d5:function(e,t,n){n("1654"),n("549b"),e.exports=n("584a").Array.from},fc9b:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.box},[n("div",{class:e.$style["tool-bar"]},[n("map-select",{staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}})],1),n("div",{ref:"map",staticStyle:{height:"100%",overflow:"hidden"}}),n("el-collapse",{class:e.$style.op,model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{attrs:{name:"info",title:"区域信息"}},[n("app-table",{class:e.$style.table,attrs:{"max-height":255,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":150,noPrint:!0,isSmall:!0},on:{updateData:e.getData,del:e.del,display:e.display}})],1),n("el-collapse-item",{attrs:{title:"添加区域",name:"add"}},[n("el-form",{ref:"form",class:e.$style.form,style:{"max-height":e.formHeight},attrs:{model:e.form,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"区域名称",required:""}},[n("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"区域模式"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[n("el-option",{attrs:{label:"进入区域",value:0}}),n("el-option",{attrs:{label:"离开区域",value:1}})],1)],1),e._l(e.form.position,function(t,a){return n("el-form-item",{key:a,attrs:{label:"区域坐标"+(a+1)}},[n("el-button",{attrs:{type:t?"warning":"success",size:"mini"},on:{click:function(n){return e.setPosition(t,a)}}},[e._v("\n                        "+e._s(t?"删除":"设置")+"\n                    ")]),n("span",{staticClass:"ellipsis",class:e.$style.point},[e._v("\n                        "+e._s(t?JSON.stringify(t):"")+"\n                    ")])],1)}),n("el-form-item",{attrs:{label:"启动"}},[n("el-switch",{attrs:{"active-text":"true","inactive-text":"false"},model:{value:e.form.open,callback:function(t){e.$set(e.form,"open",t)},expression:"form.open"}})],1)],2),n("el-button",{class:e.$style.submit,attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                提交\n            ")])],1)],1)],1)},o=[],r=(n("ba16"),n("ac6a"),n("75fc")),i=(n("7f7f"),n("96cf"),n("3b8d")),s=n("d225"),c=n("b0b4"),l=n("308d"),f=n("6bb5"),u=n("4e2b"),p=n("9ab4"),m=n("2fe1"),d=n("ae85"),h=n("99d1"),b=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(f["a"])(t).apply(this,arguments)),e.activeNames=["info","add"],e.colCfg=[{prop:"name",label:"区域",sortable:!0,width:80},{prop:"status",label:"状态",width:70}],e.op=[{type:"danger",name:"del",desc:"删除"},{type:{default:"primary"},name:"display",desc:{default:"显示"}}],e.form={name:"",mode:0,position:[null],open:!1},e.pointIndex=-1,e}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"del",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("确认删除区域".concat(t.name,"?"),"确认删除");case 3:return e.next=5,this.$http.post("/api/zone/deleteZone",{id:t.id});case 5:this.$message.success("删除成功"),this.refresh(),this.display(t,n,!0),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}},e,this,[[0,10]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"display",value:function(e,t,n){var a=this.op[1];a.type[t]||n?(a.type[t]=void 0,this.mgr&&this.mgr.remove(e.name)):(a.type[t]="success",this.mgr&&this.mgr.zoneOpen(e)),a.desc[t]=a.desc[t]||n?void 0:"隐藏",this.$set(this.op,1,a)}},{key:"setPosition",value:function(e,t){var n=this.form.position.indexOf(e);e&&n>-1?(this.form.position.splice(n,1),this.mgr.remove(JSON.stringify(e))):this.pointIndex=t}},{key:"onSubmit",value:function(){var e=this;if(!this.form.name.length)return this.$message.warning("区域名称必填");if(this.form.position.length<4)return this.$message.warning("区域坐标最少设置3个");var t=Object(r["a"])(this.form.position);t.pop();var n=Date.now(),a={id:0,position:t,name:this.form.name,enable:this.form.open?1:0,createTime:n,updateime:n};this.mgr.createPolygonMarker(t,a.name,!0),setTimeout(function(){e.$confirm("请确定当前区域范围","提示",{type:"info"}).then(function(){return t.forEach(e.setPosition,e),a.position=JSON.stringify(t),Reflect.deleteProperty(a,"id"),e.$http.post("/api/zone/addZone",a,{"Content-Type":"application/json"})}).then(function(){e.$message.success("添加成功"),e.refresh(e.page),e.$refs.form.resetFields()}).catch(console.log).finally(function(){e.mgr.remove(a.name)})},1e3)}},{key:"fetch",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var a,o,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=[],o=0,e.prev=2,e.next=5,this.$http.get("/api/zone/getall",{pageSize:n,currentPage:t});case 5:r=e.sent,a=r.pagedData.datas.map(function(e){return e.status=e.enable?"开启":"关闭",e.position=JSON.parse(e.position),e}),o=r.pagedData.totalCount,e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](2);case 12:return e.abrupt("return",{count:o,data:a});case 13:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"bindEvents",value:function(){var e=this;this.mgr.on("mapClickNode",function(t){if(t.nodeType!==fengmap.FMNodeType.NONE&&e.pointIndex>-1){var n=t.eventInfo.coord,a=e.mgr.addImage({x:n.x,y:n.y,url:"/images/blueImageMarker.png",size:32,height:2});e.$set(e.form.position,e.pointIndex,a),e.pointIndex=-1,e.form.position.push(null)}})}},{key:"formHeight",get:function(){return"calc(".concat(100/this.$store.state.rootScale,"vh - 600px)")}}]),t}(Object(m["c"])(d["a"],h["a"]));b=p["a"]([m["b"]],b);var v=b,g=v,y=n("b1fa"),x=n("2877");function w(e){this["$style"]=y["default"].locals||y["default"]}var $=Object(x["a"])(g,a,o,!1,w,null,null);t["default"]=$.exports}}]);
//# sourceMappingURL=system1.6cd0c8b2.js.map