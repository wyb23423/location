{"version":3,"sources":["webpack:///./src/components/edit/MapEdit.vue?f0c5","webpack:///./src/views/map/History.vue?404e","webpack:///./src/views/map/Monitor.vue?26d5","webpack:///./src/views/map/Monitor.vue?41c8","webpack:///./src/components/monitor/Census.vue?84c2","webpack:///./src/components/monitor/Zone.vue?39bd","webpack:///./src/components/monitor/Census.vue?b261","webpack:///./node_modules/core-js/modules/es6.array.find-index.js","webpack:///./src/views/map/MapUpdate.vue?44a1","webpack:///./src/views/map/MapUpdate.vue?b317","webpack:///./src/views/map/MapUpdate.vue?1373","webpack:///./src/views/map/MapUpdate.vue","webpack:///./src/views/map/History.vue?e1b7","webpack:///./src/components/Control.vue?61c7","webpack:///./src/mixins/control.ts","webpack:///./src/components/Control.vue?a56f","webpack:///./src/components/Control.vue?51a0","webpack:///./src/components/Control.vue","webpack:///./src/views/map/History.vue?2af8","webpack:///./src/views/map/History.vue?300a","webpack:///./src/views/map/History.vue","webpack:///./src/views/map/MapAdd.vue?b686","webpack:///./src/views/map/MapAdd.vue?70bd","webpack:///./src/views/map/MapAdd.vue?4cf1","webpack:///./src/views/map/MapAdd.vue","webpack:///./src/mixins/zone/display.ts","webpack:///./src/components/Control.vue?157a","webpack:///./node_modules/core-js/modules/es7.object.values.js","webpack:///./src/views/map/Monitor.vue?756d","webpack:///./src/mixins/event.ts","webpack:///./src/components/monitor/Zone.vue?4543","webpack:///./src/components/monitor/Zone.vue?f54b","webpack:///./src/components/monitor/Zone.vue?362e","webpack:///./src/components/monitor/Zone.vue","webpack:///./src/components/monitor/Group.vue?1cb3","webpack:///./src/components/monitor/Group.vue?7771","webpack:///./src/components/monitor/Group.vue?bedc","webpack:///./src/components/monitor/Group.vue","webpack:///./src/components/monitor/Census.vue?7f0f","webpack:///./src/components/monitor/Census.vue?6b03","webpack:///./src/components/monitor/Census.vue?f44e","webpack:///./src/components/monitor/Census.vue","webpack:///./src/mixins/monitor/websocket.ts","webpack:///./src/mixins/map/link.ts","webpack:///./src/mixins/monitor/index.ts","webpack:///./src/views/map/Monitor.vue?1bf9","webpack:///./src/views/map/Monitor.vue?85f6","webpack:///./src/views/map/Monitor.vue","webpack:///./src/components/Control.vue?6ae3","webpack:///./src/components/monitor/Group.vue?4117","webpack:///./src/views/map/MapIndex.vue?5337","webpack:///./src/views/map/MapIndex.vue?d8bf","webpack:///./src/views/map/MapIndex.vue?6194","webpack:///./src/views/map/MapIndex.vue","webpack:///./src/components/Table.vue?49c2","webpack:///./src/components/Table.vue?64db","webpack:///./src/components/Table.vue?e39a","webpack:///./src/components/Table.vue","webpack:///./src/mixins/table.ts","webpack:///./node_modules/core-js/modules/es6.string.ends-with.js","webpack:///./src/components/Control.vue?74fa","webpack:///./src/components/monitor/Group.vue?0a4f","webpack:///./src/components/edit/MapEdit.vue?41a0","webpack:///./node_modules/vuex-class/lib/bindings.js","webpack:///./src/components/edit/MapEdit.vue?7268","webpack:///./src/components/edit/MapEdit.vue?179b","webpack:///./src/components/edit/MapEdit.vue?069d","webpack:///./src/components/edit/MapEdit.vue","webpack:///./src/views/map/History.vue?4227","webpack:///./src/components/monitor/Zone.vue?1527"],"names":["module","exports","$export","$find","KEY","forced","Array","P","F","findIndex","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticStyle","_v","attrs","on","selectMap","permission","delete","del","_e","staticClass","put","map","onSubmit","$event","staticRenderFns","data","margin","id","name","minX","maxX","minY","maxY","width","height","filepath","endsWith","$confirm","then","$http","post","$message","success","location","href","catch","console","log","error","file","mapName","split","resultMap","mapUrl","filename","url","res","body","groupCode","JSON","stringify","headers","components","MapEdit","MapSelect","component","ref","date","showPath","timeRange","loadCall","onPlay","onProgress","onPause","setIcons","model","value","callback","$$v","progress","expression","class","$style","mark","control","content","item","isPlaying","loading","remoteMethod","change","tagNos","_l","key","label","dateProxy","hasData","showPathProxy","canPlay","play","rePlay","_s","_f","format","$emit","DEFAULT_FRAGMENT","fragmentLength","controller","abort","Promise","reject","index","start","end","Math","min","fetch","datas","localforage","clear","syncLoad","savePosition","time","AbortController","arr","i","push","all","offset","Date","getTimezoneOffset","startTime","endTime","pagedData","resolve","getItem","fragment","forEach","v","position","every","p","sTagNo","x","y","z","getTime","group","sGroupNo","setItem","ceil","max","options","timer","clearTimeout","setTimeout","get","pageSize","currentPage","icons","Map","tagNo","set","photo","pause","bind","_play","loadData","message","warning","cancelAnimationFrame","now","requestAnimationFrame","visible","filters","formatTime","injectStyles","context","locals","isLoading","renderTags","Set","next","moving","fragmentIndex","points","k","mgr","getFragment","remove","oldFragmentIndex","oldPoints","pointsData","has","parseProgress","prev","target","record","groups","includes","lineMgr","errorTime","moveTo","add","Object","entries","stopMoveTo","old","pop","count","showLoading","playTime","addImage","size","_m","$refs","form","reset","DisplayMixin","operation","type","default","desc","row","isDel","getOperation","op","removeZone","showZone","$set","zoneOpen","$values","S","values","it","hiddenCover","isName","nativeOn","indexOf","_k","keyCode","find","findTarget","slot","switch","tools","directives","rawName","display","active","stopPropagation","swithDisplay","zones","zoneMode","census","censusChange","handler","off","box","getData","modes","tableData","colCfg","totalCount","zoneOp","prop","page","filter","mode","list","slice","tmp","status","enable","parse","$parent","Reflect","switchZone","children","show","baseNo","base_no_1","allCount","info","true","getAllCount","censusTags","zone","baseNo1","from","flatMap","ws","tagAll","closeWebSocket","ip","event","doMonitor","wsUrl","WebSocket","replace","join","onmessage","tag","close","bindings","testData","tags","normalize","missHandler","alarmMsg","link","coords","getAngRecordPoints","addLine","lineType","fengmap","FMLineType","FULL","lineWidth","smooth","color","colorNum","flag","deleteProperty","isArray","pops","moveTime","img","modifyImg","addPopInfo","mapCreated","nodeType","FMNodeType","IMAGE_MARKER","coord","update","iHeartRate","exitAnimation","addTag","static","miss","doCensus","emit","tagAnchor","afterMapCreated","ids","groupIDs","e","tagData","addIcon","tagName","groupData","isFullScreen","tagGroup","document","fullscreenElement","container","resize","offsetWidth","offsetHeight","toolItem","otherMode","switchViewMode","FMViewMode","MODE_3D","MODE_2D","other","showInfo","exitFullscreen","root","requestFullscreen","initWebSocket","has3D","mapId","hasUpdate","oldSize","Zone","Group","Census","tabs","title","to","icon","Page","maxHeight","opWidth","scopedSlots","_u","fn","scope","hidden","isDisable","$index","noPrint","isSmall","updateData","parseOpItem","obj","getMaxHeight","bodyStr","headStr","isRemove","thead","tbody","c","table","dom","$el","toLength","ENDS_WITH","$endsWith","searchString","that","endPosition","len","search","String","call","State","createBindingHelper","bindTo","mapFn","makeDecorator","namespace","componentOptions","_a","mapObject","helper","a","b","proto","extractNamespace","n","inline","changeUpload","submit","raw","reader","FileReader","onload","result","readAsDataURL","validate","resetFields"],"mappings":"0FACAA,EAAOC,QAAU,CAAC,IAAM,oBAAoB,OAAS,yB,uBCArDD,EAAOC,QAAU,CAAC,KAAO,uB,oCCDzB,yBAA6e,eAAG,G,uBCChfD,EAAOC,QAAU,CAAC,WAAW,yBAAyB,MAAQ,sBAAsB,YAAY,0BAA0B,OAAS,yB,qBCAnID,EAAOC,QAAU,CAAC,IAAM,qB,qBCAxBD,EAAOC,QAAU,CAAC,IAAM,mB,kCCDxB,yBAA4e,eAAG,G,oCCE/e,IAAIC,EAAU,EAAQ,QAClBC,EAAQ,EAAQ,OAAR,CAA4B,GACpCC,EAAM,YACNC,GAAS,EAETD,IAAO,IAAIE,MAAM,GAAGF,IAAK,WAAcC,GAAS,KACpDH,EAAQA,EAAQK,EAAIL,EAAQM,EAAIH,EAAQ,QAAS,CAC/CI,UAAW,SAAmBC,GAC5B,OAAOP,EAAMQ,KAAMD,EAAYE,UAAUC,OAAS,EAAID,UAAU,QAAKE,MAGzE,EAAQ,OAAR,CAAiCV,I,2CCbjC,IAAIW,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,CAAC,eAAe,KAAK,cAAc,OAAO,CAACF,EAAG,KAAK,CAACE,YAAY,CAAC,MAAQ,YAAY,CAACL,EAAIM,GAAG,0BAA0BH,EAAG,UAAU,CAACI,MAAM,CAAC,OAAS,KAAK,CAACJ,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,SAAS,CAACJ,EAAG,aAAa,CAACK,GAAG,CAAC,UAAYR,EAAIS,cAAc,GAAGN,EAAG,eAAe,CAAIH,EAAIU,WAAWC,OAAQR,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,SAAS,KAAO,kBAAkBC,GAAG,CAAC,MAAQR,EAAIY,MAAM,CAACZ,EAAIM,GAAG,wCAAwCN,EAAIa,MAAM,IAAI,GAAGV,EAAG,MAAM,CAACW,YAAY,oCAAoCT,YAAY,CAAC,MAAQ,MAAM,mBAAmB,UAAaL,EAAIU,WAAWK,IAAKZ,EAAG,WAAW,CAACI,MAAM,CAAC,KAAOP,EAAIgB,KAAKR,GAAG,CAAC,OAASR,EAAIiB,SAAS,cAAc,SAASC,GAAQlB,EAAIgB,IAAIE,MAAWlB,EAAIa,MAAM,IACxzBM,EAAkB,G,kLC4CD,EAArB,6D,+DAGW,EAAAH,IAAa,GAHxB,+EAKqBI,GACb,IAAMC,EAAqBD,EAAKC,OAEhC1B,KAAKqB,IAAL,gBACIM,GAAIF,EAAKE,GACTC,KAAMH,EAAKG,KACXC,KAAMH,EAAO,GAAG,GAChBI,KAAMJ,EAAO,GAAG,GAChBK,KAAML,EAAO,GAAG,GAChBM,KAAMN,EAAO,GAAG,GAChBO,MAAOP,EAAO,GAAG,GACjBQ,OAAQR,EAAO,GAAG,IACjBD,EAAKU,SAASC,SAAS,SAClB,WACA,MAAQX,EAAKU,YAnB/B,4BAuBc,WACa,MAAfnC,KAAKqB,IAAIM,GACT3B,KAAKqC,SAAL,gBAAuBrC,KAAKqB,IAAIO,KAAhC,MACKU,MAAK,kBACF,EAAKC,MAAMC,KAAK,qBAAsB,CAAEb,GAAI,EAAKN,IAAIM,QAExDW,MAAK,WACF,EAAKG,SAASC,QAAQ,QACtBC,SAASC,KAAOD,SAASC,QAE5BC,MAAMC,QAAQC,KAEnB/C,KAAKyC,SAASO,MAAM,YAnChC,+BAuCoBvB,GAAW,WACvB,GAAmB,MAAfzB,KAAKqB,IAAIM,GACT,OAAO3B,KAAKyC,SAASO,MAAM,UAG/BhD,KAAKqC,SAAS,SACTC,MAAK,WACF,OAAIb,EAAKJ,IACE,EAAKkB,MAAMC,KAAK,0BAA2B,CAC9CS,KAAMxB,EAAKJ,IACX6B,QAASzB,EAAKJ,IAAIO,KAAKuB,MAAM,KAAK,IAAM,QAIzC,CAAEC,UAAW,CAAEC,OAAQ5B,EAAK6B,UAAY7B,EAAK8B,SAEvDjB,MAAK,SAACkB,GAA0C,IACrC3B,EAA2BJ,EAA3BI,KAAMC,EAAqBL,EAArBK,KAAMC,EAAeN,EAAfM,KAAMC,EAASP,EAATO,KAE1B,OAAO,EAAKO,MAAMC,KAAK,CACnBe,IAAK,qBACLE,KAAM,CACF9B,GAAI,EAAKN,IAAIM,GACbQ,SAAUqB,EAAIJ,UAAUC,OACxBzB,KAAMH,EAAKG,KACX8B,UAAWC,KAAKC,UAAUnC,EAAKiC,WAC/BhC,OAAQiC,KAAKC,UAAU,CACnB,CAAC/B,EAAME,GACP,CAACF,EAAMG,GACP,CAACF,EAAME,GACP,CAACF,EAAMC,GACP,CAACN,EAAKQ,MAAOR,EAAKS,WAG1B2B,QAAS,CACL,eAAgB,yBAI3BvB,MAAK,kBAAM,EAAKG,SAASC,QAAQ,WACjCG,MAAMC,QAAQC,SA/E3B,GAAoC,cACxB,gBAAP,kB,iCADgB,EAAM,gBAN1B,eAAU,CACPe,WAAY,CACR,WAAYC,EAAA,KACZ,aAAcC,EAAA,SAGD,WC7CiY,I,YCOlZC,EAAY,eACd,EACA7D,EACAoB,GACA,EACA,KACA,KACA,MAIa,aAAAyC,E,oDClBf,IAAI7D,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACW,YAAY,WAAW,CAACX,EAAG,MAAM,CAACW,YAAY,2BAA2BT,YAAY,CAAC,kBAAkB,eAAe,CAACF,EAAG,aAAa,CAACE,YAAY,CAAC,cAAc,QAAQG,GAAG,CAAC,UAAYR,EAAIS,cAAc,GAAGN,EAAG,MAAM,CAAC0D,IAAI,MAAMxD,YAAY,CAAC,OAAS,OAAO,SAAW,YAAYF,EAAG,kBAAkB,CAAC0D,IAAI,UAAUtD,MAAM,CAAC,KAAOP,EAAI8D,KAAK,SAAW9D,EAAI+D,SAAS,UAAY/D,EAAIgE,UAAU,SAAWhE,EAAIiE,UAAUzD,GAAG,CAAC,cAAc,SAASU,GAAQlB,EAAI8D,KAAK5C,GAAQ,kBAAkB,SAASA,GAAQlB,EAAI+D,SAAS7C,GAAQ,mBAAmB,SAASA,GAAQlB,EAAI+D,SAAS7C,GAAQ,KAAOlB,EAAIkE,OAAO,SAAWlE,EAAImE,WAAW,MAAQnE,EAAIoE,QAAQ,YAAYpE,EAAIqE,UAAUC,MAAM,CAACC,MAAOvE,EAAY,SAAEwE,SAAS,SAAUC,GAAMzE,EAAI0E,SAASD,GAAKE,WAAW,cAAe3E,EAAa,UAAEG,EAAG,MAAM,CAACW,YAAY,cAAc8D,MAAM5E,EAAI6E,OAAOC,MAAM,CAAC3E,EAAG,IAAI,CAACW,YAAY,sBAAsBd,EAAIa,MAAM,IACp+BM,EAAkB,G,8MCDlB,EAAS,WAAa,IAAInB,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACyE,MAAM5E,EAAI6E,OAAOE,SAAS,CAAC5E,EAAG,MAAM,CAACyE,MAAM5E,EAAI6E,OAAOG,SAAS,CAAC7E,EAAG,MAAM,CAACW,YAAY,cAAc8D,MAAM5E,EAAI6E,OAAOI,KAAK5E,YAAY,CAAC,eAAe,SAAS,CAACF,EAAG,YAAY,CAACE,YAAY,CAAC,YAAY,SAASE,MAAM,CAAC,SAAWP,EAAIkF,UAAU,iBAAiB,EAAE,QAAUlF,EAAImF,QAAQ,gBAAgBnF,EAAIoF,aAAa,YAAc,SAAS,SAAW,GAAG,OAAS,GAAG,WAAa,GAAG,gBAAgB,IAAI5E,GAAG,CAAC,OAASR,EAAIqF,QAAQf,MAAM,CAACC,MAAOvE,EAAU,OAAEwE,SAAS,SAAUC,GAAMzE,EAAIsF,OAAOb,GAAKE,WAAW,WAAW3E,EAAIuF,GAAIvF,EAAW,SAAE,SAASiF,GAAM,OAAO9E,EAAG,YAAY,CAACqF,IAAIP,EAAKV,MAAMhE,MAAM,CAAC,MAAQ0E,EAAKQ,MAAM,MAAQR,EAAKV,YAAW,GAAGpE,EAAG,iBAAiB,CAACE,YAAY,CAAC,OAAS,UAAUE,MAAM,CAAC,SAAWP,EAAIkF,UAAU,KAAO,gBAAgB,eAAe,YAAY,kBAAkB,IAAI,oBAAoB,OAAO,kBAAkB,QAAQ1E,GAAG,CAAC,OAASR,EAAIqF,QAAQf,MAAM,CAACC,MAAOvE,EAAa,UAAEwE,SAAS,SAAUC,GAAMzE,EAAI0F,UAAUjB,GAAKE,WAAW,eAAexE,EAAG,YAAY,CAACE,YAAY,CAAC,cAAc,KAAKE,MAAM,CAAC,cAAc,KAAK,gBAAgB,KAAK,UAAYP,EAAI2F,SAASrB,MAAM,CAACC,MAAOvE,EAAiB,cAAEwE,SAAS,SAAUC,GAAMzE,EAAI4F,cAAcnB,GAAKE,WAAW,oBAAoB,GAAGxE,EAAG,MAAM,CAACW,YAAY,cAAc8D,MAAM5E,EAAI6E,OAAOI,MAAM,CAAC9E,EAAG,YAAY,CAACE,YAAY,CAAC,YAAY,QAAQE,MAAM,CAAC,KAAOP,EAAIkF,UAAY,sBAAwB,qBAAqB,UAAYlF,EAAI6F,QAAQ,KAAO,QAAQrF,GAAG,CAAC,MAAQR,EAAI8F,QAAQ3F,EAAG,YAAY,CAACE,YAAY,CAAC,YAAY,QAAQE,MAAM,CAAC,UAAYP,EAAI2F,QAAQ,KAAO,kBAAkB,KAAO,QAAQnF,GAAG,CAAC,MAAQR,EAAI+F,UAAU5F,EAAG,MAAM,CAACW,YAAY,cAAc8D,MAAM5E,EAAI6E,OAAOH,UAAU,CAACvE,EAAG,OAAO,CAACH,EAAIM,GAAGN,EAAIgG,GAAGhG,EAAIiG,GAAG,aAAPjG,CAAqBA,EAAIgE,UAAUhE,EAAI0E,cAAcvE,EAAG,YAAY,CAACE,YAAY,CAAC,YAAY,IAAI,QAAU,UAAUE,MAAM,CAAC,UAAYP,EAAI6F,QAAQ,iBAAiB7F,EAAIkG,QAAQ1F,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOlB,EAAImG,MAAM,aAAa,OAAS,SAASjF,GAAQ,OAAOlB,EAAImG,MAAM,UAAU7B,MAAM,CAACC,MAAOvE,EAAY,SAAEwE,SAAS,SAAUC,GAAMzE,EAAI0E,SAASD,GAAKE,WAAW,cAAcxE,EAAG,OAAO,CAACH,EAAIM,GAAGN,EAAIgG,GAAGhG,EAAIiG,GAAG,aAAPjG,CAAqBA,EAAIgE,UAAU,UAAU,IAAI,QACntE,EAAkB,G,4DCchBoC,EAA2B,KAEZ,EAArB,6D,+DAMW,EAAAd,OAAmB,GACnB,EAAAK,SAAmB,EAElB,EAAAU,eAAyBD,EATrC,iFAoDQzG,KAAK2G,YAAc3G,KAAK2G,WAAWC,UApD3C,iCAwDmB,WACX,IAAK5G,KAAKqE,UACN,OAAOwC,QAAQC,OAAO,UAG1B,GAAI9G,KAAKqE,UAAY,MACjB,OAAOwC,QAAQC,OAAO,kBAG1B9G,KAAK2G,YAAc3G,KAAK2G,WAAWC,QAEnC,IAAMG,EAAQ/G,KAAK+G,MACdA,IACD/G,KAAK0G,eAAiBD,GAG1B,IAAMO,EAAQhH,KAAKmE,KAAM,GAAK4C,EAAQ/G,KAAK0G,eACrCO,EAAMC,KAAKC,IAAIH,EAAQhH,KAAK0G,eAAgB1G,KAAKmE,KAAM,IAE7D,OAAOnE,KAAKoH,MAAMJ,EAAOC,GACpB3E,MAAK,SAAC+E,GAAD,OAAuBN,EAAQM,EAAQC,EAAA,KAAYC,QAAQjF,MAAK,kBAAM+E,QAC3E/E,MAAK,SAAA+E,GAOF,OANKN,IAED,EAAKL,eAAoC,IAAnBD,GAA4BY,EAAMnH,QAAU,MAEtE,EAAK8F,SAAU,EAER,EAAKwB,SAASP,EAAKF,GACrBU,aAAaV,EAAOM,QArFzC,+BA0FqBK,EAAcX,GAAa,WACxC,KAAM/G,KAAKmE,MAAwB,MAAhBnE,KAAKmE,KAAK,IAAcuD,EAAO1H,KAAKmE,KAAK,IACxD,OAAOnE,KAGXA,KAAK2G,WAAa,IAAIgB,gBAEtB,IADA,IAAMC,EAAM,GAN4B,WAO/BC,GAYL,GAXAD,EAAIE,KACA,EAAKV,MACDM,EAAMR,KAAKC,IAAIO,EAAO,EAAKhB,eAAgB,EAAKvC,KAAK,IACrD,EAAKwC,YAEJrE,MAAK,SAAC+E,GACH,EAAKI,aAAaV,EAAQc,EAAGR,GAC7B,EAAK/C,UAAY,EAAKA,SAAS,EAAMyC,EAAQc,OAGzDH,GAAQ,EAAKhB,eACTgB,GAAQ,EAAKvD,KAAK,GAClB,eAbC0D,EAAI,EAAGA,GAAK,EAAGA,IAAK,SAApBA,GAAoB,eAarB,MAMR,OAFAhB,QAAQkB,IAAIH,GAAKtF,MAAK,kBAAM,EAAKkF,SAASE,EAAMX,EAAQ,MAAIlE,MAAMC,QAAQC,KAEnE/C,OApHf,4BAwHkBgH,EAAeC,EAAaN,GACtC,IAAMqB,EAA0C,KAAjC,IAAIC,MAAOC,oBAC1B,OAAOlI,KAAKuC,MACPC,KAAK,CACFe,IAAK,2BACLE,KAAM,CACF0E,UAAW,IAAIF,KAAKjB,EAAQgB,GAC5BI,QAAS,IAAIH,KAAKhB,EAAMe,GACxBrC,OAAQ3F,KAAK2F,QAEjB9B,QAAS,CACL,eAAgB,oBAEpB8C,eACDrE,MAAK,SAAAkB,GACJ,IAAM6D,EAAoB7D,EAAI6E,UAAUhB,MAExC,OAAOR,QAAQyB,QAAQjB,QAzIvC,8FA8I+BN,EAAetF,GA9I9C,kHAgJyB6F,EAAA,KAAYiB,QAAsBxB,EAAQ,IAhJnE,kFAkJkByB,EAAqB,GACrBR,EAA0C,KAAjC,IAAIC,MAAOC,oBAC1BzG,EAAKgH,SAAQ,SAAAC,GACLA,EAAEC,SAASC,OAAM,SAAAC,GAAC,OAAKA,GAAK,OAC3BL,EAASE,EAAEI,UAAYN,EAASE,EAAEI,QAAU,KAAKhB,KAAK,CACnDiB,GAAIL,EAAEC,SAAS,GACfK,GAAIN,EAAEC,SAAS,GACfM,GAAIP,EAAEC,SAAS,IAAM,EACrBjB,KAAM,IAAIO,KAAcS,EAAEhB,MAAOwB,UAAYlB,EAC7CmB,MAAOT,EAAEU,cA3JjC,kBA+JmB9B,EAAA,KAAY+B,QAAQtC,EAAQ,GAAIyB,IA/JnD,qJAaQ,OAAOxI,KAAKmE,MAAQ,MAb5B,aAeyBA,GACjBnE,KAAKwG,MAAM,cAAerC,KAhBlC,+BAoBQ,OAAOnE,KAAK4E,OAAS,GApB7B,aAsBwBG,GAChB/E,KAAKwG,MAAM,QAASzB,KAvB5B,8BA4BQ,SAAU/E,KAAK2F,OAAOzF,QAAUF,KAAKmE,MAAQnE,KAAKmE,KAAKjE,QAAU,KA5BzE,4BAiCQ,IAAMwH,EAAO1H,KAAK+E,SAAW/E,KAAKqE,UAAY,IAAMoC,EACpD,OAAIiB,GAAQ,EACD,EAGJR,KAAKoC,KAAK5B,EAAO1H,KAAK0G,kBAtCrC,4BA2CQ,IAAK1G,KAAKqE,UACN,OAAO,EAGX,IAAMqD,EAAOR,KAAKqC,IAAI,EAAGvJ,KAAKqE,UAAYoC,GAC1C,OAAOS,KAAKoC,KAAK5B,EAAO1H,KAAK0G,gBAAkB,MAhDvD,GAA0C,cAC9B,gBAAP,kB,2BACO,gBAAP,kB,gCACO,gBAAP,kB,4BACO,gBAAP,kB,+BAJgB,EAAY,gBADhC,QACoB,WCmFA,EAArB,6D,+DAGW,EAAAlB,SAAmB,EACnB,EAAAC,aAA+C,KAC/C,EAAAc,OAA6C,KAC7C,EAAAhB,WAAqB,EACrB,EAAAiE,QAAoB,GAP/B,+EAkBkB,WACVxJ,KAAKuG,OAAS,SAAC3B,GAAD,OAAmB,eAAW,EAAKP,UAAWO,IAE5D,IAAI6E,EAAgB,EACpBzJ,KAAKyF,aAAe,SAACI,GACjB,IAAI,EAAKL,QAAT,CAKA,GADAkE,aAAaD,IACR5D,EACD,OAAQ,EAAK2D,QAAQtJ,OAAS,EAGlCuJ,EAAQE,YAAW,WACf,EAAKnE,SAAU,EAEf,EAAKjD,MACAqH,IAAI,kBAAmB,CACpBC,SAAU,IACVC,YAAa,EACblI,KAAMiE,IAETvD,MAAK,SAAAkB,GACF,EAAKgG,QAAQtJ,OAAS,EACtB,IAAM6J,EAAQ,IAAIC,IAClBxG,EAAI6E,UAAUhB,MAAMoB,SAAQ,SAAAC,GACxB,EAAKc,QAAQ1B,KAAK,CACdhC,MAAO4C,EAAE9G,KACTgD,MAAO8D,EAAEuB,QAEbF,EAAMG,IAAIxB,EAAEuB,MAAOvB,EAAEyB,UAGzB,EAAK3D,MAAM,YAAauD,GACxB,EAAKvE,SAAU,KAElB3C,MAAMC,QAAQC,OACpB,SAxDf,kCA4DQ/C,KAAKoK,UA5Db,+BAgEQpK,KAAKgG,QAAUhG,KAAKiG,eAAgB,EACpCjG,KAAK+E,SAAW,IAjExB,+BAqEQ/E,KAAKoK,QACLvD,QAAQyB,UAAUhG,KAAKtC,KAAKmG,KAAKkE,KAAKrK,SAtE9C,6BAwEe,WACHA,KAAKuF,UAELvF,KAAKoK,MAAMpK,KAAK+E,UAAUyB,MAAM,SAE5BxG,KAAKgG,SACLhG,KAAKuF,WAAY,EACjBvF,KAAKsK,SACEtK,KAAK2F,OAAOzF,QAInBF,KAAKuF,WAAY,EAEjBvF,KAAKuK,WACAjI,KAAKtC,KAAKsK,MAAMD,KAAKrK,OACrB6C,OAAM,SAAC2H,GACJA,GAAW,EAAK/H,SAASO,MAAMwH,GAC/B,EAAKjF,WAAY,MAGzBvF,KAAKyC,SAASgI,QAAQ,WA7FtC,8BAmGqC,IAApB1F,EAAoB,uDAAD,EAQ5B,OAPI/E,KAAKyJ,QACLiB,qBAAqB1K,KAAKyJ,OAC1BzJ,KAAKyJ,WAAQtJ,GAEjBH,KAAK+E,SAAWA,EAChB/E,KAAKuF,WAAY,EAEVvF,OA3Gf,8BA8GiB,WACLA,KAAKyJ,QACLiB,qBAAqB1K,KAAKyJ,OAC1BzJ,KAAKyJ,WAAQtJ,GAGjB,IAAIuH,EAAOO,KAAK0C,MACVpG,EAAS,SAATA,IACF,IAAMoG,EAAM1C,KAAK0C,MACb,EAAKpF,YACL,EAAKR,WAAc4F,EAAMjD,GAAQ,EAAKrD,UAAa,KAGnD,EAAKU,UAAY,IACjB,EAAKqF,QAEL,EAAKX,MAAQmB,sBAAsBrG,GAGvCmD,EAAOiD,GAGXpG,IACAvE,KAAKwG,MAAM,UArInB,oCAYQ,OAAOxG,KAAKoE,UAZpB,aAc6ByG,GACrB7K,KAAKwG,MAAM,kBAAmBqE,OAftC,GAAqC,eAAO,IAChC,gBAAP,kB,+BADgB,EAAO,gBAH3B,eAAU,CACPC,QAAS,CAAEC,WAAA,WAEM,WCpG6W,I,oCCSlY,SAASC,EAAcC,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAIjH,EAAY,eACd,EACA,EACA,GACA,EACA+G,EACA,KACA,MAIa,EAAA/G,E,QCaM,EAArB,6D,+DACW,EAAAE,KAAwB,KACxB,EAAAY,SAAmB,EACnB,EAAAT,SAA+D,KAC/D,EAAA6G,WAAqB,EAElB,EAAAC,WAA0B,IAAIC,IAIhC,EAAAC,KAAmB,GACnB,EAAAC,OAAsB,IAAIF,IAC1B,EAAAG,eAAyB,EACzB,EAAAC,OAAmB,GACnB,EAAA1B,MAA6B,IAAIC,IAd7C,+EAwBkB,WAEVhK,KAAKsE,SAAW,SAACc,EAAkB2B,GAC3BA,IAAU,EAAKyE,eAAiB,EAAKL,YACrC,EAAKA,WAAY,EACjB/F,EAAQe,WA7BxB,+BAkCoB4D,GAA0B,WAEtCA,EAAMtB,SAAQ,SAACC,EAAGgD,GAAJ,OAAU,EAAK3B,MAAMG,IAAIwB,EAAGhD,QApClD,+BAwCiB,WACH1I,KAAK2L,KAAO3L,KAAKmE,MAAQnE,KAAKmE,KAAKjE,QAAU,GAInDF,KAAK4L,cACAtJ,MAAK,WACF,EAAKqJ,KAAO,EAAKA,IAAIE,SAGrBlC,YAAW,WACP,EAAK2B,KAAO,GACZ,EAAKC,OAAOhE,QACZ,EAAK6D,WAAW7D,UACjB,QAEN1E,MAAMC,QAAQC,OAxD3B,2MA4DY/C,KAAKwL,cAAgB,GA5DjC,wDAgEcM,EAAmB9L,KAAKwL,cACxBO,EAAY/L,KAAKyL,OAjE/B,kBAoEkBzL,KAAK4L,cApEvB,mFAsEmB9I,QAAQC,IAAR,OAtEnB,kDAyEoBkH,EAzEpB,KAyE2B+B,EAzE3B,KA0EY,GAAI,EAAKT,OAAOU,IAAIhC,GAChB,iBAGJpD,QAAQyB,UACHhG,MAAK,WACF,OAAK,EAAKqJ,IAIH,EAAKO,cACRF,EACAF,EACAC,EAAU9B,IAAU,GACpBA,GAPOpD,QAAQC,OAAO,YAU7BxE,MAAK,YAA6B,IAA1B6J,EAA0B,EAA1BA,KAAMC,EAAoB,EAApBA,OAAQC,EAAY,EAAZA,OAEnB,IAAK,EAAKC,OAAOC,SAASH,EAAOjD,OAM7B,OALI,EAAKwC,MACL,EAAKA,IAAIE,OAAO5B,GAChB,EAAK0B,IAAIa,QAAQX,OAAO5B,IAGrB,EAAKmB,WAAWpK,OAAOiJ,GAIlC,GAAMkC,GAAQ,EAAKf,WAAWa,IAAIhC,GAG3B,CACH,IAAMvC,EAAO0E,EAAO1E,KAAOyE,EAAKzE,KAAO2E,EAAOI,UAC9C,EAAKC,OAAOzC,EAAOmC,EAAQ1E,GAAMpF,MAAK,kBAClC,EAAKiJ,OAAOvK,OAAOiJ,MAEvB,EAAKsB,OAAOoB,IAAI1C,GAChBoC,EAAOtF,QACP,EAAKuE,KAAKrB,GAASoC,OARnB,EAAKrF,MAAMoF,EAAQnC,MAW1BpH,MAAMC,QAAQC,MApH/B,MAyE0C6J,OAAOC,QAAQ7M,KAAKyL,QAzE9D,gSA0HQzL,KAAK2L,KAAO3L,KAAK2L,IAAImB,eA1H7B,+FA+HQd,EACAF,EACAiB,EACA9C,GAlIR,gGAoIcoC,EAASrM,KAAKsL,KAAKrB,IAAU,CAC/BlD,MAAO,EACP0F,UAAW,GAKXX,IAAqB9L,KAAKwL,eAE1BY,EAASJ,EAAWK,EAAOtF,OAC3BoF,EAAOH,EAAWK,EAAOtF,MAAQ,KAGjCqF,EAASJ,EAAW,GACpBG,EAAOY,EAAMA,EAAIC,MAAQ,MAGxBZ,EArJb,oBAuJiBJ,EAAW9L,UACZF,KAAKoF,QAAQ6H,OAASjN,KAAKwL,cAAgB,GAxJ3D,uBA0JgBxL,KAAK2L,KAAO3L,KAAK2L,IAAIE,OAAO5B,GA1J5C,kBA2JuBpD,QAAQC,UA3J/B,iCA+JuCQ,EAAA,KAAYiB,QAC3BvI,KAAKwL,cAAgB,EAAI,IAhKjD,eA+J0B/J,EA/J1B,yBAmK2BzB,KAAKkM,cACRzK,EAAKwI,IAAU,GACf6B,EACAiB,EACA9C,IAvKxB,8DA0K2BjK,KAAKkN,eA1KhC,iCA+Ke,CAAEd,SAAQD,OAAME,WA/K/B,sJAkLkBD,EAAsBnC,GAChC,GAAMjK,KAAK2L,KAAO3L,KAAKmE,MAAQnE,KAAKmE,KAAKjE,QAAU,EAAnD,CAIA,IAAMiN,EAAYnN,KAAKqE,UAAYrE,KAAK+E,SAAY,IAC9CoD,EAAYiE,EAAO1E,KAAO1H,KAAKmE,KAAK,GAEtCgJ,GAAYhF,IACZnI,KAAK2L,IAAIyB,SACL,CACIrE,EAAGqD,EAAOrD,EACVC,EAAGoD,EAAOpD,EACV9G,OAAQ,GACRqB,IAAKvD,KAAK+J,MAAMH,IAAIK,GACpBoD,KAAM,IAEVpD,OACA9J,GACA,GAGJH,KAAKoL,WAAWuB,IAAI1C,GACpBjK,KAAKsL,KAAKrB,GAAS,CACflD,MAAO,EACP0F,UAAW,OA3M3B,oCAiNuB,WACf,OAAO5F,QAAQyB,UACVhG,MAAK,WACF,IAAMkJ,EAAgB,EAAKpG,QAAQ2B,MAEnC,OAAIyE,IAAkB,EAAKA,eACvB,EAAKA,cAAgBA,EACdlE,EAAA,KAAYiB,QAAkBiD,EAAgB,KAGlD,EAAKC,UAEfnJ,MAAK,SAAAmJ,GAAM,OAAK,EAAKA,OAASA,KAC9B5I,MAAM7C,KAAKkN,YAAY7C,KAAKrK,SA9NzC,oCAsOQ,OAHAA,KAAKmL,WAAY,EACjBnL,KAAKoF,QAAQgF,QAENvD,QAAQC,OAAO,gBAtO9B,gCAiBQ,OAAK9G,KAAKmE,MAAQnE,KAAKmE,KAAKjE,OAAS,EAC1B,EAGJF,KAAKmE,KAAK,GAAKnE,KAAKmE,KAAK,OArBxC,GAAqC,eAAO,SAQxB,gBAAf,eAAI,Y,8BARY,EAAO,gBAH3B,eAAU,CACPL,WAAY,CAAE,kBAAmB,MAEhB,WCzC+X,I,YCQpZ,SAAS,EAAcmH,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAI,EAAY,eACd,EACA9K,EACAoB,GACA,EACA,EACA,KACA,MAIa,e,oDC3Bf,IAAIpB,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,CAAC,eAAe,KAAK,cAAc,OAAO,CAACL,EAAIiN,GAAG,GAAG9M,EAAG,WAAW,CAAC0D,IAAI,OAAOrD,GAAG,CAAC,OAASR,EAAIiB,aAAa,IAC/NE,EAAkB,CAAC,WAAa,IAAInB,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,KAAK,CAACE,YAAY,CAAC,MAAQ,YAAY,CAACL,EAAIM,GAAG,4BAA4BH,EAAG,OAAO,CAACE,YAAY,CAAC,YAAY,SAAS,CAACL,EAAIM,GAAG,sG,kICsBxN,EAArB,gMACoBc,GAAS,WACrBzB,KAAKuC,MACAC,KAAK,0BAA2B,CAC7BS,KAAMxB,EAAKJ,IACX6B,QAASzB,EAAKJ,IAAIO,KAAKuB,MAAM,KAAK,IAAM,QAE3Cb,MAAK,SAACkB,GAAqB,IAChB3B,EAA2BJ,EAA3BI,KAAMC,EAAqBL,EAArBK,KAAMC,EAAeN,EAAfM,KAAMC,EAASP,EAATO,KAE1B,OAAO,EAAKO,MAAMC,KAAK,CACnBe,IAAK,kBACLE,KAAM,CACFtB,SAAUqB,EAAIJ,UAAUC,OACxBzB,KAAMH,EAAKG,KACX8B,UAAWC,KAAKC,UAAUnC,EAAKiC,WAC/BhC,OAAQiC,KAAKC,UAAU,CACnB,CAAC/B,EAAME,GACP,CAACF,EAAMG,GACP,CAACF,EAAME,GACP,CAACF,EAAMC,GACP,CAACN,EAAKQ,MAAOR,EAAKS,WAG1B2B,QAAS,CACL,eAAgB,yBAI3BvB,MAAK,WACF,EAAKG,SAASC,QAAQ,QACZ,EAAK6K,MAAMC,KAAMC,WAE9B5K,MAAMC,QAAQC,SAjC3B,GAAoC,cAAf,EAAM,gBAL1B,eAAU,CACPe,WAAY,CACR,WAAYC,EAAA,SAGC,WCvB8X,I,YCO/YE,EAAY,eACd,EACA7D,EACAoB,GACA,EACA,KACA,KACA,MAIa,aAAAyC,E,0MCXMyJ,EAArB,6D,+DAEW,EAAAC,UAAmB,CACtB,CACIC,KAAM,CAAEC,QAAS,WACjBjM,KAAM,UACNkM,KAAM,CAAED,QAAS,QAN7B,6EAamBE,EAAYhH,EAAeiH,GACtC,IAAML,EAAY3N,KAAKiO,eACjBpG,EAAI8F,EAAU7N,WAAU,SAAA4I,GAAC,MAAe,YAAXA,EAAE9G,QACrC,GAAIiG,GAAK,EAAG,CACR,IAAMqG,EAAKP,EAAU9F,GACjBqG,EAAGN,KAAKG,EAAIpM,KAAOqM,GACnBE,EAAGN,KAAKG,EAAIpM,SAAMxB,EAClBH,KAAKmO,WAAWJ,KAEhBG,EAAGN,KAAKG,EAAIpM,IAAM,UAClB3B,KAAKoO,SAASL,IAElBG,EAAGJ,KAAKC,EAAIpM,IAAMuM,EAAGJ,KAAKC,EAAIpM,KAAOqM,OAAQ7N,EAAY,KAEzDH,KAAKqO,KAAKV,EAAW9F,EAAGqG,GAG5B,OAAOlO,OA9Bf,qCAkCQ,OAAOA,KAAK2N,YAlCpB,iCAqCyBI,GACjB/N,KAAK2L,KAAO3L,KAAK2L,IAAIE,OAAOkC,EAAIpM,GAAK,OAAiBoM,EAAInM,QAtClE,+BAyCuBmM,GACf/N,KAAK2L,KAAO3L,KAAK2L,IAAI2C,SAASP,OA1CtC,GAA0C,cAArBL,EAAY,gBADhC,QACoBA,GAAA,U,kCCPrB,yBAA2d,eAAG,G,qBCC9d,IAAInO,EAAU,EAAQ,QAClBgP,EAAU,EAAQ,OAAR,EAA8B,GAE5ChP,EAAQA,EAAQiP,EAAG,SAAU,CAC3BC,OAAQ,SAAgBC,GACtB,OAAOH,EAAQG,O,2CCNnB,IAAItO,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAAC0D,IAAI,OAAO/C,YAAY,UAAUN,GAAG,CAAC,MAAQR,EAAIsO,cAAc,CAACnO,EAAG,MAAM,CAACW,YAAY,2BAA2B8D,MAAM5E,EAAI6E,OAAO,aAAa,CAAC1E,EAAG,aAAa,CAACK,GAAG,CAAC,UAAYR,EAAIS,aAAaN,EAAG,MAAM,CAACW,YAAY,eAAe,CAACX,EAAG,WAAW,CAACE,YAAY,CAAC,YAAY,QAAQ,eAAe,QAAQE,MAAM,CAAC,YAAe,OAASP,EAAIuO,OAAS,MAAQ,OAAQ,KAAO,UAAUC,SAAS,CAAC,MAAQ,SAAStN,GAAQ,OAAIA,EAAOqM,KAAKkB,QAAQ,QAAQzO,EAAI0O,GAAGxN,EAAOyN,QAAQ,QAAQ,GAAGzN,EAAOsE,IAAI,SAAkB,KAAcxF,EAAI4O,KAAK1N,KAAUoD,MAAM,CAACC,MAAOvE,EAAc,WAAEwE,SAAS,SAAUC,GAAMzE,EAAI6O,WAAWpK,GAAKE,WAAW,eAAe,CAACxE,EAAG,YAAY,CAACE,YAAY,CAAC,MAAQ,SAASE,MAAM,CAAC,KAAO,UAAU,yBAAwB,GAAOuO,KAAK,UAAUxK,MAAM,CAACC,MAAOvE,EAAU,OAAEwE,SAAS,SAAUC,GAAMzE,EAAIuO,OAAO9J,GAAKE,WAAW,WAAW,CAACxE,EAAG,YAAY,CAACI,MAAM,CAAC,MAAQ,EAAE,MAAQ,SAASJ,EAAG,YAAY,CAACI,MAAM,CAAC,MAAQ,EAAE,MAAQ,UAAU,IAAI,IAAI,IAAI,GAAGJ,EAAG,YAAY,CAACyE,MAAM5E,EAAI6E,OAAOkK,OAAOxO,MAAM,CAAC,cAAc,OAAO,gBAAgB,OAAO,eAAe,UAAU,iBAAiB,WAAW+D,MAAM,CAACC,MAAOvE,EAAY,SAAEwE,SAAS,SAAUC,GAAMzE,EAAI+D,SAASU,GAAKE,WAAW,cAAcxE,EAAG,MAAM,CAAC0D,IAAI,MAAMxD,YAAY,CAAC,OAAS,OAAO,SAAW,YAAYF,EAAG,MAAM,CAACyE,MAAM5E,EAAI6E,OAAOmK,OAAOhP,EAAIuF,GAAIvF,EAAS,OAAE,SAASqI,EAAEb,GAAG,OAAOrH,EAAG,YAAY,CAAC8O,WAAW,CAAC,CAAC1N,KAAK,OAAO2N,QAAQ,SAAS3K,MAAO8D,EAAE8G,SAAiB,IAAN3H,EAAS7C,WAAW,yBAAyBa,IAAIgC,EAAE5C,MAAM5E,EAAI6E,OAAO,aAAatE,MAAM,CAAC,KAAO8H,EAAE+G,OAAS,UAAY,IAAI5O,GAAG,CAAC,MAAQ,SAASU,GAAiC,OAAzBA,EAAOmO,kBAAyBrP,EAAIsP,aAAa9H,MAAM,CAACxH,EAAIM,GAAG,iBAAiBN,EAAIgG,GAAGqC,EAAE9G,MAAM,mBAAkB,GAAGpB,EAAG,aAAa,CAACI,MAAM,CAAC,KAAO,sBAAsB,CAAEP,EAAIgP,MAAM,GAAS,OAAE7O,EAAG,SAAS,CAACI,MAAM,CAAC,MAAQP,EAAIiG,GAAG,OAAPjG,CAAeA,EAAIuP,MAAMvP,EAAIwP,SAAS1G,OAAO,WAAa9I,EAAIyP,OAAO,aAAezP,EAAI0P,cAAclP,GAAG,CAAC,MAAQ,SAASU,GAAQlB,EAAIgP,MAAM,GAAGI,QAAS,MAAUpP,EAAIa,MAAM,GAAGV,EAAG,aAAa,CAACI,MAAM,CAAC,KAAO,sBAAsB,CAAEP,EAAIgP,MAAM,GAAS,OAAE7O,EAAG,OAAO,CAACE,YAAY,CAAC,QAAU,OAAOE,MAAM,CAAC,MAAQP,EAAIuP,MAAM,OAASvP,EAAIsN,aAAatN,EAAIa,MAAM,IAAI,IACrtEM,EAAkB,G,8KCGD,EAArB,mMAIQxB,KAAK6L,QAAU7L,KAAK6L,WAJ5B,yBAOiBjK,EAAgCoO,GAAgC,WACzEhQ,KAAK6L,OAAS,kBAAM,EAAKtK,OAAO0O,IAAIrO,EAAMoO,IAC1ChQ,KAAKuB,OAAOV,GAAGe,EAAMoO,OAT7B,GAAwC,cAAnB,EAAU,gBAD9B,QACoB,WCJjB,EAAS,WAAa,IAAI3P,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,GAAG,CAAC,MAAQ,SAASU,GAAQA,EAAOmO,qBAAsB,CAAClP,EAAG,UAAU,CAAC0D,IAAI,QAAQ/C,YAAY,OAAO8D,MAAM5E,EAAI6E,OAAOgL,KAAK,CAAC1P,EAAG,YAAY,CAACE,YAAY,CAAC,gBAAgB,QAAQE,MAAM,CAAC,SAAW,GAAG,YAAc,OAAO,KAAO,QAAQC,GAAG,CAAC,OAAS,SAASU,GAAQ,OAAOlB,EAAI8P,QAAQ,EAAG9P,EAAIwJ,YAAYlF,MAAM,CAACC,MAAOvE,EAAS,MAAEwE,SAAS,SAAUC,GAAMzE,EAAI+P,MAAMtL,GAAKE,WAAW,UAAU3E,EAAIuF,GAAIvF,EAAgB,cAAE,SAASqI,EAAEb,GAAG,OAAOrH,EAAG,YAAY,CAAC8O,WAAW,CAAC,CAAC1N,KAAK,OAAO2N,QAAQ,SAAS3K,MAAOgI,OAAO6B,OAAOpO,EAAIwP,UAAUtD,SAAS1E,GAAI7C,WAAW,wCAAwCa,IAAI6C,EAAE9H,MAAM,CAAC,MAAQ8H,EAAE,MAAQb,QAAO,GAAGrH,EAAG,YAAY,CAACI,MAAM,CAAC,aAAa,IAAI,aAAaP,EAAIgQ,UAAU,UAAUhQ,EAAIiQ,OAAO,cAAcjQ,EAAIkQ,WAAW,GAAKlQ,EAAImQ,OAAO,SAAU,EAAK,SAAU,GAAM3P,GAAG,CAAC,OAASR,EAAImP,QAAQ,WAAanP,EAAI8P,YAAY,IAAI,IACh8B,EAAkB,G,kqBC2CtB,IAAqB,EAArB,6D,+DAOW,EAAAC,MAAkB,GAElB,EAAAE,OAAgB,CACnB,CAAEG,KAAM,OAAQ3K,MAAO,MACvB,CAAE2K,KAAM,SAAU3K,MAAO,OAXjC,oFAmBQ,OAAO9F,KAAKwQ,QAAU,KAnB9B,uFAsB0BE,EAAc7G,GAtBxC,uGAuBY+F,EAAQ5P,KAAK4P,MACb5P,KAAKoQ,MAAMlQ,SACX0P,EAAQ5P,KAAK4P,MAAMe,QAAO,SAAAjI,GAAC,OAAI,EAAK0H,MAAM7D,SAAS7D,EAAEkI,UAEnDC,EAAOjB,EAAMkB,OAAOJ,EAAO,GAAK7G,EAAU6G,EAAO7G,GA3B/D,kBA6Be,CACHoD,MAAO2C,EAAM1P,OACbuB,KAAMoP,EAAKxP,KAAI,SAAAqH,GACX,IAAMqI,EAAM,EAAH,GAAoCrI,GAO7C,OANAqI,EAAIC,OAAStI,EAAEuI,OAAS,KAAO,KAC/BF,EAAIpI,SACsB,kBAAfD,EAAEC,SACHhF,KAAKuN,MAAMxI,EAAEC,UACbD,EAAEC,SAELoI,OAvCvB,sIAeQ,OAAO/Q,KAAKmR,SAAWC,QAAQxH,IAAI5J,KAAKmR,QAAS,WAfzD,GAAkC,eAAO,OAAY,SAC1C,gBAAN,Q,+BACM,gBAAN,Q,mCAEO,gBAAP,kB,4BACO,gBAAP,kB,6BALgB,EAAI,gBADxB,QACoB,WC5C4X,I,wBCQjZ,SAASnG,EAAcC,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAIjH,EAAY,eACd,EACA,EACA,GACA,EACA+G,EACA,KACA,MAIa,EAAA/G,E,QC3BX,EAAS,WAAa,IAAI5D,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,GAAG,CAAC,MAAQ,SAASU,GAAQA,EAAOmO,qBAAsB,CAAClP,EAAG,UAAU,CAAC0D,IAAI,QAAQ/C,YAAY,OAAO8D,MAAM5E,EAAI6E,OAAOgL,KAAK,CAAC1P,EAAG,YAAY,CAACI,MAAM,CAAC,aAAa,IAAI,aAAaP,EAAIgQ,UAAU,UAAUhQ,EAAIiQ,OAAO,cAAcjQ,EAAIkQ,WAAW,GAAK,CAAC,CAAE3C,KAAM,SAAUhM,KAAM,SAAUkM,KAAM,SAAU,SAAU,EAAK,SAAU,GAAMjN,GAAG,CAAC,OAASR,EAAIgR,WAAW,WAAahR,EAAI8P,YAAY,IAAI,IAC9e,EAAkB,GCyBD,G,UAArB,6D,+DAGW,EAAAG,OAAgB,CAAC,CAAEG,KAAM,KAAM3K,MAAO,OAHjD,gFAKsBiI,GACd,GAAI/N,KAAKmR,QAAS,CACd,IAAMxF,EAA4ByF,QAAQxH,IAAI5J,KAAKmR,QAAS,OACxDxF,GACAoC,EAAIuD,SAAS7I,SAAQ,SAAAC,GAAC,OAAIiD,EAAI4F,KAAK7I,EAAE8I,cATrD,uFAc0Bd,EAAc7G,GAdxC,8FAecgH,EAAOjE,OAAOC,QAAQ7M,KAAKmJ,OAAO2H,OACnCJ,EAAO,GAAK7G,EACb6G,EAAO7G,GAjBnB,kBAoBe,CACHoD,MAAO4D,EAAK3Q,OACZuB,KAAMoP,EAAKxP,KAAI,SAAAqH,GAAC,MAAK,CACjB/G,GAAI+G,EAAE,GACN4I,SAAU5I,EAAE,SAxB5B,iHAAmC,eAAO,UAC9B,gBAAP,kB,4BADgB,EAAK,gBADzB,QACoB,WC1B6X,I,YCQlZ,SAAS,EAAcuC,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAI,EAAY,eACd,EACA,EACA,GACA,EACA,EACA,KACA,MAIa,I,QC3BX,EAAS,WAAa,IAAI7K,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,GAAG,CAAC,MAAQ,SAASU,GAAQA,EAAOmO,qBAAsB,CAAClP,EAAG,UAAU,CAACyE,MAAM5E,EAAI6E,OAAOgL,KAAK,CAAC1P,EAAG,MAAM,CAACI,MAAM,CAAC,KAAO,UAAUuO,KAAK,UAAU,CAAC3O,EAAG,OAAO,CAACH,EAAIM,GAAG,UAAUH,EAAG,YAAY,CAACE,YAAY,CAAC,MAAQ,QAAQ,QAAU,SAASE,MAAM,CAAC,KAAO,OAAO,KAAO,iBAAiBC,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOlB,EAAImG,MAAM,cAAc,GAAGhG,EAAG,UAAU,CAACE,YAAY,CAAC,OAAS,gBAAgB,CAACF,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,SAAS,CAACJ,EAAG,YAAY,CAACI,MAAM,CAAC,WAAa,IAAI+D,MAAM,CAACC,MAAOvE,EAAS,MAAEwE,SAAS,SAAUC,GAAMzE,EAAIuE,MAAME,GAAKE,WAAW,UAAU3E,EAAIuF,GAAIvF,EAAS,OAAE,SAASiF,GAAM,OAAO9E,EAAG,YAAY,CAACqF,IAAIP,EAAK3D,GAAGf,MAAM,CAAC,MAAQ0E,EAAK1D,KAAK,MAAQ0D,EAAKmM,gBAAe,IAAI,IAAI,GAAGjR,EAAG,MAAM,CAACE,YAAY,CAAC,aAAa,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,CAAC,gBAAgB,iBAAiB,gBAAgB,QAAQ,CAACL,EAAIM,GAAG,+BAA+BN,EAAIgG,GAAGhG,EAAIqR,UAAU,oBAAoBlR,EAAG,MAAM,CAAC8O,WAAW,CAAC,CAAC1N,KAAK,OAAO2N,QAAQ,SAAS3K,QAASvE,EAAIsR,KAAM3M,WAAW,WAAWtE,YAAY,CAAC,aAAa,SAAS,CAACF,EAAG,OAAO,CAACH,EAAIM,GAAGN,EAAIgG,IAAIhG,EAAIsR,MAAQ,IAAI/P,MAAM,YAAYpB,EAAG,OAAO,CAACH,EAAIM,GAAG,yBAAyBN,EAAIgG,IAAIhG,EAAIsR,MAAQ,IAAIC,MAAM,8BAA8BpR,EAAG,MAAM,CAAC8O,WAAW,CAAC,CAAC1N,KAAK,OAAO2N,QAAQ,SAAS3K,OAAQvE,EAAIsR,MAAsB,KAAdtR,EAAIuE,MAAcI,WAAW,2BAA2B,CAACxE,EAAG,IAAI,CAACW,YAAY,kBAAkBT,YAAY,CAAC,YAAY,eAAe,IAAI,IAC3+C,EAAkB,G,YCkDD,G,wCAArB,6D,+DAKW,EAAAkE,MAAgB,GAChB,EAAA8M,SAAmB,EACnB,EAAAC,KAAY,KAPvB,+EAUQ3R,KAAK0R,SAAW1R,KAAK6R,gBAV7B,gCAekB,WACV,GAAI7R,KAAK4P,OAAS5P,KAAK8R,WAAY,CAC/B9R,KAAK0R,SAAW1R,KAAK6R,cAErB,IAAME,EAAO/R,KAAK4P,MAAMX,MAAK,SAAAvG,GAAC,OAAIA,EAAEsJ,UAAY,EAAKpN,SACrD,GAAImN,EAsBA,OAAQ/R,KAAK2R,KAAO,CAChB/P,KACImQ,EAAKnQ,MAAQmQ,EAAKnQ,KAAKQ,SAAS,MAAQ,GAAK,MACjDwP,MAAO5R,KAAK8R,WAAWlI,IAAI5J,KAAK4E,QAAU,IAAIyG,KAAOgC,MAI7DrN,KAAK2R,KAAO,QAjDxB,oCAsDQ,OAAOhS,MAAMsS,KAAKjS,KAAK8R,WAAWrD,UAAUyD,SAAQ,SAAAxJ,GAAC,sBAAQA,MAAIxI,WAtDzE,GAAoC,eACxB,gBAAP,kB,4BACO,gBAAP,kB,iCACO,gBAAP,kB,mCAYD,gBAFC,eAAM,gBACN,eAAM,U,sBAqCN,MAnDgB,EAAM,gBAD1B,QACoB,WCnD8X,I,YCQnZ,SAAS,EAAc+K,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAI,EAAY,eACd,EACA,EACA,GACA,EACA,EACA,KACA,MAIa,I,qGCtBF,GAAb,6D,+DACc,EAAAoB,OAAmB,GAGrB,EAAA6F,GAAkB,GAJ9B,+EAMkB,WAEVnS,KAAKoS,OAAS,GACdpS,KAAKuC,MAAMqH,IAAI,kBAAmB,CAC9BE,YAAa,EACbD,SAAU,MAETvH,MAAK,SAAAkB,GAAG,OAAI,EAAK4O,OAAS,gBAAQ5O,EAAI6E,UAAUhB,MAAO,SAAS,MAChExE,OAAM,kBAAMC,QAAQC,SAdjC,sCAkBQ/C,KAAKqS,iBACLrS,KAAKoS,OAAS,KAnBtB,sCAsB2B,WACnBpS,KAAKqS,iBAEL,IAAMC,EAAK,kBACX,GAAKA,EAAL,CAKA,IAAMtC,EAAU,SAACuC,GACb,IAAM9Q,EAAiBkC,KAAKuN,MAAMqB,EAAM9Q,MACpC,EAAK2Q,OAAO3Q,EAAKqH,SAAWrH,EAAKkH,SAASC,OAAM,SAAAF,GAAC,OAAKA,GAAK,MAC3D,EAAK8J,UAAU/Q,IAIjBgR,EAAQ,gBAAkB,oBAAqB,gCAC/CN,EAAK,IAAIO,UAAJ,UAAiBD,EAAME,QAAQ,QAASL,GAAxC,YAA+CtS,KAAKsM,OAAOsG,KAAK,OAC3ET,EAAGU,UAAY7C,EACfhQ,KAAKmS,GAAK,CAACA,MAzCnB,gCAkDwBW,MAlDxB,uCAuDQ,IAAIX,EAAKnS,KAAKmS,GAAGnF,MACjB,MAAOmF,EACHA,EAAGY,QACHZ,EAAGU,UAAY,KACfV,EAAKnS,KAAKmS,GAAGnF,MAGjB,OAAOhN,SA9Df,GAAmC,cAAtB,GAAa,gBADzB,QACY,I,iBCKQ,I,oBAArB,6D,+DAGY,EAAAgT,SAAW,IAAIhJ,IACf,EAAAyB,OAAS,IAAIzB,IAJzB,+EAQkB,WAEJiJ,EAAW,CACb,CACItR,GAAI,EACJuR,KAAM,CAAC,WAAY,aAEvB,CACIvR,GAAI,EACJuR,KAAM,CAAC,WAAY,aAEvB,CACIvR,GAAI,EACJuR,KAAM,CAAC,WAAY,cAG3BlT,KAAKmT,UAAUF,GAGfjT,KAAKoT,YAAc,SAAC3R,GACZA,EAAK4R,WAAa,SAClB,EAAKC,KAAK7R,EAAKwI,QAGvBjK,KAAKuB,OAAOV,GAAG,QAAYb,KAAKoT,eAhCxC,kCAoCQpT,KAAKoT,aAAepT,KAAKuB,OAAO0O,IAAI,QAAYjQ,KAAKoT,eApC7D,2BAuCmBnJ,EAAesJ,GAAgB,WACpC9H,EAASzL,KAAKwT,mBAAmBvJ,EAAOsJ,GAE9C9H,EAAOhD,SAAQ,SAAAC,GACX,GAAI,EAAKiD,IACL,cAAqBiB,OAAOC,QAAQnE,GAApC,eAAwC,8BAA5BgD,EAA4B,KAAzB7C,EAAyB,KAC9BjH,EAAO,QAAU8J,EACvB,EAAKC,IAAIa,QAAQX,OAAOjK,GAEpBiH,EAAE3I,OAAS,IAIX2I,EAAE3I,OAAS,GACX2I,EAAEf,KAAKe,EAAE,IAGb,EAAK8C,IAAI8H,QACL5K,EACA,CACI6K,SAAUC,QAAQC,WAAWC,KAC7BC,UAAW,EACXC,QAAQ,EACRC,MAAO,OACPC,SAAU,UAEdrS,UAjExB,yCAwE+BqI,EAAesJ,GAAgB,WAChDP,EAAWhT,KAAKgT,SAASpJ,IAAIK,GAEnC,OAAK+I,EAIEA,EAAS3R,KAAI,SAAA6S,GAChB,IAAMzI,EAAS,EAAKA,OAAO7B,IAAIsK,IAAS,GAIxC,OAHAX,EAAU9H,EAAOxB,GAASsJ,EAAUnC,QAAQ+C,eAAe1I,EAAQxB,GACnE,EAAKwB,OAAOvB,IAAIgK,EAAMzI,GAEtB,kBAAUyI,EAAOtH,OAAO6B,OAAOhD,OARxB,KA5EnB,gCAwFsBpE,GAAmB,WACjCA,EAAMoB,SAAQ,SAAAC,GACV,IAAMwK,EAAiBvT,MAAMyU,QAAQ1L,EAAEwK,MAAQxK,EAAEwK,KAAOvP,KAAKuN,MAAMxI,EAAEwK,MAErEA,EAAKzK,SAAQ,SAAAwB,GACT,IAAM8G,EAAM,EAAKiC,SAASpJ,IAAIK,IAAU,GACxC8G,EAAIjJ,KAAKY,EAAE/G,IACX,EAAKqR,SAAS9I,IAAID,EAAO8G,aA/FzC,GAAkC,eAAb,GAAI,gBADxB,QACoB,c,6kBCIrB,IAAqB,GAArB,6D,+DACW,EAAA3F,WAAqC,GAEpC,EAAAiJ,KAAyB,IAAIrK,IACpB,EAAAsK,SAAW,EAAI,gBAAkB,eAAgB,GAJtE,+EAMkB,WACVtU,KAAKuB,OAAOV,GAAG,SAAiB,SAACoJ,EAAesK,GAAhB,OAAgC,EAAK5I,KAAO,EAAKA,IAAI6I,UAAUvK,EAAOsK,QAP9G,sCAWQvU,KAAKuB,OAAO0O,IAAI,SAEhBrD,OAAO6B,OAAOzO,KAAKoL,YAAY3C,QAAQiB,cACvC1J,KAAKqU,KAAK5L,SAAQ,SAAAC,GAAC,OAAIA,EAAEqK,aAdjC,+BAkBuBlN,EAAa+I,GAAc,WAC1C,GAAI5O,KAAK2L,MAAQ3L,KAAKqU,KAAKpI,IAAIpG,GAAM,CACjC,IAAMqN,EAAOlT,KAAK2L,IAAIsD,KAAKpJ,IAAO+I,GAE9BsE,EAAKhT,OACLgT,EAAKzK,SAAQ,SAACC,GACV,IAAM9G,EAAO,gBAAoB8G,EAAG,QAAQ9G,KAC5CA,GAAQ,EAAKyS,KAAKnK,IAAItI,EAAM,EAAK+J,IAAK8I,WAAW/L,OAGrD1I,KAAKyC,SAASkP,KAAd,eAA2B9L,EAA3B,YAAkCA,EAAlC,WA5BhB,mCAiCwB,WAChB7F,KAAK2L,IAAK9K,GAAG,eAAgBb,KAAK0U,WAAWrK,KAAKrK,OAElDA,KAAK2L,IAAK9K,GAAG,gBAAgB,SAAC0R,GAC1B,GAAI,EAAK5G,IAAK,CACV,IAAM1B,EAAQ,gBAAoBsI,EAAMnG,OAAQ,QAAQnC,MACxD,GAAIsI,EAAMoC,WAAahB,QAAQiB,WAAWC,cAAgB5K,EACjD,EAAKoK,KAAKpI,IAAIhC,IACf,EAAKoK,KAAKnK,IAAID,EAAO,EAAK0B,IAAI8I,WAAgBlC,EAAMnG,aAErD,4BACH,YAAqB,EAAKiI,KAAKxH,UAA/B,+CAA0C,iCAA9BnB,EAA8B,KAA3B7C,EAA2B,KACtCA,EAAEkK,SAAW,EAAKsB,KAAKrT,OAAO0K,IAF/B,0FA3CvB,0EAuDuBoH,MAvDvB,gCA4DwBA,GAAa,WAC7B,IAAK9S,KAAK2L,IACN,OAAO7I,QAAQC,IAAI,YAGvB,IAAMkH,EAAQ6I,EAAIhK,OACZW,EAAQzJ,KAAKoL,WAAWnB,GACxB6K,EAAiB,CACnB/L,GAAI+J,EAAInK,SAAS,GACjBK,GAAI8J,EAAInK,SAAS,GACjBM,EAAG,GAGP,GAAIQ,EAAO,CACPC,aAAaD,GAEb,IAAMsL,EAAS,WACX,IAAMlM,EAAI,EAAKwL,KAAKzK,IAAIK,GACpBpB,GAAKA,EAAEkM,SACPlM,EAAEkM,OAAOjC,EAAIkC,aAAe,EAAKX,KAAKrT,OAAOiJ,MAIhD6I,EAAInK,SAAS,IAAM,KACpB3I,KAAKiV,cAAchL,GACnB8K,KAEA/U,KAAK0M,OAAOzC,EAAO6K,EAAO9U,KAAKsU,SAAUS,QAI7C/U,KAAKkV,OAAOjL,EAAO6K,GACnB9U,KAAKoL,WAAWnB,GAAS,EAGxB6I,EAAIqC,SAELnV,KAAKoL,WAAWnB,GAASN,WAAW3J,KAAKoV,KAAK/K,KAAKrK,KAAMiK,GAAQ,UAIrEjK,KAAKqV,SAASvC,KArGtB,2BAyGiB7I,GACTjK,KAAKuB,OAAO+T,KAAK,QAAMrL,GAEnBjK,KAAK2L,MACL3L,KAAKoL,WAAWnB,IAAU,EAE1BjK,KAAK2L,IAAI4F,KAAKtH,GAAO,GACrBjK,KAAK2L,IAAIa,QAAQX,OAAO5B,GACxBjK,KAAKqV,SAASpL,GAGVjK,KAAKqU,KAAKpI,IAAIhC,KACRjK,KAAKqU,KAAKzK,IAAIK,GAAQ8I,OAAM,GAClC/S,KAAKqU,KAAKrT,OAAOiJ,OAtHjC,mCA2HsB,WAEd2C,OAAO6B,OAAOzO,KAAKoL,YAAY3C,QAAQiB,cACvC1J,KAAKoL,WAAa,GAGlBpL,KAAKqU,KAAK5L,SAAQ,SAAAC,GAAC,OAAIA,EAAEqK,WACzB/S,KAAKqU,KAAK9M,QAGVvH,KAAKoE,UAAW,EAGhBpE,KAAKuV,YAAYjT,MAAK,SAAAb,GAAI,OAAI2P,QAAQlH,IAAI,EAAM,YAAa,gBAAQzI,EAAM,iBAE3EzB,KAAKwV,oBA1Ib,6BA6ImBvL,EAAe6K,GAC1B,IAAIW,EAAgB,GACpB,IACIA,EAAYzV,KAAK2L,IAAKtK,IAAKqU,UAAY,GACzC,MAAOC,GAEL,OAIJ,IAAMC,EAAgB5V,KAAKoS,OAAOnI,GAClCjK,KAAK6V,QAAQJ,EAAI,IAAM,EAAvB,MACOG,EADP,GAEOd,EAFP,CAGIlT,KAAMqI,EACN6L,QAASF,EAAQhU,YA5J7B,GAA0C,eAAO,OAAU,GAAe,KAArD,GAAY,gBADhC,QACoB,c,aC2FA,GAArB,6D,+DAOW,EAAAmU,UAA6C,GAC7C,EAAAnG,MAAiB,GACjB,EAAAjC,UAAmB,CACtB,CACIC,KAAM,CAAEC,QAAS,WACjBjM,KAAM,UACNkM,KAAM,CAAED,QAAS,QAKlB,EAAAwB,MAAoB,CACvB,CAAEzN,KAAM,KAAM6N,QAAQ,EAAMD,SAAS,GACrC,CAAE5N,KAAM,KAAM6N,QAAQ,EAAOD,SAAS,GACtC,CAAE5N,KAAM,OAAQ6N,QAAQ,EAAOD,SAAS,GACxC,CAAE5N,KAAM,OAAQ6N,QAAQ,EAAOD,SAAS,GACxC,CAAE5N,KAAM,KAAM6N,QAAQ,EAAOD,SAAS,IAEnC,EAAAwG,cAAwB,EACxB,EAAA9G,WAAqB,GACrB,EAAAN,OAAiB,EAEjB,EAAAmB,aAAuB,EACtB,EAAA+B,WAAa,IAAI9H,IACjB,EAAAiM,SAAW,IAAIjM,IA/B3B,+EA6CkB,WACVhK,KAAKa,GAAG,SAAQ,WACZ,EAAKmV,eAAiBE,SAASC,kBAE3B,EAAKC,WAAa,EAAKzK,eAAe,SACtC,EAAKA,IAAItK,IAAIgV,OACT,EAAKD,UAAUE,YACf,EAAKF,UAAUG,mBApDnC,mCA4DwB1O,GAChB,IAAM2O,EAAWxW,KAAKqP,MAAMxH,GAC5B,GAAIA,EAAI,EAAG,CACP,GAAI2O,EAAS/G,OACT,OAGJ,IAAMgH,EAAYzW,KAAKqP,MAAMxH,EAAI,EAAI,GACrC4O,EAAUhH,QAAUgH,EAAUhH,OAE1BzP,KAAK2L,KACL3L,KAAK2L,IAAI+K,eACL7O,EAAI8L,QAAQgD,WAAWC,QAAUjD,QAAQgD,WAAWE,SAMhE,GADAL,EAAS/G,QAAU+G,EAAS/G,OAClB,IAAN5H,GAAiB,IAANA,EAAS,CACpB,IAAMiP,EAAQ9W,KAAKqP,MAAY,IAANxH,EAAU,EAAI,GACnC2O,EAAS/G,SACTqH,EAAMrH,QAAS,MAjF/B,oCAwFQ,IAAK,IAAI5H,EAAI,EAAGA,EAAI7H,KAAKqP,MAAMnP,OAAQ2H,IACnC7H,KAAKqP,MAAMxH,GAAG4H,QAAS,IAzFnC,6BA+FQ,IAAKzP,KAAKkP,WACN,OAAOlP,KAAKyC,SAASgI,QACK,OAI9BzK,KAAK+W,SAAS/W,KAAKkP,WAAYlP,KAAK4O,QACpC5O,KAAKkP,WAAa,KAtG1B,mCA0GQgH,SAASC,kBACHD,SAASc,iBACThX,KAAKiX,MAAQjX,KAAKiX,KAAKC,sBA5GrC,iCAgHQlX,KAAKmX,gBAELnX,KAAKqP,MAAM,GAAGI,QAAS,EACvBzP,KAAKqP,MAAM,GAAGI,QAAS,EAEvBzP,KAAKkP,WAAa,GAClB,IAAK,IAAIrH,EAAI,EAAGA,EAAI7H,KAAKqP,MAAMnP,OAAQ2H,IACnC7H,KAAKqP,MAAMxH,GAAG4H,QAAS,IAvHnC,2LA6HQzP,KAAKqP,MAAM,GAAGG,UAAYxP,KAAK2L,KAAO3L,KAAK2L,IAAIyL,MA7HvD,SA+H4BpX,KAAKuC,MAAMqH,IAAI,mBAAoB,CACnDE,YAAa,EACbD,SAAU,IACVwN,MAAerX,KAAKqX,QAlIhC,OA+HQrX,KAAK4P,MA/Hb,OAmIYvH,UAAUhB,MAnItB,wIAsIuByL,GACf,IAAM7I,EAAmB6I,EAAKhK,QAAkBgK,EAC1C3J,EAAQnJ,KAAKiW,SAASrM,IAAIK,GAE5BqN,GAAY,EAChB,GAAInO,EAAO,CACP,IAAMe,EAAMlK,KAAK8R,WAAWlI,IAAIT,GAChCmO,KAAepN,IAAOA,EAAIlJ,OAAOiJ,IAGrC,GAAmB,kBAAR6I,EAAkB,CACzB,IAAM,EAAM9S,KAAK8R,WAAWlI,IAAIkJ,EAAI1J,WAAa,IAAIiC,IAC/CkM,EAAU,EAAIlK,KACpB,EAAIV,IAAI1C,GAERqN,EAAYA,GAAaC,IAAY,EAAIlK,KACzCrN,KAAK8R,WAAW5H,IAAI4I,EAAI1J,SAAU,GAClCpJ,KAAKiW,SAAS/L,IAAID,EAAO6I,EAAI1J,UAGjC,GAAIkO,EAAW,CACX,IAAM3M,EAAM1C,KAAK0C,QACZ3K,KAAK0H,MAAQiD,EAAM3K,KAAK0H,MAAQ,OACjC1H,KAAK+P,aAAe/P,KAAK+P,aAAe,EAAI,EAC5C/P,KAAK0H,KAAOiD,MA9J5B,6BAsCQ,IAAM5B,EAAI/I,KAAK+P,aAIf,OAHAjN,QAAQC,IAAIgG,GAGL/I,KAAK8R,eA1CpB,GAAqC,eACjC,GACA,OACA,IAEO,gBAAN,Q,gCA6BY,gBAAZ,eAAI,S,4BA0FL,gBADC,mB,+BASA,MApIgB,GAAO,gBAZ3B,eAAU,CACPhO,WAAY,CACR0T,KAAA,EACAC,MAAA,EACAC,OAAA,GAEJ5M,QAAS,CACL8F,KADK,SACAvJ,EAAgB,GACjB,OAAOA,EAAMsJ,QAAO,SAAAjI,GAAC,OAAIA,EAAEkI,OAAS,UAI3B,cCzG+X,M,aCQpZ,SAAS,GAAc3F,GAErBjL,KAAK,UAAa,cAAOkL,QAAU,cAMrC,IAAI,GAAY,eACd,GACA9K,EACAoB,GACA,EACA,GACA,KACA,MAIa,gB,gCC1BfnC,EAAOC,QAAU,CAAC,QAAU,wBAAwB,QAAU,wBAAwB,SAAW,yBAAyB,KAAO,uB,oCCDjI,yBAA2e,eAAG,G,yCCA9e,IAAIc,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,WAAW,CAACI,MAAM,CAAC,KAAOP,EAAIsX,SAC7HnW,EAAkB,G,gGCcD,EAArB,6D,+DACW,EAAAmW,KAAO,CACV,CAAEC,MAAO,OAAQC,GAAI,WAAYC,KAAM,gBACvC,CACIF,MAAO,OACPC,GAAI,mBACJC,KAAM,gBAEV,CACIF,MAAO,OACPC,GAAI,gBACJC,KAAM,gBAEV,CACIF,MAAO,OACPC,GAAI,eACJC,KAAM,yBAhBlB,gCAAsC,cAAjB,EAAQ,gBAL5B,eAAU,CACPhU,WAAY,CACR,WAAYiU,EAAA,SAGC,WCfgY,I,YCOjZ9T,EAAY,eACd,EACA7D,EACAoB,GACA,EACA,KACA,KACA,MAIa,aAAAyC,E,mNClBX7D,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,WAAW,CAACE,YAAY,CAAC,gBAAgB,QAAQE,MAAM,CAAC,KAAOP,EAAIgQ,UAAU,QAAS,EAAK,aAAahQ,EAAI2X,UAAU,wBAAwB,gBAAgB,CAAC3X,EAAIuF,GAAIvF,EAAU,QAAE,SAASqI,EAAEb,GAAG,OAAOrH,EAAG,kBAAkB,CAACqF,IAAIgC,EAAEjH,MAAM,CAAC,wBAAwB,GAAG,KAAO8H,EAAE+H,KAAK,MAAQ/H,EAAE5C,MAAM,WAAY,EAAK,YAAuB,MAAX4C,EAAEzG,WAAgB9B,EAAYuI,EAAEzG,YAAY5B,EAAI6N,IAAM7N,EAAI6N,GAAGhO,OAAQM,EAAG,kBAAkB,CAACI,MAAM,CAAC,MAAQ,KAAK,WAAY,EAAK,YAA2B,MAAfP,EAAI4X,aAAkB9X,EAAYE,EAAI4X,SAASC,YAAY7X,EAAI8X,GAAG,CAAC,CAACtS,IAAI,UAAUuS,GAAG,SAASC,GAAO,MAAO,CAAC7X,EAAG,MAAM,CAACW,YAAY,eAAed,EAAIuF,GAAIvF,EAAM,IAAE,SAASqI,EAAEb,GAAG,OAAOrH,EAAG,YAAY,CAACqF,IAAIgC,EAAEjH,MAAM,CAAC,KAAO,OAAO,UAAUyX,EAAMtK,IAAIuK,OAAO,KAAOjY,EAAIiG,GAAG,QAAPjG,CAAgBqI,EAAEkF,KAAKyK,EAAMtK,KAAK,WAAWrF,EAAE6P,WAAY7P,EAAE6P,UAAUF,EAAMtK,MAAclN,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOlB,EAAIiV,KAAK5M,EAAE9G,KAAMyW,EAAMtK,IAAKsK,EAAMG,WAAW,CAACnY,EAAIM,GAAG,6BAA6BN,EAAIgG,GAAGhG,EAAIiG,GAAG,QAAPjG,CAAgBqI,EAAEoF,KAAKuK,EAAMtK,MAAM,+BAA8B,OAAO,MAAK,EAAM,cAAc1N,EAAIa,MAAM,GAAGV,EAAG,MAAM,CAACW,YAAY,cAAcT,YAAY,CAAC,kBAAkB,kBAAkB,CAAGL,EAAIoY,QAA2KpY,EAAIa,KAAtKV,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,OAAO,KAAO,mBAAmBC,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOlB,EAAIiV,KAAK,cAAc,CAACjV,EAAIM,GAAG,gCAAyCH,EAAG,gBAAgB,CAACI,MAAM,CAAC,eAAeP,EAAIqQ,KAAK,YAAYrQ,EAAIwJ,SAAS,QAAWxJ,EAAIqY,QAAU,GAAK,WAAa,oBAAqB,MAAQrY,EAAIkQ,WAAW,QAAUlQ,EAAIqY,QAAQ,wBAAwBrY,EAAIqY,QAAQ,cAAc,GAAG7X,GAAG,CAAC,cAAc,SAASU,GAAQ,OAAOlB,EAAIsY,WAAW,WAAYpX,IAAS,iBAAiB,SAASA,GAAQ,OAAOlB,EAAIsY,WAAW,OAAQpX,QAAa,IAAI,IAC7xDC,EAAkB,GCoFD,EAArB,6D,+DAUW,EAAAqI,SAAmB,GACnB,EAAA6G,KAAe,EAX1B,0EAegB9O,EAAsBmM,EAAUhH,GACxCnF,EAAOgX,EAAYhX,EAAMmM,GACzB/N,KAAKwG,MAAM5E,EAAMmM,EAAKhH,KAjB9B,iCAoBsB6G,EAA2BnM,GAAY,WACrDzB,KAAK4N,GAAQnM,EAETzB,KAAKyJ,QACLC,aAAa1J,KAAKyJ,OAClBzJ,KAAKyJ,MAAQ,MAGjBzJ,KAAKyJ,MAAQE,YACT,kBAAM,EAAKnD,MAAM,aAAc,EAAKkK,KAAM,EAAK7G,YAC/C,SA9BZ,GAAmC,cACvB,gBAAP,kB,gCACO,gBAAP,kB,gCACO,gBAAP,kB,iCACO,gBAAP,kB,6BACO,gBAAP,kB,yBACO,gBAAP,kB,8BACO,gBAAP,kB,8BACO,gBAAP,kB,8BARgB,EAAK,gBAHzB,eAAU,CACPiB,QAAS,CAAEoG,MAAO0H,MAED,WAoCrB,SAASA,EACLtT,EACAuT,GAEA,MAAoB,kBAATvT,EACAA,EAGJA,EAAKuT,EAAIlX,KAAO2D,EAAKuI,SAAW,MCjIqV,Q,YCO5X,EAAY,eACd,EACAzN,EACAoB,GACA,EACA,KACA,KACA,MAIa,I,QCDM,EAArB,6D,+DAGW,EAAA+O,WAAqB,EACrB,EAAAF,UAAmB,GACnB,EAAA2H,UAAoB,IACpB,EAAA1H,OAAgB,GACb,EAAAzG,SAAmB,GACnB,EAAA6G,KAAe,EAR7B,+EAiBQ1Q,KAAKmQ,QAAQ,EAAG,MAjBxB,gCAoBQnQ,KAAK8Y,iBApBb,yFAuByBpI,EAAc7G,GAvBvC,8FAwBQ7J,KAAK6J,SAAWA,EAChB7J,KAAK0Q,KAAOA,EAzBpB,SA2B0B1Q,KAAKoH,MAAMsJ,EAAM7G,GA3B3C,OA2BcrG,EA3Bd,OA4BQxD,KAAKuQ,WAAa/M,EAAIyJ,MACtBjN,KAAKqQ,UAAY7M,EAAI/B,KA7B7B,8SAgC2BzB,KAAK+Y,UAhChC,OAgCctV,EAhCd,OAiCQ,eAAYzD,KAAKgZ,UAAYvV,GAjCrC,gMAuC0BiN,EAAc7G,GAvCxC,0GAwCe,CAAEoD,MAAO,EAAGxL,KAAM,KAxCjC,uIA+C6D,IAAvCwX,IAAuC,yDAAbvI,EAAa,uCAarD,OAZY,MAARA,IAEIA,EADAuI,EACOjZ,KAAKqQ,UAAUnQ,OAAS,EACzBF,KAAK0Q,KACL1Q,KAAK0Q,KAAO,EAEX1Q,KAAK0Q,MAIpB1Q,KAAKmQ,QAAQjJ,KAAKqC,IAAI,EAAGmH,GAAO1Q,KAAK6J,UAE9B7J,OA5Df,gCAgEQ,IAAMkZ,EAAQ,CAAC,eAGf,OAFAlZ,KAAKsQ,OAAO7H,SAAQ,SAAAC,GAAC,OAAIwQ,EAAMpR,KAAN,cAAkBY,EAAE5C,MAApB,aACzBoT,EAAMpR,KAAK,iBACJoR,EAAMtG,KAAK,MAnE1B,2MAsE4B5S,KAAKoH,MAAMpH,KAAK0Q,KAAMxJ,KAAKC,IAAInH,KAAKuQ,WAAY,MAtE5E,cAsEc9O,EAtEd,OAsEoFA,KACtE0X,EAAQ,CAAC,WACf1X,EAAKgH,SAAQ,SAAAC,GACTyQ,EAAMrR,KAAK,QACX,EAAKwI,OAAO7H,SAAQ,SAAA2Q,GAAC,OAAID,EAAMrR,KAAN,8CAER,MAAbY,EAAE0Q,EAAE3I,MAAgB,IAAM/H,EAAE0Q,EAAE3I,MAFT,aAKzB0I,EAAMrR,KAAK,YAEfqR,EAAMrR,KAAK,YAjFnB,kBAkFeqR,EAAMvG,KAAK,KAlF1B,qSAqFc3O,EAAiBjE,KAAKuN,MAAM8L,OAC9BpV,EAtFZ,oBAuFkBqV,EAAmBrV,EAAUsV,KAAOtV,GACtCqV,EAxFhB,0CA0F0B,gBAAU,mBAAQA,EAAI/C,gBA1FhD,OA2FoBvW,KAAKgY,UAA+B,IAAnBsB,EAAI/C,aA3FzC,qDA6FoBzT,QAAQC,IAAR,MA7FpB,4IAWQ,OAAO/C,KAAKe,YAAcf,KAAKe,WAAWC,OACpC,CAAC,CAAE4M,KAAM,SAAUhM,KAAM,MAAOkM,KAAM,OACtC,OAbd,GAAwC,cAC5B,gBAAP,kB,iCADgB,EAAU,gBAL9B,eAAU,CACPhK,WAAY,CACR,YAAa,MAGA,a,kCCfrB,IAAIvE,EAAU,EAAQ,QAClBia,EAAW,EAAQ,QACnBvO,EAAU,EAAQ,QAClBwO,EAAY,WACZC,EAAY,GAAGD,GAEnBla,EAAQA,EAAQK,EAAIL,EAAQM,EAAI,EAAQ,OAAR,CAA8B4Z,GAAY,SAAU,CAClFrX,SAAU,SAAkBuX,GAC1B,IAAIC,EAAO3O,EAAQjL,KAAM2Z,EAAcF,GACnCI,EAAc5Z,UAAUC,OAAS,EAAID,UAAU,QAAKE,EACpD2Z,EAAMN,EAASI,EAAK1Z,QACpB+G,OAAsB9G,IAAhB0Z,EAA4BC,EAAM5S,KAAKC,IAAIqS,EAASK,GAAcC,GACxEC,EAASC,OAAOL,GACpB,OAAOD,EACHA,EAAUO,KAAKL,EAAMG,EAAQ9S,GAC7B2S,EAAK9I,MAAM7J,EAAM8S,EAAO7Z,OAAQ+G,KAAS8S,M,kCCjBjD,yBAA2c,EAAG,G,qBCC9c1a,EAAOC,QAAU,CAAC,IAAM,oB,kCCDxB,yBAA6e,eAAG,G,kCCAhf,8DAEW4a,EAAQC,EAAoB,WAAY,QAC/BA,EAAoB,WAAY,QAChCA,EAAoB,UAAW,QAC7BA,EAAoB,UAAW,QA0BrD,SAASA,EAAoBC,EAAQC,GACjC,SAASC,EAAcjZ,EAAKkZ,GACxB,OAAO,gBAAgB,SAAUC,EAAkB3U,GAC1C2U,EAAiBJ,KAClBI,EAAiBJ,GAAU,IAE/B,IAIIK,EAJAC,GAAaD,EAAK,GAAIA,EAAG5U,GAAOxE,EAAKoZ,GACzCD,EAAiBJ,GAAQvU,QAAqB1F,IAAdoa,EAC1BF,EAAME,EAAWG,GAAW7U,GAC5BwU,EAAMK,GAAW7U,MAI/B,SAAS8U,EAAOC,EAAGC,GACf,GAAiB,kBAANA,EAAgB,CACvB,IAAIhV,EAAMgV,EACNC,EAAQF,EACZ,OAAON,EAAczU,OAAK1F,EAAnBma,CAA8BQ,EAAOjV,GAEhD,IAAI0U,EAAYQ,EAAiBF,GAC7BjN,EAAOgN,EACX,OAAON,EAAc1M,EAAM2M,GAE/B,OAAOI,EAEX,SAASI,EAAiBvR,GACtB,IAAIwR,EAAIxR,GAAWA,EAAQ+Q,UAC3B,GAAiB,kBAANS,EAGX,MAAwB,MAApBA,EAAEA,EAAE9a,OAAS,GACN8a,EAAI,IAERA,I,kCChEX,IAAI5a,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAAC0D,IAAI,OAAOtD,MAAM,CAAC,cAAc,OAAO,MAAQP,EAAImN,OAAO,CAAChN,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,OAAO,SAAW,KAAK,CAACJ,EAAG,WAAW,CAACE,YAAY,CAAC,MAAQ,OAAOE,MAAM,CAAC,YAAc,WAAW+D,MAAM,CAACC,MAAOvE,EAAImN,KAAS,KAAE3I,SAAS,SAAUC,GAAMzE,EAAIgO,KAAKhO,EAAImN,KAAM,OAAQ1I,IAAME,WAAW,gBAAgB,GAAG3E,EAAIuF,GAAG,CAAE,OAAQ,OAAQ,OAAQ,SAAS,SAAS8F,GAAG,OAAOlL,EAAG,eAAe,CAACqF,IAAI6F,EAAE9K,MAAM,CAAC,MAAQ8K,EAAE,KAAOA,EAAE,SAAW,KAAK,CAAClL,EAAG,kBAAkB,CAACI,MAAM,CAAC,KAAO,IAAI,YAAc,QAAQ+D,MAAM,CAACC,MAAOvE,EAAImN,KAAK9B,GAAI7G,SAAS,SAAUC,GAAMzE,EAAIgO,KAAKhO,EAAImN,KAAM9B,EAAG5G,IAAME,WAAW,cAAc,MAAKxE,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,SAAW,KAAK,CAACJ,EAAG,eAAe,CAACyE,MAAM5E,EAAI6E,OAAO+V,OAAOra,MAAM,CAAC,SAAW,GAAG,KAAO,UAAU,CAACJ,EAAG,kBAAkB,CAACI,MAAM,CAAC,KAAO,IAAI,YAAc,SAAS+D,MAAM,CAACC,MAAOvE,EAAImN,KAAU,MAAE3I,SAAS,SAAUC,GAAMzE,EAAIgO,KAAKhO,EAAImN,KAAM,QAAS1I,IAAME,WAAW,iBAAiB,GAAGxE,EAAG,eAAe,CAACyE,MAAM5E,EAAI6E,OAAO+V,OAAOva,YAAY,CAAC,cAAc,QAAQE,MAAM,CAAC,SAAW,GAAG,KAAO,WAAW,CAACJ,EAAG,kBAAkB,CAACI,MAAM,CAAC,KAAO,IAAI,YAAc,SAAS+D,MAAM,CAACC,MAAOvE,EAAImN,KAAW,OAAE3I,SAAS,SAAUC,GAAMzE,EAAIgO,KAAKhO,EAAImN,KAAM,SAAU1I,IAAME,WAAW,kBAAkB,IAAI,GAAGxE,EAAG,eAAe,CAACI,MAAM,CAAC,SAAW,GAAG,MAAQ,OAAO,CAACJ,EAAG,YAAY,CAACI,MAAM,CAAC,eAAc,EAAM,OAAS,GAAG,kBAAiB,EAAM,YAAYP,EAAI6a,eAAe,CAAC1a,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,QAAQ,KAAO,UAAU,KAAO,mBAAmB,CAACP,EAAIM,GAAG,0CAA0CH,EAAG,MAAM,CAACW,YAAY,iBAAiBP,MAAM,CAAC,KAAO,OAAOuO,KAAK,OAAO,CAAE9O,EAAImN,KAAQ,IAAEhN,EAAG,MAAM,CAACyE,MAAM5E,EAAI6E,OAAOqP,IAAI3T,MAAM,CAAC,IAAMP,EAAImN,KAAKjK,OAAO,CAAClD,EAAIM,GAAG,yBAAyBN,EAAIgG,GAAGhG,EAAImN,KAAKlK,UACvyD,4BAA4B,wBAAwB,IAAI,IAAI,GAAG9C,EAAG,eAAe,CAACA,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQR,EAAI8a,SAAS,CAAC9a,EAAIM,GAAG,WAAW,IAAI,IACnMa,EAAkB,G,0uBC4EtB,IAAqB,EAArB,6D,+DAGW,EAAAgM,KAAc,CACjBjK,IAAK,GACLD,SAAU,GACVjC,IAAK,KACLO,KAAM,GACN8B,UAAW,IAGR,EAAAwX,aAA6C,KAXxD,+EAakB,WACVlb,KAAKkb,aAAe,SAACjY,GACjB,GACsB,cAAlBA,EAAKmY,IAAIxN,MACS,eAAlB3K,EAAKmY,IAAIxN,OACR3K,EAAKrB,KAAKQ,SAAS,SAEpB,OAAO,EAAKK,SAASO,MAAM,uBAG/B,GAAIC,EAAKoK,KAAO,KAAO,KAAO,EAC1B,OAAO,EAAK5K,SAASO,MAAM,mBAG/B,GAAIC,EAAKrB,KAAKQ,SAAS,SACnB,EAAKoL,KAAKjK,IAAM,GAChB,EAAKiK,KAAKlK,SAAWL,EAAKrB,SACvB,CACH,IAAMyZ,EAAS,IAAIC,WACnBD,EAAOE,OAAS,SAAC5F,GACb,EAAKnI,KAAKlK,SAAW,GAErB,EAAKkK,KAAKjK,IAA2BoS,EAAEvJ,OAAQoP,QAGnDH,EAAOI,cAAcxY,EAAKmY,KAG9B,EAAK5N,KAAKnM,IAAM4B,EAAKmY,OAzCjC,+BA6CiB,WACH5N,EAAexN,KAAKuN,MAAMC,KAEhCA,EAAKkO,WACApZ,MAAK,WACF,KAAM,EAAKkL,KAAKnM,KAAO,EAAKmM,KAAKjK,KAAO,EAAKiK,KAAKlK,UAC9C,OAAO,EAAKb,SAASgI,QAAQ,YAGjC,EAAKjE,MAAM,cAAe,EAAKgH,MAC/B,EAAKhH,MAAM,SAAU,EAAKgH,SAE7B3K,MAAMC,QAAQC,OAzD3B,8BAkEQ,OAJS/C,KAAKuN,MAAMC,KAAMmO,cAC1B3b,KAAKwN,KAAKnM,IAAM,KAChBrB,KAAKwN,KAAKjK,IAAMvD,KAAKwN,KAAKlK,SAAW,GAE9B,KAlEf,mCAuEQtD,KAAKwN,KAAL,KAAiBxN,KAAKyB,UAvE9B,GAAqC,cACF,gBAA9B,eAAK,CAAEoM,QAAS,iBAAO,O,2BA4DxB,gBADC,eAAK,gB,oBAOL,MAGD,gBADC,eAAM,S,yBAGN,MAxEgB,EAAO,gBAD3B,QACoB,WC9E+X,I,wBCQpZ,SAAS7C,EAAcC,GAErBjL,KAAK,UAAa,aAAOkL,QAAU,aAMrC,IAAIjH,EAAY,eACd,EACA7D,EACAoB,GACA,EACAwJ,EACA,KACA,MAIa,OAAA/G,E,2CC3Bf,yBAA6e,eAAG,G,kCCAhf,yBAA0e,eAAG","file":"js/map.317b7fea.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"img\":\"MapEdit_img_4UK2I\",\"inline\":\"MapEdit_inline_1gt2L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mark\":\"History_mark_3NHky\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monitor.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monitor.vue?vue&type=style&index=0&lang=postcss&module=true&\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tool-bar\":\"Monitor_tool-bar_2GPUR\",\"tools\":\"Monitor_tools_iFLWy\",\"tool-item\":\"Monitor_tool-item_182Qz\",\"switch\":\"Monitor_switch_3ZIU_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"box\":\"Census_box_3bEXU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"box\":\"Zone_box_2h2Ag\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Census.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Census.vue?vue&type=style&index=0&lang=postcss&module=true&\"","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"padding-left\":\"5%\",\"padding-top\":\"3%\"}},[_c('h3',{staticStyle:{\"color\":\"#009688\"}},[_vm._v(\"\\n        地图编辑\\n    \")]),_c('el-form',{attrs:{\"inline\":\"\"}},[_c('el-form-item',{attrs:{\"label\":\"选择地图\"}},[_c('map-select',{on:{\"selectmap\":_vm.selectMap}})],1),_c('el-form-item',[(!!_vm.permission.delete)?_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\"},on:{\"click\":_vm.del}},[_vm._v(\"\\n                删除\\n            \")]):_vm._e()],1)],1),_c('div',{staticClass:\"el-divider el-divider--horizontal\",staticStyle:{\"width\":\"95%\",\"background-color\":\"#e00\"}}),(!!_vm.permission.put)?_c('map-form',{attrs:{\"data\":_vm.map},on:{\"submit\":_vm.onSubmit,\"update:data\":function($event){_vm.map=$event}}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component from 'vue-class-component';\r\nimport Vue from 'vue';\r\nimport MapEdit from '@/components/edit/MapEdit.vue';\r\nimport MapSelect from '@/components/edit/MapSelect.vue';\r\nimport { Prop } from 'vue-property-decorator';\r\n\r\n@Component({\r\n    components: {\r\n        'map-form': MapEdit,\r\n        'map-select': MapSelect\r\n    }\r\n})\r\nexport default class MapAdd extends Vue {\r\n    @Prop() public permission!: Permission;\r\n\r\n    public map: IJson = {};\r\n\r\n    public selectMap(data: IMap) {\r\n        const margin = <number[][]>data.margin;\r\n\r\n        this.map = {\r\n            id: data.id,\r\n            name: data.name,\r\n            minX: margin[0][0],\r\n            maxX: margin[2][0],\r\n            minY: margin[0][1],\r\n            maxY: margin[2][1],\r\n            width: margin[4][0],\r\n            height: margin[4][1],\r\n            [data.filepath.endsWith('.fmap')\r\n                ? 'filename'\r\n                : 'url']: data.filepath\r\n        };\r\n    }\r\n\r\n    public del() {\r\n        if (this.map.id != null) {\r\n            this.$confirm(`删除地图: ${this.map.name}?`)\r\n                .then(() =>\r\n                    this.$http.post('/api/map/deleteMap', { id: this.map.id })\r\n                )\r\n                .then(() => {\r\n                    this.$message.success('删除成功');\r\n                    location.href = location.href;\r\n                })\r\n                .catch(console.log);\r\n        } else {\r\n            this.$message.error('未选择地图!');\r\n        }\r\n    }\r\n\r\n    public onSubmit(data: IJson) {\r\n        if (this.map.id == null) {\r\n            return this.$message.error('未选择地图!');\r\n        }\r\n\r\n        this.$confirm('确认修改?')\r\n            .then((): any => {\r\n                if (data.map) {\r\n                    return this.$http.post('/api/map/upload/mapfile', {\r\n                        file: data.map,\r\n                        mapName: data.map.name.split('.')[0] || 'map'\r\n                    });\r\n                }\r\n\r\n                return { resultMap: { mapUrl: data.filename || data.url } };\r\n            })\r\n            .then((res: { resultMap: { mapUrl: string } }) => {\r\n                const { minX, maxX, minY, maxY } = data;\r\n\r\n                return this.$http.post({\r\n                    url: '/api/map/updateMap',\r\n                    body: {\r\n                        id: this.map.id,\r\n                        filepath: res.resultMap.mapUrl,\r\n                        name: data.name,\r\n                        groupCode: JSON.stringify(data.groupCode),\r\n                        margin: JSON.stringify([\r\n                            [minX, minY],\r\n                            [minX, maxY],\r\n                            [maxX, maxY],\r\n                            [maxX, minY],\r\n                            [data.width, data.height]\r\n                        ])\r\n                    },\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n            })\r\n            .then(() => this.$message.success('修改成功'))\r\n            .catch(console.log);\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUpdate.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUpdate.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MapUpdate.vue?vue&type=template&id=1c6f287e&\"\nimport script from \"./MapUpdate.vue?vue&type=script&lang=ts&\"\nexport * from \"./MapUpdate.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"map-box\"},[_c('div',{staticClass:\"map-tool-bar flex-center\",staticStyle:{\"justify-content\":\"flex-start\"}},[_c('map-select',{staticStyle:{\"margin-left\":\"50px\"},on:{\"selectmap\":_vm.selectMap}})],1),_c('div',{ref:\"map\",staticStyle:{\"height\":\"100%\",\"overflow\":\"hidden\"}}),_c('history-control',{ref:\"control\",attrs:{\"date\":_vm.date,\"showPath\":_vm.showPath,\"timeRange\":_vm.timeRange,\"loadCall\":_vm.loadCall},on:{\"update:date\":function($event){_vm.date=$event},\"update:showPath\":function($event){_vm.showPath=$event},\"update:show-path\":function($event){_vm.showPath=$event},\"play\":_vm.onPlay,\"progress\":_vm.onProgress,\"pause\":_vm.onPause,\"set-icons\":_vm.setIcons},model:{value:(_vm.progress),callback:function ($$v) {_vm.progress=$$v},expression:\"progress\"}}),(_vm.isLoading)?_c('div',{staticClass:\"flex-center\",class:_vm.$style.mark},[_c('i',{staticClass:\"el-icon-loading\"})]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{class:_vm.$style.control},[_c('div',{class:_vm.$style.content},[_c('div',{staticClass:\"flex-center\",class:_vm.$style.item,staticStyle:{\"margin-right\":\"20px\"}},[_c('el-select',{staticStyle:{\"min-width\":\"200px\"},attrs:{\"disabled\":_vm.isPlaying,\"multiple-limit\":5,\"loading\":_vm.loading,\"remote-method\":_vm.remoteMethod,\"placeholder\":\"请输入标签名\",\"multiple\":\"\",\"remote\":\"\",\"filterable\":\"\",\"collapse-tags\":\"\"},on:{\"change\":_vm.change},model:{value:(_vm.tagNos),callback:function ($$v) {_vm.tagNos=$$v},expression:\"tagNos\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_c('el-date-picker',{staticStyle:{\"margin\":\"0 20px\"},attrs:{\"disabled\":_vm.isPlaying,\"type\":\"datetimerange\",\"value-format\":\"timestamp\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},on:{\"change\":_vm.change},model:{value:(_vm.dateProxy),callback:function ($$v) {_vm.dateProxy=$$v},expression:\"dateProxy\"}}),_c('el-switch',{staticStyle:{\"flex-shrink\":\"0\"},attrs:{\"active-text\":\"显示\",\"inactive-text\":\"隐藏\",\"disabled\":!_vm.hasData},model:{value:(_vm.showPathProxy),callback:function ($$v) {_vm.showPathProxy=$$v},expression:\"showPathProxy\"}})],1),_c('div',{staticClass:\"flex-center\",class:_vm.$style.item},[_c('el-button',{staticStyle:{\"font-size\":\"24px\"},attrs:{\"icon\":_vm.isPlaying ? 'el-icon-video-pause' : 'el-icon-video-play',\"disabled\":!_vm.canPlay,\"type\":\"text\"},on:{\"click\":_vm.play}}),_c('el-button',{staticStyle:{\"font-size\":\"24px\"},attrs:{\"disabled\":!_vm.hasData,\"icon\":\"el-icon-refresh\",\"type\":\"text\"},on:{\"click\":_vm.rePlay}}),_c('div',{staticClass:\"flex-center\",class:_vm.$style.progress},[_c('span',[_vm._v(_vm._s(_vm._f(\"formatTime\")(_vm.timeRange,_vm.progress)))]),_c('el-slider',{staticStyle:{\"flex-grow\":\"1\",\"padding\":\"0 15px\"},attrs:{\"disabled\":!_vm.canPlay,\"format-tooltip\":_vm.format},on:{\"input\":function($event){return _vm.$emit('progress')},\"change\":function($event){return _vm.$emit('play')}},model:{value:(_vm.progress),callback:function ($$v) {_vm.progress=$$v},expression:\"progress\"}}),_c('span',[_vm._v(_vm._s(_vm._f(\"formatTime\")(_vm.timeRange,100)))])],1)],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\r\n * 历史回放控制\r\n */\r\n\r\nimport Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { Prop } from 'vue-property-decorator';\r\nimport localforage from '@/assets/lib/localforage';\r\n\r\nexport interface PositionItem extends Vector3 {\r\n    time: number;\r\n    group: string;\r\n}\r\nexport interface Fragment { [x: string]: PositionItem[]; }\r\n\r\nconst DEFAULT_FRAGMENT: number = 1200000;\r\n@Component\r\nexport default class ControlMixin extends Vue {\r\n    @Prop() public date?: number[]; // 选择的时间范围\r\n    @Prop() public timeRange!: number; // 时间范围\r\n    @Prop() public value!: number; // 播放进度\r\n    @Prop() public loadCall?: (vm: this, index: number) => void; // 异步加载数据时的回调\r\n\r\n    public tagNos: string[] = []; // 选中标签号\r\n    public hasData: boolean = false; // 是否有可以用于播放的数据\r\n\r\n    private fragmentLength: number = DEFAULT_FRAGMENT; // 一个片段的时间长度\r\n    private controller?: AbortController; // 正在请求的数据片段中断控制器\r\n\r\n    public get dateProxy() {\r\n        return this.date || null;\r\n    }\r\n    public set dateProxy(date: number[] | null) {\r\n        this.$emit('update:date', date);\r\n    }\r\n\r\n    public get progress() {\r\n        return this.value || 0;\r\n    }\r\n    public set progress(progress: number) {\r\n        this.$emit('input', progress);\r\n    }\r\n\r\n    // 是否可播放\r\n    public get canPlay() {\r\n        return !!(this.tagNos.length && this.date && this.date.length >= 2);\r\n    }\r\n\r\n    // 通过当前进度计算片段索引\r\n    public get index() {\r\n        const time = this.progress * this.timeRange / 100 - DEFAULT_FRAGMENT;\r\n        if (time <= 0) {\r\n            return 0;\r\n        }\r\n\r\n        return Math.ceil(time / this.fragmentLength);\r\n    }\r\n\r\n    // 数据片段数量\r\n    public get count() {\r\n        if (!this.timeRange) {\r\n            return 0;\r\n        }\r\n\r\n        const time = Math.max(0, this.timeRange - DEFAULT_FRAGMENT);\r\n        return Math.ceil(time / this.fragmentLength) + 1;\r\n    }\r\n\r\n    public destroyed() {\r\n        this.controller && this.controller.abort();\r\n    }\r\n\r\n    // 加载数据\r\n    public loadData() {\r\n        if (!this.timeRange) {\r\n            return Promise.reject('时间范围错误');\r\n        }\r\n\r\n        if (this.timeRange > 10800000) {\r\n            return Promise.reject('选择的时间范围不得超过3小时');\r\n        }\r\n\r\n        this.controller && this.controller.abort(); // 中止现在的所有未完成请求\r\n\r\n        const index = this.index; // 当前进度所处的片段索引\r\n        if (!index) {\r\n            this.fragmentLength = DEFAULT_FRAGMENT;\r\n        }\r\n\r\n        const start = this.date![0] + index * this.fragmentLength; // 开始时间\r\n        const end = Math.min(start + this.fragmentLength, this.date![1]); // 结束时间\r\n\r\n        return this.fetch(start, end)\r\n            .then((datas: ITagInfo[]) => index ? datas : localforage.clear().then(() => datas))\r\n            .then(datas => {\r\n                if (!index) {\r\n                    // 根据第一个片段数据量改变之后片段的时间长度\r\n                    this.fragmentLength = DEFAULT_FRAGMENT * 10000 / (datas.length || 10000);\r\n                }\r\n                this.hasData = true;\r\n\r\n                return this.syncLoad(end, index) // 加载接下来的几个片段\r\n                    .savePosition(index, datas); // 存储当前片段数据\r\n            });\r\n    }\r\n\r\n    // 异步加载数据\r\n    private syncLoad(time: number, index: number) {\r\n        if (!(this.date && this.date[1] != null && time < this.date[1])) {\r\n            return this;\r\n        }\r\n\r\n        this.controller = new AbortController();\r\n        const arr = [];\r\n        for (let i = 1; i <= 6; i++) {\r\n            arr.push(\r\n                this.fetch(\r\n                    time, Math.min(time + this.fragmentLength, this.date[1]),\r\n                    this.controller\r\n                )\r\n                    .then((datas: ITagInfo[]) => {\r\n                        this.savePosition(index + i, datas);\r\n                        this.loadCall && this.loadCall(this, index + i);\r\n                    })\r\n            );\r\n            time += this.fragmentLength;\r\n            if (time >= this.date[1]) {\r\n                break;\r\n            }\r\n        }\r\n        // 加载下一批片段\r\n        Promise.all(arr).then(() => this.syncLoad(time, index + 6)).catch(console.log);\r\n\r\n        return this;\r\n    }\r\n\r\n    // 请求数据\r\n    private fetch(start: number, end: number, controller?: AbortController) {\r\n        const offset = new Date().getTimezoneOffset() * 60000;\r\n        return this.$http\r\n            .post({\r\n                url: '/api/tag/queryTagHistory',\r\n                body: {\r\n                    startTime: new Date(start - offset),\r\n                    endTime: new Date(end - offset),\r\n                    tagNos: this.tagNos\r\n                },\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                controller\r\n            }).then(res => {\r\n                const datas: ITagInfo[] = res.pagedData.datas;\r\n\r\n                return Promise.resolve(datas);\r\n            });\r\n    }\r\n\r\n    // 存储数据\r\n    private async savePosition(index: number, data: ITagInfo[]) {\r\n        try {\r\n            return await localforage.getItem<PositionItem>(index + '');\r\n        } catch (e) {\r\n            const fragment: Fragment = {};\r\n            const offset = new Date().getTimezoneOffset() * 60000;\r\n            data.forEach(v => {\r\n                if (v.position.every(p => +p >= 0)) {\r\n                    (fragment[v.sTagNo] || (fragment[v.sTagNo] = [])).push({\r\n                        x: +v.position[1],\r\n                        y: +v.position[2],\r\n                        z: +v.position[3] || 0,\r\n                        time: new Date((<string>v.time)).getTime() + offset,\r\n                        group: v.sGroupNo\r\n                    });\r\n                }\r\n            });\r\n            return localforage.setItem(index + '', fragment);\r\n        }\r\n    }\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue';\r\nimport Component, { mixins } from 'vue-class-component';\r\nimport { formatTime } from '@/assets/lib/date';\r\nimport ControlMixin, { PositionItem } from '@/mixins/control';\r\nimport { Prop } from 'vue-property-decorator';\r\n\r\ninterface Option {\r\n    label: string;\r\n    value: string;\r\n}\r\n\r\n@Component({\r\n    filters: { formatTime }\r\n})\r\nexport default class Control extends mixins(ControlMixin) {\r\n    @Prop() public readonly showPath!: boolean; // 是否显示轨迹\r\n\r\n    public loading: boolean = false;\r\n    public remoteMethod: ((key: string) => void) | null = null;\r\n    public format: ((value: number) => string) | null = null; // 格式化 tooltip message\r\n    public isPlaying: boolean = false; // 是否正在播放\r\n    public options: Option[] = [];\r\n\r\n    private timer?: number; // 播放定时器\r\n\r\n    public get showPathProxy() {\r\n        return this.showPath;\r\n    }\r\n    public set showPathProxy(visible: boolean) {\r\n        this.$emit('update:showPath', visible);\r\n    }\r\n\r\n    public created() {\r\n        this.format = (value: number) => formatTime(this.timeRange, value);\r\n\r\n        let timer: number = 0;\r\n        this.remoteMethod = (key: string) => {\r\n            if (this.loading) {\r\n                return;\r\n            }\r\n\r\n            clearTimeout(timer);\r\n            if (!key) {\r\n                return (this.options.length = 0);\r\n            }\r\n\r\n            timer = setTimeout(() => {\r\n                this.loading = true;\r\n\r\n                this.$http\r\n                    .get('/api/tag/getall', {\r\n                        pageSize: 100,\r\n                        currentPage: 1,\r\n                        name: key\r\n                    })\r\n                    .then(res => {\r\n                        this.options.length = 0;\r\n                        const icons = new Map<string, string>();\r\n                        res.pagedData.datas.forEach(v => {\r\n                            this.options.push({\r\n                                label: v.name,\r\n                                value: v.tagNo\r\n                            });\r\n                            icons.set(v.tagNo, v.photo);\r\n                        });\r\n\r\n                        this.$emit('set-icons', icons);\r\n                        this.loading = false;\r\n                    })\r\n                    .catch(console.log);\r\n            }, 500);\r\n        };\r\n    }\r\n    public destroyed() {\r\n        this.pause();\r\n    }\r\n    // 选择的标签及日期变化时的回调函数\r\n    public change() {\r\n        this.hasData = this.showPathProxy = false;\r\n        this.progress = 0;\r\n    }\r\n    // 重播放\r\n    public rePlay() {\r\n        this.pause();\r\n        Promise.resolve().then(this.play.bind(this));\r\n    }\r\n    public play() {\r\n        if (this.isPlaying) {\r\n            // ========================暂停\r\n            this.pause(this.progress).$emit('pause');\r\n        } else {\r\n            if (this.hasData) {\r\n                this.isPlaying = true;\r\n                this._play();\r\n            } else if (this.tagNos.length) {\r\n                // =======================重新获取历史记录\r\n\r\n                // 立即进入播放状态, 禁止修改时间及标签\r\n                this.isPlaying = true;\r\n\r\n                this.loadData()\r\n                    .then(this._play.bind(this))\r\n                    .catch((message: string) => {\r\n                        message && this.$message.error(message);\r\n                        this.isPlaying = false;\r\n                    });\r\n            } else {\r\n                this.$message.warning('请选择标签');\r\n            }\r\n        }\r\n    }\r\n\r\n    // 暂停播放\r\n    public pause(progress: number = 0) {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = undefined;\r\n        }\r\n        this.progress = progress;\r\n        this.isPlaying = false;\r\n\r\n        return this;\r\n    }\r\n\r\n    private _play() {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = undefined;\r\n        }\r\n\r\n        let time = Date.now();\r\n        const onPlay = () => {\r\n            const now = Date.now();\r\n            if (this.isPlaying) {\r\n                this.progress += ((now - time) / this.timeRange) * 100;\r\n            }\r\n\r\n            if (this.progress >= 100) {\r\n                this.pause();\r\n            } else {\r\n                this.timer = requestAnimationFrame(onPlay);\r\n            }\r\n\r\n            time = now;\r\n        };\r\n\r\n        onPlay();\r\n        this.$emit('play');\r\n    }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Control.vue?vue&type=template&id=4f4e07ee&\"\nimport script from \"./Control.vue?vue&type=script&lang=ts&\"\nexport * from \"./Control.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Control.vue?vue&type=style&index=0&lang=postcss&module=true&\"\nimport style1 from \"./Control.vue?vue&type=style&index=1&lang=css&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component, { mixins } from 'vue-class-component';\r\nimport { PositionItem, Fragment } from '@/mixins/control';\r\nimport MapMixin from '@/mixins/map';\r\nimport Control from '@/components/Control.vue';\r\nimport localforage from '@/assets/lib/localforage';\r\nimport { Ref } from 'vue-property-decorator';\r\n\r\n@Component({\r\n    components: { 'history-control': Control }\r\n})\r\nexport default class History extends mixins(MapMixin) {\r\n    public date: number[] | null = null; // 选择的时间范围\r\n    public progress: number = 0; // 当前进度\r\n    public loadCall: ((control: Control, index: number) => void) | null = null;\r\n    public isLoading: boolean = false; // 是否当前进度的数据正在加载\r\n\r\n    protected renderTags: Set<string> = new Set(); // 已经在地图上的标签\r\n\r\n    @Ref('control') private readonly control!: Control;\r\n\r\n    private next: PlayRecord = {}; // 下一个数据点\r\n    private moving: Set<string> = new Set(); // 正在移动中的标签\r\n    private fragmentIndex: number = -1; // 当前points所在的片段索引\r\n    private points: Fragment = {}; // 当前进度对应的数据片段\r\n    private icons: Map<string, string> = new Map(); // 标签图标\r\n\r\n    public get timeRange() {\r\n        if (!this.date || this.date.length < 2) {\r\n            return 0;\r\n        }\r\n\r\n        return this.date[1] - this.date[0];\r\n    }\r\n\r\n    public created() {\r\n        // 慢加载完一个数据片段后执行的函数\r\n        this.loadCall = (control: Control, index: number) => {\r\n            if (index === this.fragmentIndex && this.isLoading) {\r\n                this.isLoading = false;\r\n                control.play();\r\n            }\r\n        };\r\n    }\r\n\r\n    public setIcons(icons: Map<string, string>) {\r\n        // 保存已获取过的标签的图标\r\n        icons.forEach((v, k) => this.icons.set(k, v));\r\n    }\r\n\r\n    // 开始播放\r\n    public onPlay() {\r\n        if (!(this.mgr && this.date && this.date.length >= 2)) {\r\n            return;\r\n        }\r\n\r\n        this.getFragment()\r\n            .then(() => {\r\n                this.mgr && this.mgr.remove();\r\n\r\n                // 移除节点是异步操作\r\n                setTimeout(() => {\r\n                    this.next = {};\r\n                    this.moving.clear();\r\n                    this.renderTags.clear();\r\n                }, 100);\r\n            })\r\n            .catch(console.log);\r\n    }\r\n    // 播放中\r\n    public async onProgress() {\r\n        if (this.fragmentIndex < 0) {\r\n            return;\r\n        }\r\n\r\n        const oldFragmentIndex = this.fragmentIndex;\r\n        const oldPoints = this.points;\r\n\r\n        try {\r\n            await this.getFragment();\r\n        } catch (e) {\r\n            return console.log(e);\r\n        }\r\n\r\n        for (const [tagNo, pointsData] of Object.entries(this.points)) {\r\n            if (this.moving.has(tagNo)) {\r\n                continue;\r\n            }\r\n\r\n            Promise.resolve()\r\n                .then(() => {\r\n                    if (!this.mgr) {\r\n                        return Promise.reject('地图不存在');\r\n                    }\r\n\r\n                    return this.parseProgress(\r\n                        pointsData,\r\n                        oldFragmentIndex,\r\n                        oldPoints[tagNo] || [],\r\n                        tagNo\r\n                    );\r\n                })\r\n                .then(({ prev, target, record }) => {\r\n                    // 标签此时不在当前地图\r\n                    if (!this.groups.includes(target.group)) {\r\n                        if (this.mgr) {\r\n                            this.mgr.remove(tagNo); // 移除标签\r\n                            this.mgr.lineMgr.remove(tagNo); // 移除对应的轨迹线\r\n                        }\r\n\r\n                        return this.renderTags.delete(tagNo); // 移除渲染记录\r\n                    }\r\n\r\n                    // ===============================================\r\n                    if (!(prev && this.renderTags.has(tagNo))) {\r\n                        // 将标签添加到地图中\r\n                        this.start(target, tagNo);\r\n                    } else {\r\n                        const time = target.time - prev.time + record.errorTime;\r\n                        this.moveTo(tagNo, target, time).then(() =>\r\n                            this.moving.delete(tagNo)\r\n                        );\r\n                        this.moving.add(tagNo);\r\n                        record.index++;\r\n                        this.next[tagNo] = record;\r\n                    }\r\n                })\r\n                .catch(console.log);\r\n        }\r\n    }\r\n\r\n    // 暂停\r\n    public onPause() {\r\n        this.mgr && this.mgr.stopMoveTo();\r\n    }\r\n\r\n    // 进度更新时获取相关数据点\r\n    private async parseProgress(\r\n        pointsData: PositionItem[],\r\n        oldFragmentIndex: number,\r\n        old: PositionItem[] | undefined,\r\n        tagNo: string\r\n    ): Promise<ProgressData> {\r\n        const record = this.next[tagNo] || {\r\n            index: 0,\r\n            errorTime: 0\r\n        };\r\n\r\n        let target: PositionItem | undefined | null; // 本次数据点\r\n        let prev: PositionItem | undefined | null; // 上一次数据点\r\n        if (oldFragmentIndex === this.fragmentIndex) {\r\n            // ====================================未更换数据片段\r\n            target = pointsData[record.index];\r\n            prev = pointsData[record.index - 1];\r\n        } else {\r\n            // ======================================已更换数据片段\r\n            target = pointsData[0];\r\n            prev = old ? old.pop() : null;\r\n        }\r\n\r\n        if (!target) {\r\n            if (\r\n                !pointsData.length || // 当前数据片段数据为空\r\n                this.control.count <= this.fragmentIndex + 1 // 播放完毕\r\n            ) {\r\n                this.mgr && this.mgr.remove(tagNo);\r\n                return Promise.reject();\r\n            } else {\r\n                // =========================时间点落在一个数据片段最后一个数据及下一个数据片段开始之间\r\n                try {\r\n                    const data = await localforage.getItem<Fragment>(\r\n                        this.fragmentIndex + 1 + ''\r\n                    );\r\n\r\n                    return this.parseProgress(\r\n                        data[tagNo] || [],\r\n                        oldFragmentIndex,\r\n                        old,\r\n                        tagNo\r\n                    );\r\n                } catch (e) {\r\n                    return this.showLoading();\r\n                }\r\n            }\r\n        }\r\n\r\n        return { target, prev, record };\r\n    }\r\n\r\n    private start(target: PositionItem, tagNo: string) {\r\n        if (!(this.mgr && this.date && this.date.length >= 2)) {\r\n            return;\r\n        }\r\n\r\n        const playTime = (this.timeRange * this.progress) / 100;\r\n        const startTime = target.time - this.date[0];\r\n\r\n        if (playTime >= startTime) {\r\n            this.mgr.addImage(\r\n                {\r\n                    x: target.x,\r\n                    y: target.y,\r\n                    height: 0.5,\r\n                    url: this.icons.get(tagNo),\r\n                    size: 48\r\n                },\r\n                tagNo,\r\n                undefined,\r\n                false\r\n            );\r\n\r\n            this.renderTags.add(tagNo);\r\n            this.next[tagNo] = {\r\n                index: 1,\r\n                errorTime: 0\r\n            };\r\n        }\r\n    }\r\n\r\n    // 获取数据片段\r\n    private getFragment() {\r\n        return Promise.resolve()\r\n            .then(() => {\r\n                const fragmentIndex = this.control.index;\r\n\r\n                if (fragmentIndex !== this.fragmentIndex) {\r\n                    this.fragmentIndex = fragmentIndex;\r\n                    return localforage.getItem<Fragment>(fragmentIndex + '');\r\n                }\r\n\r\n                return this.points;\r\n            })\r\n            .then(points => (this.points = points))\r\n            .catch(this.showLoading.bind(this));\r\n    }\r\n\r\n    // 数据加载中...\r\n    private showLoading() {\r\n        this.isLoading = true;\r\n        this.control.pause();\r\n\r\n        return Promise.reject('loading...');\r\n    }\r\n}\r\n\r\ninterface PlayRecord {\r\n    [x: string]: PlayRecordItem;\r\n}\r\ninterface PlayRecordItem {\r\n    index: number;\r\n    errorTime: number;\r\n}\r\n\r\ninterface ProgressData {\r\n    record: PlayRecordItem;\r\n    target: PositionItem;\r\n    prev?: PositionItem | null;\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./History.vue?vue&type=template&id=2b13f1b6&\"\nimport script from \"./History.vue?vue&type=script&lang=ts&\"\nexport * from \"./History.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./History.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"padding-left\":\"5%\",\"padding-top\":\"3%\"}},[_vm._m(0),_c('map-form',{ref:\"form\",on:{\"submit\":_vm.onSubmit}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h3',{staticStyle:{\"color\":\"#009688\"}},[_vm._v(\"\\n        地图添加\\n        \"),_c('span',{staticStyle:{\"font-size\":\"12px\"}},[_vm._v(\"\\n            (注意: 如果地图文件是fengmap文件, 需将其对应的主题文件夹放入\\n            \\\"/data/theme/\\\" 目录)\\n        \")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component from 'vue-class-component';\r\nimport Vue from 'vue';\r\nimport MapEdit from '@/components/edit/MapEdit.vue';\r\n\r\n@Component({\r\n    components: {\r\n        'map-form': MapEdit\r\n    }\r\n})\r\nexport default class MapAdd extends Vue {\r\n    public onSubmit(data: any) {\r\n        this.$http\r\n            .post('/api/map/upload/mapfile', {\r\n                file: data.map,\r\n                mapName: data.map.name.split('.')[0] || 'map'\r\n            })\r\n            .then((res: ResponseData) => {\r\n                const { minX, maxX, minY, maxY } = data;\r\n\r\n                return this.$http.post({\r\n                    url: '/api/map/addMap',\r\n                    body: {\r\n                        filepath: res.resultMap.mapUrl,\r\n                        name: data.name,\r\n                        groupCode: JSON.stringify(data.groupCode),\r\n                        margin: JSON.stringify([\r\n                            [minX, minY],\r\n                            [minX, maxY],\r\n                            [maxX, maxY],\r\n                            [maxX, minY],\r\n                            [data.width, data.height]\r\n                        ])\r\n                    },\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n            })\r\n            .then(() => {\r\n                this.$message.success('添加成功');\r\n                (<MapEdit>this.$refs.form).reset();\r\n            })\r\n            .catch(console.log);\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapAdd.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapAdd.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MapAdd.vue?vue&type=template&id=08ad720c&\"\nimport script from \"./MapAdd.vue?vue&type=script&lang=ts&\"\nexport * from \"./MapAdd.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { FengMapMgr } from '@/assets/map/fengmap';\r\nimport { PIXIMgr } from '@/assets/map/pixi';\r\nimport { ZONE_SEPARATOR } from '@/constant';\r\n\r\n@Component\r\nexport default class DisplayMixin extends Vue {\r\n    public mgr?: FengMapMgr | PIXIMgr;\r\n    public operation: any[] = [\r\n        {\r\n            type: { default: 'primary' },\r\n            name: 'display',\r\n            desc: { default: '显示' }\r\n        }\r\n    ];\r\n\r\n    /**\r\n     * 切换区域显示\r\n     */\r\n    public display(row: IZone, index: number, isDel?: boolean) {\r\n        const operation = this.getOperation();\r\n        const i = operation.findIndex(v => v.name === 'display');\r\n        if (i > -1) {\r\n            const op = operation[i];\r\n            if (op.type[row.id] || isDel) {\r\n                op.type[row.id] = undefined;\r\n                this.removeZone(row);\r\n            } else {\r\n                op.type[row.id] = 'success';\r\n                this.showZone(row);\r\n            }\r\n            op.desc[row.id] = op.desc[row.id] || isDel ? undefined : '隐藏';\r\n\r\n            this.$set(operation, i, op);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    protected getOperation() {\r\n        return this.operation;\r\n    }\r\n\r\n    protected removeZone(row: IZone) {\r\n        this.mgr && this.mgr.remove(row.id + ZONE_SEPARATOR + row.name);\r\n    }\r\n\r\n    protected showZone(row: IZone) {\r\n        this.mgr && this.mgr.zoneOpen(row);\r\n    }\r\n}\r\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=0&lang=postcss&module=true&\"","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"root\",staticClass:\"map-box\",on:{\"click\":_vm.hiddenCover}},[_c('div',{staticClass:\"map-tool-bar flex-center\",class:_vm.$style['tool-bar']},[_c('map-select',{on:{\"selectmap\":_vm.selectMap}}),_c('div',{staticClass:\"flex-center\"},[_c('el-input',{staticStyle:{\"max-width\":\"350px\",\"margin-right\":\"10px\"},attrs:{\"placeholder\":(\"请输入\" + (_vm.isName ? '标签名' : '标签号')),\"type\":\"search\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.find($event)}},model:{value:(_vm.findTarget),callback:function ($$v) {_vm.findTarget=$$v},expression:\"findTarget\"}},[_c('el-select',{staticStyle:{\"width\":\"100px\"},attrs:{\"slot\":\"prepend\",\"popper-append-to-body\":false},slot:\"prepend\",model:{value:(_vm.isName),callback:function ($$v) {_vm.isName=$$v},expression:\"isName\"}},[_c('el-option',{attrs:{\"value\":0,\"label\":\"标签号\"}}),_c('el-option',{attrs:{\"value\":1,\"label\":\"标签名\"}})],1)],1)],1)],1),_c('el-switch',{class:_vm.$style.switch,attrs:{\"active-text\":\"显示轨迹\",\"inactive-text\":\"隐藏轨迹\",\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},model:{value:(_vm.showPath),callback:function ($$v) {_vm.showPath=$$v},expression:\"showPath\"}}),_c('div',{ref:\"map\",staticStyle:{\"height\":\"100%\",\"overflow\":\"hidden\"}}),_c('div',{class:_vm.$style.tools},_vm._l((_vm.tools),function(v,i){return _c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(v.display && i !== 3),expression:\"v.display && i !== 3\"}],key:i,class:_vm.$style['tool-item'],attrs:{\"type\":v.active ? 'primary' : ''},on:{\"click\":function($event){$event.stopPropagation();return _vm.swithDisplay(i)}}},[_vm._v(\"\\n            \"+_vm._s(v.name)+\"\\n        \")])}),1),_c('transition',{attrs:{\"name\":\"el-zoom-in-bottom\"}},[(_vm.tools[4].active)?_c('Census',{attrs:{\"zones\":_vm._f(\"mode\")(_vm.zones,_vm.zoneMode.group),\"censusTags\":_vm.census,\"censusChange\":_vm.censusChange},on:{\"close\":function($event){_vm.tools[4].active = false}}}):_vm._e()],1),_c('transition',{attrs:{\"name\":\"el-fade-in-linear\"}},[(_vm.tools[2].active)?_c('Zone',{staticStyle:{\"opacity\":\"0.7\"},attrs:{\"zones\":_vm.zones,\"zoneOp\":_vm.operation}}):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\n\r\n@Component\r\nexport default class EventMixin extends Vue {\r\n    private remove?: () => void;\r\n\r\n    public destroyed() {\r\n        this.remove && this.remove();\r\n    }\r\n\r\n    protected on(name: string | symbol | number, handler: (...args: any[]) => any) {\r\n        this.remove = () => this.$event.off(name, handler);\r\n        this.$event.on(name, handler);\r\n    }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"click\":function($event){$event.stopPropagation();}}},[_c('el-card',{ref:\"table\",staticClass:\"card\",class:_vm.$style.box},[_c('el-select',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"multiple\":\"\",\"placeholder\":\"区域类型\",\"size\":\"mini\"},on:{\"change\":function($event){return _vm.getData(1, _vm.pageSize)}},model:{value:(_vm.modes),callback:function ($$v) {_vm.modes=$$v},expression:\"modes\"}},_vm._l((_vm.modeDescript),function(v,i){return _c('el-option',{directives:[{name:\"show\",rawName:\"v-show\",value:(Object.values(_vm.zoneMode).includes(i)),expression:\"Object.values(zoneMode).includes(i)\"}],key:v,attrs:{\"label\":v,\"value\":i}})}),1),_c('app-table',{attrs:{\"max-height\":500,\"table-data\":_vm.tableData,\"col-cfg\":_vm.colCfg,\"total-count\":_vm.totalCount,\"op\":_vm.zoneOp,\"isSmall\":true,\"noPrint\":true},on:{\"switch\":_vm.display,\"updateData\":_vm.getData}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component, { mixins } from 'vue-class-component';\r\nimport TableMixin from '../../mixins/table';\r\nimport { Prop } from 'vue-property-decorator';\r\nimport { FengMapMgr } from '../../assets/map/fengmap';\r\nimport { State } from 'vuex-class/lib/bindings';\r\nimport { ZoneMode } from '@/store';\r\nimport DisplayMixin from '../../mixins/zone/display';\r\n\r\n@Component\r\nexport default class Zone extends mixins(TableMixin, DisplayMixin) {\r\n    @State public readonly zoneMode!: ZoneMode;\r\n    @State public readonly modeDescript!: string[];\r\n\r\n    @Prop() public readonly zones!: IZone[];\r\n    @Prop() public readonly zoneOp!: any[];\r\n\r\n    public modes: number[] = [];\r\n\r\n    public colCfg: any[] = [\r\n        { prop: 'name', label: '区域' },\r\n        { prop: 'status', label: '状态' }\r\n    ];\r\n\r\n    public get mgr() {\r\n        return this.$parent && Reflect.get(this.$parent, 'mgr');\r\n    }\r\n\r\n    protected getOperation() {\r\n        return this.zoneOp || [];\r\n    }\r\n\r\n    protected async fetch(page: number, pageSize: number) {\r\n        let zones = this.zones;\r\n        if (this.modes.length) {\r\n            zones = this.zones.filter(v => this.modes.includes(v.mode));\r\n        }\r\n        const list = zones.slice((page - 1) * pageSize, page * pageSize);\r\n\r\n        return {\r\n            count: zones.length,\r\n            data: list.map(v => {\r\n                const tmp = <IZone & { status: string }>{ ...v };\r\n                tmp.status = v.enable ? '开启' : '关闭';\r\n                tmp.position =\r\n                    typeof v.position === 'string'\r\n                        ? JSON.parse(v.position)\r\n                        : v.position;\r\n\r\n                return tmp;\r\n            })\r\n        };\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Zone.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Zone.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Zone.vue?vue&type=template&id=1eb5d16d&\"\nimport script from \"./Zone.vue?vue&type=script&lang=ts&\"\nexport * from \"./Zone.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Zone.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"click\":function($event){$event.stopPropagation();}}},[_c('el-card',{ref:\"table\",staticClass:\"card\",class:_vm.$style.box},[_c('app-table',{attrs:{\"max-height\":500,\"table-data\":_vm.tableData,\"col-cfg\":_vm.colCfg,\"total-count\":_vm.totalCount,\"op\":[{ type: 'danger', name: 'switch', desc: '切换显示' }],\"isSmall\":true,\"noPrint\":true},on:{\"switch\":_vm.switchZone,\"updateData\":_vm.getData}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component, { mixins } from 'vue-class-component';\r\nimport TableMixin from '../../mixins/table';\r\nimport { Prop } from 'vue-property-decorator';\r\nimport { FengMapMgr } from '../../assets/map/fengmap';\r\nimport { PIXIMgr } from '@/assets/map/pixi';\r\n\r\n@Component\r\nexport default class Group extends mixins(TableMixin) {\r\n    @Prop() public group!: { [x: string]: IBaseStation[] };\r\n\r\n    public colCfg: any[] = [{ prop: 'id', label: '分组' }];\r\n\r\n    public switchZone(row: { id: string; children: IBaseStation[] }) {\r\n        if (this.$parent) {\r\n            const mgr: FengMapMgr | PIXIMgr = Reflect.get(this.$parent, 'mgr');\r\n            if (mgr) {\r\n                row.children.forEach(v => mgr.show(v.baseNo));\r\n            }\r\n        }\r\n    }\r\n\r\n    protected async fetch(page: number, pageSize: number) {\r\n        const list = Object.entries(this.group).slice(\r\n            (page - 1) * pageSize,\r\n            page * pageSize\r\n        );\r\n\r\n        return {\r\n            count: list.length,\r\n            data: list.map(v => ({\r\n                id: v[0],\r\n                children: v[1]\r\n            }))\r\n        };\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Group.vue?vue&type=template&id=4382ec3a&\"\nimport script from \"./Group.vue?vue&type=script&lang=ts&\"\nexport * from \"./Group.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Group.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"click\":function($event){$event.stopPropagation();}}},[_c('el-card',{class:_vm.$style.box},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"标签统计\")]),_c('el-button',{staticStyle:{\"float\":\"right\",\"padding\":\"3px 0\"},attrs:{\"type\":\"text\",\"icon\":\"el-icon-close\"},on:{\"click\":function($event){return _vm.$emit('close')}}})],1),_c('el-form',{staticStyle:{\"margin\":\"0 auto 30px\"}},[_c('el-form-item',{attrs:{\"label\":\"选择区域\"}},[_c('el-select',{attrs:{\"filterable\":\"\"},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}},_vm._l((_vm.zones),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.base_no_1}})}),1)],1)],1),_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('div',{staticStyle:{\"border-bottom\":\"1px solid #ccc\",\"margin-bottom\":\"5px\"}},[_vm._v(\"\\n                当前地图标签数量: \"+_vm._s(_vm.allCount)+\"\\n            \")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!!_vm.info),expression:\"!!info\"}],staticStyle:{\"margin-top\":\"10px\"}},[_c('span',[_vm._v(_vm._s((_vm.info || {}).name)+\"标签数量: \")]),_c('span',[_vm._v(\"\\n                    \"+_vm._s((_vm.info || {}).true)+\"\\n                    \")])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.info && _vm.value !== ''),expression:\"!info && value !== ''\"}]},[_c('i',{staticClass:\"el-icon-loading\",staticStyle:{\"font-size\":\"24px\"}})])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { Prop, Watch } from 'vue-property-decorator';\r\n\r\n@Component\r\nexport default class Census extends Vue {\r\n    @Prop() public readonly zones!: IZone[];\r\n    @Prop() public readonly censusTags!: Map<string, Set<string>>;\r\n    @Prop() public readonly censusChange!: number;\r\n\r\n    public value: string = '';\r\n    public allCount: number = 0; // 当前地图拥有的标签数\r\n    public info: any = null;\r\n\r\n    public created() {\r\n        this.allCount = this.getAllCount();\r\n    }\r\n\r\n    @Watch('censusChange')\r\n    @Watch('value')\r\n    public getInfo() {\r\n        if (this.zones && this.censusTags) {\r\n            this.allCount = this.getAllCount();\r\n\r\n            const zone = this.zones.find(v => v.baseNo1 === this.value);\r\n            if (zone) {\r\n                // this.$http\r\n                //     .get('/api/tag/getall', {\r\n                //         currentPage: 1,\r\n                //         pageSize: 1_0000_0000,\r\n                //         zone: zone.id\r\n                //     })\r\n                //     .then(res => {\r\n                //         const list = (<ITag[]>res.pagedData.datas).filter(v =>\r\n                //             (this.censusTags.get(this.value) || new Set()).has(\r\n                //                 v.tagNo\r\n                //             )\r\n                //         );\r\n\r\n                //         this.info = {\r\n                //             name:\r\n                //                 zone.name +\r\n                //                 (zone.name.endsWith('区域') ? '' : '区域'),\r\n                //             true: list.length,\r\n                //             should: res.pagedData.datas.length\r\n                //         };\r\n                //     });\r\n                return (this.info = {\r\n                    name:\r\n                        zone.name + (zone.name.endsWith('区域') ? '' : '区域'),\r\n                    true: (this.censusTags.get(this.value) || new Set()).size\r\n                });\r\n            }\r\n\r\n            this.info = null;\r\n        }\r\n    }\r\n\r\n    private getAllCount() {\r\n        return Array.from(this.censusTags.values()).flatMap(v => [...v]).length;\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Census.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Census.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Census.vue?vue&type=template&id=6f9534e0&\"\nimport script from \"./Census.vue?vue&type=script&lang=ts&\"\nexport * from \"./Census.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Census.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\r\nimport { arr2obj, getIp, getConfig } from '@/assets/utils/util';\r\nimport Component from 'vue-class-component';\r\n\r\n@Component\r\nexport class WebSocketInit extends Vue {\r\n    protected groups: string[] = [];\r\n    protected tagAll!: { [x: string]: ITag }; // 标签\r\n\r\n    private ws: WebSocket[] = [];\r\n\r\n    public created() {\r\n        // 获取所有标签数据\r\n        this.tagAll = {};\r\n        this.$http.get('/api/tag/getall', {\r\n            currentPage: 1,\r\n            pageSize: 1_0000_0000\r\n        })\r\n            .then(res => this.tagAll = arr2obj(res.pagedData.datas, 'tagNo', false))\r\n            .catch(() => console.log);\r\n    }\r\n\r\n    public beforeDestroy() {\r\n        this.closeWebSocket();\r\n        this.tagAll = {};\r\n    }\r\n\r\n    protected initWebSocket() {\r\n        this.closeWebSocket();\r\n\r\n        const ip = getIp();\r\n        if (!ip) {\r\n            return;\r\n        }\r\n\r\n        // ==============================收到标签信息后的处理\r\n        const handler = (event: MessageEvent) => {\r\n            const data: ITagInfo = JSON.parse(event.data);\r\n            if (this.tagAll[data.sTagNo] && data.position.every(v => +v >= 0)) {\r\n                this.doMonitor(data);\r\n            }\r\n        };\r\n        // ======================================\r\n        const wsUrl = getConfig<string>('websoket.position', 'ws://#{ip}/realtime/position');\r\n        const ws = new WebSocket(`${wsUrl.replace('#{ip}', ip)}/${this.groups.join(',')}`);\r\n        ws.onmessage = handler;\r\n        this.ws = [ws];\r\n\r\n        // this.ws = this.groups.map(k => {\r\n        //     const ws = new WebSocket(`${wsUrl.replace('#{ip}', ip)}/${k}`);\r\n        //     ws.onmessage = handler;\r\n        //     return ws;\r\n        // });\r\n    }\r\n\r\n    protected doMonitor(tag: ITagInfo) {\r\n        //\r\n    }\r\n\r\n    private closeWebSocket() {\r\n        let ws = this.ws.pop();\r\n        while (ws) {\r\n            ws.close();\r\n            ws.onmessage = null;\r\n            ws = this.ws.pop();\r\n        }\r\n\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * 绘制绑定为一组的标签间的线\r\n */\r\nimport Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { FengMapMgr } from '@/assets/map/fengmap';\r\nimport { PIXIMgr } from '@/assets/map/pixi';\r\nimport { NOTIFY_KEY, MISS_MSG } from '@/constant';\r\n\r\n@Component\r\nexport default class Link extends Vue {\r\n    public mgr?: FengMapMgr | PIXIMgr;\r\n\r\n    private bindings = new Map<string, number[]>();\r\n    private points = new Map<number, Record<string, Vector3>>(); // 记录的坐标点\r\n\r\n    private missHandler?: (data: IAlarm) => void;\r\n\r\n    public created() {\r\n        // TODO 从服务器获取数据\r\n        const testData = [\r\n            {\r\n                id: 1,\r\n                tags: ['00000004', '00000005']\r\n            },\r\n            {\r\n                id: 2,\r\n                tags: ['00000001', '00000008']\r\n            },\r\n            {\r\n                id: 3,\r\n                tags: ['00000001', '00000011']\r\n            },\r\n        ];\r\n        this.normalize(testData);\r\n\r\n        // 绑定信号丢失时移除关联线的处理函数\r\n        this.missHandler = (data: IAlarm) => {\r\n            if (data.alarmMsg === MISS_MSG) {\r\n                this.link(data.tagNo);\r\n            }\r\n        };\r\n        this.$event.on(NOTIFY_KEY, this.missHandler);\r\n    }\r\n\r\n    public destroyed() {\r\n        this.missHandler && this.$event.off(NOTIFY_KEY, this.missHandler);\r\n    }\r\n\r\n    protected link(tagNo: string, coords?: Vector3) {\r\n        const points = this.getAngRecordPoints(tagNo, coords);\r\n\r\n        points.forEach(v => {\r\n            if (this.mgr) {\r\n                for (const [k, p] of Object.entries(v)) {\r\n                    const name = 'link_' + k;\r\n                    this.mgr.lineMgr.remove(name);\r\n\r\n                    if (p.length < 2) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (p.length > 2) {\r\n                        p.push(p[0]);\r\n                    }\r\n\r\n                    this.mgr.addLine(\r\n                        p,\r\n                        {\r\n                            lineType: fengmap.FMLineType.FULL,\r\n                            lineWidth: 2,\r\n                            smooth: false,\r\n                            color: '#e00',\r\n                            colorNum: 0xee0000\r\n                        },\r\n                        name\r\n                    );\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private getAngRecordPoints(tagNo: string, coords?: Vector3) {\r\n        const bindings = this.bindings.get(tagNo);\r\n\r\n        if (!bindings) {\r\n            return [];\r\n        }\r\n\r\n        return bindings.map(flag => {\r\n            const points = this.points.get(flag) || {};\r\n            coords ? (points[tagNo] = coords) : Reflect.deleteProperty(points, tagNo);\r\n            this.points.set(flag, points);\r\n\r\n            return { [flag]: Object.values(points) };\r\n        });\r\n    }\r\n\r\n    private normalize(datas: IBingdings[]) {\r\n        datas.forEach(v => {\r\n            const tags: string[] = Array.isArray(v.tags) ? v.tags : JSON.parse(v.tags);\r\n\r\n            tags.forEach(tagNo => {\r\n                const tmp = this.bindings.get(tagNo) || [];\r\n                tmp.push(v.id);\r\n                this.bindings.set(tagNo, tmp);\r\n            });\r\n        });\r\n    }\r\n}\r\n","import Component, { mixins } from 'vue-class-component';\r\nimport MapMixin from '../map';\r\nimport { WebSocketInit } from './websocket';\r\nimport { arr2obj, getConfig } from '@/assets/utils/util';\r\nimport { LOSS_TIME, MODIFY_TAG_ICON, MISS } from '@/constant';\r\nimport Link from '../map/link';\r\nimport { getCustomInfo } from '@/assets/map/common';\r\n\r\ninterface Pop {\r\n    close(immediately?: boolean): void | boolean;\r\n    update(iHeartRate: number): boolean;\r\n}\r\n\r\n@Component\r\nexport default class MonitorMixin extends mixins(MapMixin, WebSocketInit, Link) {\r\n    public renderTags: Record<string, number> = {}; // 已经在地图上的标签, {tagNo: timer}\r\n\r\n    private pops: Map<string, Pop> = new Map(); // 关闭标签信息的函数\r\n    private readonly moveTime = 1 / getConfig<number>('SECOND_COUNT', 1);\r\n\r\n    public created() {\r\n        this.$event.on(MODIFY_TAG_ICON, (tagNo: string, img: string) => this.mgr && this.mgr.modifyImg(tagNo, img));\r\n    }\r\n\r\n    public beforeDestroy() {\r\n        this.$event.off(MODIFY_TAG_ICON);\r\n\r\n        Object.values(this.renderTags).forEach(clearTimeout);\r\n        this.pops.forEach(v => v.close());\r\n    }\r\n\r\n    // 在地图上显示标签信息\r\n    protected showInfo(key: string, isName: number) {\r\n        if (this.mgr && !this.pops.has(key)) {\r\n            const tags = this.mgr.find(key, !!isName);\r\n\r\n            if (tags.length) {\r\n                tags.forEach((v: any) => {\r\n                    const name = getCustomInfo<ITag>(v, 'info').name;\r\n                    name && this.pops.set(name, this.mgr!.addPopInfo(v));\r\n                });\r\n            } else {\r\n                this.$message.info(`未找到标签${key}为${key}的标签`);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected bindEvents() {\r\n        this.mgr!.on('loadComplete', this.mapCreated.bind(this));\r\n\r\n        this.mgr!.on('mapClickNode', (event: FMMapClickEvent) => {\r\n            if (this.mgr) {\r\n                const tagNo = getCustomInfo<ITag>(event.target, 'info').tagNo;\r\n                if (event.nodeType === fengmap.FMNodeType.IMAGE_MARKER && tagNo) {\r\n                    if (!this.pops.has(tagNo)) {\r\n                        this.pops.set(tagNo, this.mgr.addPopInfo(<any>event.target));\r\n                    }\r\n                } else {\r\n                    for (const [k, p] of this.pops.entries()) {\r\n                        p.close() && this.pops.delete(k);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    protected afterMapCreated() {\r\n        // 其他地图创建完成后的操作\r\n    }\r\n    protected doCensus(tag: ITagInfo | string) {\r\n        //\r\n    }\r\n\r\n    // 获取标签位置信息后的处理函数\r\n    protected doMonitor(tag: ITagInfo) {\r\n        if (!this.mgr) {\r\n            return console.log('获取地图失败!!');\r\n        }\r\n\r\n        const tagNo = tag.sTagNo;\r\n        const timer = this.renderTags[tagNo];\r\n        const coord: Vector3 = {\r\n            x: +tag.position[0],\r\n            y: +tag.position[1],\r\n            z: 1\r\n        };\r\n\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n\r\n            const update = () => {\r\n                const p = this.pops.get(tagNo);\r\n                if (p && p.update) {\r\n                    p.update(tag.iHeartRate) || this.pops.delete(tagNo);\r\n                }\r\n            };\r\n\r\n            if (+tag.position[2] >= 1000) {\r\n                this.exitAnimation(tagNo);\r\n                update();\r\n            } else {\r\n                this.moveTo(tagNo, coord, this.moveTime, update);\r\n            }\r\n\r\n        } else {\r\n            this.addTag(tagNo, coord);\r\n            this.renderTags[tagNo] = 1;\r\n        }\r\n\r\n        if (!tag.static) {\r\n            // 长时间未收到信号, 将标签号推入信号丢失队列\r\n            this.renderTags[tagNo] = setTimeout(this.miss.bind(this, tagNo), LOSS_TIME);\r\n        }\r\n\r\n        // 统计(添加对应统计信息)\r\n        this.doCensus(tag);\r\n    }\r\n\r\n    // 信号丢失报警循环\r\n    private miss(tagNo: string) {\r\n        this.$event.emit(MISS, tagNo);\r\n\r\n        if (this.mgr) {\r\n            this.renderTags[tagNo] = -1; // 标记标签已丢失\r\n\r\n            this.mgr.show(tagNo, false); // 隐藏标签\r\n            this.mgr.lineMgr.remove(tagNo); // 移除轨迹线\r\n            this.doCensus(tagNo); // 更新统计数据(移除对应统计信息)\r\n\r\n            // 移除信息框\r\n            if (this.pops.has(tagNo)) {\r\n                (<Pop>this.pops.get(tagNo)).close(true);\r\n                this.pops.delete(tagNo);\r\n            }\r\n        }\r\n    }\r\n\r\n    private mapCreated() {\r\n        // 清空已显示的标签的记录\r\n        Object.values(this.renderTags).forEach(clearTimeout);\r\n        this.renderTags = {};\r\n\r\n        // 移除所有信息窗\r\n        this.pops.forEach(v => v.close());\r\n        this.pops.clear();\r\n\r\n        // 移除路径\r\n        this.showPath = false;\r\n\r\n        // 渲染基站\r\n        this.tagAnchor().then(data => Reflect.set(this, 'groupData', arr2obj(data, 'groupCode')));\r\n\r\n        this.afterMapCreated();\r\n    }\r\n\r\n    private addTag(tagNo: string, coord: Vector3) {\r\n        let ids: number[] = [];\r\n        try {\r\n            ids = (<any>this.mgr!.map).groupIDs || [];\r\n        } catch (e) {\r\n            // 地图初始化未完成\r\n            return;\r\n        }\r\n\r\n        // 第一次收到信号\r\n        const tagData: ITag = this.tagAll[tagNo];\r\n        this.addIcon(ids[0] || 0, {\r\n            ...tagData,\r\n            ...coord,\r\n            name: tagNo,\r\n            tagName: tagData.name,\r\n        });\r\n    }\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Component, { mixins } from 'vue-class-component';\r\nimport TableMixin from '@/mixins/table';\r\nimport EventMixin from '@/mixins/event';\r\n\r\nimport Zone from '@/components/monitor/Zone.vue';\r\nimport Group from '@/components/monitor/Group.vue';\r\nimport Census from '@/components/monitor/Census.vue';\r\nimport MonitorMixin from '@/mixins/monitor';\r\nimport { ZoneMode } from '@/store';\r\nimport { State } from 'vuex-class/lib/bindings';\r\nimport { Ref, Watch } from 'vue-property-decorator';\r\nimport { PIXIMgr } from '@/assets/map/pixi';\r\nimport { RESIZE } from '@/constant';\r\nimport { Async } from '../../assets/utils/util';\r\n\r\n@Component({\r\n    components: {\r\n        Zone,\r\n        Group,\r\n        Census\r\n    },\r\n    filters: {\r\n        mode(datas: IZone[], mode: number) {\r\n            return datas.filter(v => v.mode === mode);\r\n        }\r\n    }\r\n})\r\nexport default class Monitor extends mixins(\r\n    MonitorMixin,\r\n    TableMixin,\r\n    EventMixin\r\n) {\r\n    @State public readonly zoneMode!: ZoneMode;\r\n\r\n    public groupData: { [x: string]: IBaseStation[] } = {}; // 基站分组\r\n    public zones: IZone[] = []; // 区域列表\r\n    public operation: any[] = [\r\n        {\r\n            type: { default: 'primary' },\r\n            name: 'display',\r\n            desc: { default: '显示' }\r\n        }\r\n    ];\r\n\r\n    // 右下工具栏列表\r\n    public tools: ToolItem[] = [\r\n        { name: '2D', active: true, display: true },\r\n        { name: '3D', active: false, display: false },\r\n        { name: '区域列表', active: false, display: true },\r\n        { name: '分组列表', active: false, display: true },\r\n        { name: '统计', active: false, display: true }\r\n    ];\r\n    public isFullScreen: boolean = false;\r\n    public findTarget: string = ''; // 查询标签的标签号\r\n    public isName: number = 0; // 是否通过标签名查询标签\r\n\r\n    public censusChange: number = 0; // 用于触发响应（当前vue版本不支持Map及Set的数据响应）\r\n    private censusTags = new Map<string, Set<string>>(); // 分组统计\r\n    private tagGroup = new Map<string, string>(); // tag-group映射\r\n    private time?: number; // 统计刷新时间戳\r\n\r\n    @Ref('root') private readonly root!: HTMLDivElement;\r\n\r\n    public get census() {\r\n        // ===========================触发响应\r\n        const x = this.censusChange;\r\n        console.log(x);\r\n        // =============================\r\n\r\n        return this.censusTags;\r\n    }\r\n\r\n    public created() {\r\n        this.on(RESIZE, () => {\r\n            this.isFullScreen = !!document.fullscreenElement;\r\n\r\n            if (this.container && this.mgr instanceof PIXIMgr) {\r\n                this.mgr.map.resize(\r\n                    this.container.offsetWidth,\r\n                    this.container.offsetHeight\r\n                );\r\n            }\r\n        });\r\n    }\r\n\r\n    // ==================================dom事件\r\n    // 切换弹窗的显示\r\n    public swithDisplay(i: number) {\r\n        const toolItem = this.tools[i];\r\n        if (i < 2) {\r\n            if (toolItem.active) {\r\n                return;\r\n            }\r\n\r\n            const otherMode = this.tools[i ? 0 : 1];\r\n            otherMode.active = !otherMode.active;\r\n\r\n            if (this.mgr) {\r\n                this.mgr.switchViewMode(\r\n                    i ? fengmap.FMViewMode.MODE_3D : fengmap.FMViewMode.MODE_2D\r\n                );\r\n            }\r\n        }\r\n\r\n        toolItem.active = !toolItem.active;\r\n        if (i === 2 || i === 3) {\r\n            const other = this.tools[i === 2 ? 3 : 2];\r\n            if (toolItem.active) {\r\n                other.active = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 隐藏所有弹窗\r\n    public hiddenCover() {\r\n        for (let i = 2; i < this.tools.length; i++) {\r\n            this.tools[i].active = false;\r\n        }\r\n    }\r\n\r\n    // 查询标签\r\n    public find() {\r\n        if (!this.findTarget) {\r\n            return this.$message.warning(\r\n                '请输入' + this.isName ? '标签名' : '标签号'\r\n            );\r\n        }\r\n\r\n        this.showInfo(this.findTarget, this.isName);\r\n        this.findTarget = '';\r\n    }\r\n\r\n    public fullScreen() {\r\n        document.fullscreenElement\r\n            ? document.exitFullscreen()\r\n            : this.root && this.root.requestFullscreen();\r\n    }\r\n    // ==================================\r\n    protected initData() {\r\n        this.initWebSocket();\r\n\r\n        this.tools[0].active = true;\r\n        this.tools[1].active = false;\r\n\r\n        this.findTarget = '';\r\n        for (let i = 2; i < this.tools.length; i++) {\r\n            this.tools[i].active = false;\r\n        }\r\n    }\r\n\r\n    @Async()\r\n    protected async afterMapCreated() {\r\n        this.tools[1].display = !!this.mgr && this.mgr.has3D;\r\n\r\n        this.zones = (await this.$http.get('/api/zone/getall', {\r\n            currentPage: 1,\r\n            pageSize: 1_0000_0000,\r\n            mapId: <number>this.mapId\r\n        })).pagedData.datas;\r\n    }\r\n\r\n    protected doCensus(tag: ITagInfo | string) {\r\n        const tagNo = (<ITagInfo>tag).sTagNo || <string>tag;\r\n        const group = this.tagGroup.get(tagNo);\r\n\r\n        let hasUpdate = false; // 是否有更新\r\n        if (group) {\r\n            const set = this.censusTags.get(group);\r\n            hasUpdate = !!(set && set.delete(tagNo));\r\n        }\r\n\r\n        if (typeof tag !== 'string') {\r\n            const set = this.censusTags.get(tag.sGroupNo) || new Set();\r\n            const oldSize = set.size;\r\n            set.add(tagNo);\r\n\r\n            hasUpdate = hasUpdate || oldSize !== set.size;\r\n            this.censusTags.set(tag.sGroupNo, set);\r\n            this.tagGroup.set(tagNo, tag.sGroupNo);\r\n        }\r\n\r\n        if (hasUpdate) {\r\n            const now = Date.now();\r\n            if (!this.time || now - this.time >= 1000) {\r\n                this.censusChange = this.censusChange ? 0 : 1;\r\n                this.time = now;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ===========================================\r\n\r\ninterface ToolItem {\r\n    name: string; // 显示文字\r\n    active: boolean; // 是否激活\r\n    display: boolean; // 是否显示\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monitor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monitor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Monitor.vue?vue&type=template&id=3c603ce1&\"\nimport script from \"./Monitor.vue?vue&type=script&lang=ts&\"\nexport * from \"./Monitor.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Monitor.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","// extracted by mini-css-extract-plugin\nmodule.exports = {\"control\":\"Control_control_-Xm__\",\"content\":\"Control_content_8jrU1\",\"progress\":\"Control_progress_3Owql\",\"item\":\"Control_item_3l-J0\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=style&index=0&lang=postcss&module=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('app-page',{attrs:{\"tabs\":_vm.tabs}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\r\nimport Component from 'vue-class-component';\r\n\r\nimport Vue from 'vue';\r\nimport Page from '../../components/layout/Page.vue';\r\n\r\n@Component({\r\n    components: {\r\n        'app-page': Page\r\n    }\r\n})\r\nexport default class MapIndex extends Vue {\r\n    public tabs = [\r\n        { title: '实时监控', to: '/monitor', icon: 'el-icon-view' },\r\n        {\r\n            title: '历史轨迹',\r\n            to: '/monitor/history',\r\n            icon: 'el-icon-film'\r\n        },\r\n        {\r\n            title: '地图编辑',\r\n            to: '/monitor/edit',\r\n            icon: 'el-icon-edit'\r\n        },\r\n        {\r\n            title: '地图添加',\r\n            to: '/monitor/add',\r\n            icon: 'el-icon-document-add'\r\n        }\r\n    ];\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapIndex.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapIndex.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MapIndex.vue?vue&type=template&id=40aeb070&\"\nimport script from \"./MapIndex.vue?vue&type=script&lang=ts&\"\nexport * from \"./MapIndex.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-table',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"data\":_vm.tableData,\"border\":true,\"max-height\":_vm.maxHeight,\"header-row-class-name\":\"table-thead\"}},[_vm._l((_vm.colCfg),function(v,i){return _c('el-table-column',{key:i,attrs:{\"show-overflow-tooltip\":\"\",\"prop\":v.prop,\"label\":v.label,\"resizable\":true,\"min-width\":v.width == null ? undefined : v.width}})}),(_vm.op && _vm.op.length)?_c('el-table-column',{attrs:{\"label\":\"操作\",\"resizable\":true,\"min-width\":_vm.opWidth == null ? undefined : _vm.opWidth},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"flex-center\"},_vm._l((_vm.op),function(v,i){return _c('el-button',{key:i,attrs:{\"size\":\"mini\",\"v-show\":!scope.row.hidden,\"type\":_vm._f(\"parse\")(v.type,scope.row),\"disabled\":v.isDisable ? v.isDisable(scope.row) : false},on:{\"click\":function($event){return _vm.emit(v.name, scope.row, scope.$index)}}},[_vm._v(\"\\n                        \"+_vm._s(_vm._f(\"parse\")(v.desc,scope.row))+\"\\n                    \")])}),1)]}}],null,false,2422452652)}):_vm._e()],2),_c('div',{staticClass:\"flex-center\",staticStyle:{\"justify-content\":\"space-between\"}},[(!_vm.noPrint)?_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-printer\"},on:{\"click\":function($event){return _vm.emit('toExcel')}}},[_vm._v(\"\\n            导出\\n        \")]):_vm._e(),_c('el-pagination',{attrs:{\"current-page\":_vm.page,\"page-size\":_vm.pageSize,\"layout\":((_vm.isSmall ? '' : 'sizes, ') + \"prev, pager, next\"),\"total\":_vm.totalCount,\"small\":!!_vm.isSmall,\"hide-on-single-page\":!!_vm.isSmall,\"pager-count\":5},on:{\"size-change\":function($event){return _vm.updateData('pageSize', $event)},\"current-change\":function($event){return _vm.updateData('page', $event)}}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { Prop, Emit } from 'vue-property-decorator';\r\nimport { SX_WIDTH, DEFAULT_WIDTH } from '../constant';\r\n\r\nexport interface TableRowOperation {\r\n    type: string | IJson;\r\n    name: string | IJson;\r\n    desc: string | IJson;\r\n    isDisable?: (row: any) => boolean;\r\n}\r\n\r\n@Component({\r\n    filters: { parse: parseOpItem }\r\n})\r\nexport default class Table extends Vue {\r\n    @Prop() public maxHeight!: number; // 最大高度\r\n    @Prop() public tableData!: any[]; // 表格数据\r\n    @Prop() public totalCount!: number; // 数据总条数\r\n    @Prop() public colCfg!: any[]; // 列配置\r\n    @Prop() public op!: TableRowOperation[]; // 操作\r\n    @Prop() public noPrint!: boolean; // 是否不显示导出按钮\r\n    @Prop() public isSmall!: boolean; // 是否采用小尺寸布局\r\n    @Prop() public opWidth?: boolean; // 操作列的最小宽\r\n\r\n    public pageSize: number = 10;\r\n    public page: number = 1;\r\n\r\n    private timer?: any;\r\n\r\n    public emit(name: string | IJson, row: any, index: number) {\r\n        name = parseOpItem(name, row);\r\n        this.$emit(name, row, index);\r\n    }\r\n\r\n    public updateData(type: 'page' | 'pageSize', data: number) {\r\n        this[type] = data;\r\n\r\n        if (this.timer) {\r\n            clearTimeout(this.timer);\r\n            this.timer = null;\r\n        }\r\n\r\n        this.timer = setTimeout(\r\n            () => this.$emit('updateData', this.page, this.pageSize),\r\n            200\r\n        );\r\n    }\r\n}\r\n\r\n// 处理表格操作按钮\r\nfunction parseOpItem(\r\n    item: string | Record<string | number, string>,\r\n    obj: { id: string | number }\r\n): string {\r\n    if (typeof item === 'string') {\r\n        return item;\r\n    }\r\n\r\n    return item[obj.id] || item.default || '404';\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Table.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Table.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Table.vue?vue&type=template&id=26dc6fc8&\"\nimport script from \"./Table.vue?vue&type=script&lang=ts&\"\nexport * from \"./Table.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { loopAwait } from '../assets/utils/util';\r\nimport { Prop } from 'vue-property-decorator';\r\nimport { table2Excel } from '../assets/utils/download';\r\nimport Table from '@/components/Table.vue';\r\n\r\ninterface TableData {\r\n    count: number;\r\n    data: any[];\r\n}\r\n\r\n@Component({\r\n    components: {\r\n        'app-table': Table\r\n    }\r\n})\r\nexport default class TableMixin extends Vue {\r\n    @Prop() public permission!: Permission;\r\n\r\n    public totalCount: number = 0;\r\n    public tableData: any[] = [];\r\n    public maxHeight: number = 100;\r\n    public colCfg: any[] = [];\r\n    protected pageSize: number = 10;\r\n    protected page: number = 1;\r\n\r\n    public get op(): any[] {\r\n        return this.permission && this.permission.delete\r\n            ? [{ type: 'danger', name: 'del', desc: '删除' }]\r\n            : [];\r\n    }\r\n\r\n    public created() {\r\n        this.getData(1, 10);\r\n    }\r\n    public mounted() {\r\n        this.getMaxHeight();\r\n    }\r\n\r\n    public async getData(page: number, pageSize: number) {\r\n        this.pageSize = pageSize;\r\n        this.page = page;\r\n\r\n        const res = await this.fetch(page, pageSize);\r\n        this.totalCount = res.count;\r\n        this.tableData = res.data;\r\n    }\r\n    public async toExcel() {\r\n        const body = await this.bodyStr();\r\n        table2Excel(this.headStr() + body);\r\n    }\r\n\r\n    /**\r\n     * 获取表格数据\r\n     */\r\n    protected async fetch(page: number, pageSize: number): Promise<TableData> {\r\n        return { count: 0, data: [] };\r\n    }\r\n\r\n    /**\r\n     * 刷新列表\r\n     * @param page 页数\r\n     */\r\n    protected refresh(isRemove: boolean = true, page?: number) {\r\n        if (page == null) {\r\n            if (isRemove) {\r\n                page = this.tableData.length > 1\r\n                    ? this.page\r\n                    : this.page - 1;\r\n            } else {\r\n                page = this.page;\r\n            }\r\n        }\r\n\r\n        this.getData(Math.max(1, page), this.pageSize);\r\n\r\n        return this;\r\n    }\r\n\r\n    private headStr() {\r\n        const thead = ['<thead><tr>'];\r\n        this.colCfg.forEach(v => thead.push(`<th>${v.label}</th>`));\r\n        thead.push('</tr></thead>');\r\n        return thead.join('');\r\n    }\r\n    private async bodyStr() {\r\n        const data = (await this.fetch(this.page, Math.min(this.totalCount, 2000))).data;\r\n        const tbody = ['<tbody>'];\r\n        data.forEach(v => {\r\n            tbody.push('<tr>');\r\n            this.colCfg.forEach(c => tbody.push(\r\n                `<td style=\"mso-number-format:'\\@'\">${\r\n                v[c.prop] == null ? ' ' : v[c.prop]\r\n                }</td>`\r\n            ));\r\n            tbody.push('</tr>');\r\n        });\r\n        tbody.push('</tbody>');\r\n        return tbody.join('');\r\n    }\r\n    private async getMaxHeight() {\r\n        const component: any = this.$refs.table;\r\n        if (component) {\r\n            const dom: HTMLElement = component.$el || component;\r\n            if (dom) {\r\n                try {\r\n                    await loopAwait(() => !!dom.offsetHeight);\r\n                    this.maxHeight = dom.offsetHeight * 0.85;\r\n                } catch (e) {\r\n                    console.log(e);\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\n","// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar ENDS_WITH = 'endsWith';\nvar $endsWith = ''[ENDS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(ENDS_WITH), 'String', {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = context(this, searchString, ENDS_WITH);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);\n    var search = String(searchString);\n    return $endsWith\n      ? $endsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=1&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=1&lang=css&\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"box\":\"Group_box_MIaUk\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEdit.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEdit.vue?vue&type=style&index=0&lang=postcss&module=true&\"","import { createDecorator } from 'vue-class-component';\nimport { mapState, mapGetters, mapActions, mapMutations } from 'vuex';\nexport var State = createBindingHelper('computed', mapState);\nexport var Getter = createBindingHelper('computed', mapGetters);\nexport var Action = createBindingHelper('methods', mapActions);\nexport var Mutation = createBindingHelper('methods', mapMutations);\nexport function namespace(namespace, helper) {\n    function createNamespacedHelper(helper) {\n        function namespacedHelper(a, b) {\n            if (typeof b === 'string') {\n                var key = b;\n                var proto = a;\n                return helper(key, { namespace: namespace })(proto, key);\n            }\n            var type = a;\n            var options = merge(b || {}, { namespace: namespace });\n            return helper(type, options);\n        }\n        return namespacedHelper;\n    }\n    if (helper) {\n        console.warn('[vuex-class] passing the 2nd argument to `namespace` function is deprecated. pass only namespace string instead.');\n        return createNamespacedHelper(helper);\n    }\n    return {\n        State: createNamespacedHelper(State),\n        Getter: createNamespacedHelper(Getter),\n        Mutation: createNamespacedHelper(Mutation),\n        Action: createNamespacedHelper(Action)\n    };\n}\nfunction createBindingHelper(bindTo, mapFn) {\n    function makeDecorator(map, namespace) {\n        return createDecorator(function (componentOptions, key) {\n            if (!componentOptions[bindTo]) {\n                componentOptions[bindTo] = {};\n            }\n            var mapObject = (_a = {}, _a[key] = map, _a);\n            componentOptions[bindTo][key] = namespace !== undefined\n                ? mapFn(namespace, mapObject)[key]\n                : mapFn(mapObject)[key];\n            var _a;\n        });\n    }\n    function helper(a, b) {\n        if (typeof b === 'string') {\n            var key = b;\n            var proto = a;\n            return makeDecorator(key, undefined)(proto, key);\n        }\n        var namespace = extractNamespace(b);\n        var type = a;\n        return makeDecorator(type, namespace);\n    }\n    return helper;\n}\nfunction extractNamespace(options) {\n    var n = options && options.namespace;\n    if (typeof n !== 'string') {\n        return undefined;\n    }\n    if (n[n.length - 1] !== '/') {\n        return n + '/';\n    }\n    return n;\n}\nfunction merge(a, b) {\n    var res = {};\n    [a, b].forEach(function (obj) {\n        Object.keys(obj).forEach(function (key) {\n            res[key] = obj[key];\n        });\n    });\n    return res;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-form',{ref:\"form\",attrs:{\"label-width\":\"auto\",\"model\":_vm.form}},[_c('el-form-item',{attrs:{\"label\":\"地图名称\",\"prop\":\"name\",\"required\":\"\"}},[_c('el-input',{staticStyle:{\"width\":\"50%\"},attrs:{\"placeholder\":\"请输入地图名称\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._l((['minX', 'maxX', 'minY', 'maxY']),function(k){return _c('el-form-item',{key:k,attrs:{\"label\":k,\"prop\":k,\"required\":\"\"}},[_c('el-input-number',{attrs:{\"step\":100,\"placeholder\":\"地图坐标\"},model:{value:(_vm.form[k]),callback:function ($$v) {_vm.$set(_vm.form, k, $$v)},expression:\"form[k]\"}})],1)}),_c('el-form-item',{attrs:{\"label\":\"地图大小\",\"required\":\"\"}},[_c('el-form-item',{class:_vm.$style.inline,attrs:{\"required\":\"\",\"prop\":\"width\"}},[_c('el-input-number',{attrs:{\"step\":100,\"placeholder\":\"宽(定位)\"},model:{value:(_vm.form.width),callback:function ($$v) {_vm.$set(_vm.form, \"width\", $$v)},expression:\"form.width\"}})],1),_c('el-form-item',{class:_vm.$style.inline,staticStyle:{\"margin-left\":\"20px\"},attrs:{\"required\":\"\",\"prop\":\"height\"}},[_c('el-input-number',{attrs:{\"step\":100,\"placeholder\":\"高(定位)\"},model:{value:(_vm.form.height),callback:function ($$v) {_vm.$set(_vm.form, \"height\", $$v)},expression:\"form.height\"}})],1)],1),_c('el-form-item',{attrs:{\"required\":\"\",\"label\":\"地图\"}},[_c('el-upload',{attrs:{\"auto-upload\":false,\"action\":\"\",\"show-file-list\":false,\"on-change\":_vm.changeUpload}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"success\",\"icon\":\"el-icon-upload\"}},[_vm._v(\"\\n                选择文件\\n            \")]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[(_vm.form.url)?_c('img',{class:_vm.$style.img,attrs:{\"src\":_vm.form.url}}):[_vm._v(\"\\n                    \"+_vm._s(_vm.form.filename ||\n                            '只能上传jpg/png/fmp文件，且不超过5M')+\"\\n                \")]],2)],1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":_vm.submit}},[_vm._v(\"立即提交\")])],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\nimport { Prop, Watch, Emit } from 'vue-property-decorator';\r\nimport { ElForm } from 'element-ui/types/form';\r\n\r\n@Component\r\nexport default class MapEdit extends Vue {\r\n    @Prop({ default: () => ({}) }) public data!: IJson;\r\n\r\n    public form: IJson = {\r\n        url: '',\r\n        filename: '',\r\n        map: null,\r\n        name: '',\r\n        groupCode: []\r\n    };\r\n\r\n    public changeUpload: ((file: any) => void) | null = null; // 选择图片后回调\r\n\r\n    public created() {\r\n        this.changeUpload = (file: any) => {\r\n            if (\r\n                file.raw.type !== 'image/png' &&\r\n                file.raw.type !== 'image/jpeg' &&\r\n                !file.name.endsWith('.fmap')\r\n            ) {\r\n                return this.$message.error('只能上传jpg/png/fmag文件!');\r\n            }\r\n\r\n            if (file.size / 1024 / 1024 > 5) {\r\n                return this.$message.error('上传文件大小不能超过 5MB!');\r\n            }\r\n\r\n            if (file.name.endsWith('.fmap')) {\r\n                this.form.url = '';\r\n                this.form.filename = file.name;\r\n            } else {\r\n                const reader = new FileReader();\r\n                reader.onload = (e: ProgressEvent) => {\r\n                    this.form.filename = '';\r\n                    // target.result 该属性表示目标对象的DataURL\r\n                    this.form.url = <string>(<FileReader>e.target).result;\r\n                };\r\n                // 传入一个参数对象即可得到基于该参数对象的文本内容\r\n                reader.readAsDataURL(file.raw);\r\n            }\r\n\r\n            this.form.map = file.raw;\r\n        };\r\n    }\r\n\r\n    public submit() {\r\n        const form = <ElForm>this.$refs.form;\r\n\r\n        form.validate()\r\n            .then(() => {\r\n                if (!(this.form.map || this.form.url || this.form.filename)) {\r\n                    return this.$message.warning('地图文件不能为空');\r\n                }\r\n\r\n                this.$emit('update:data', this.form);\r\n                this.$emit('submit', this.form);\r\n            })\r\n            .catch(console.log);\r\n    }\r\n\r\n    @Emit('update:data')\r\n    public reset() {\r\n        (<ElForm>this.$refs.form).resetFields();\r\n        this.form.map = null;\r\n        this.form.url = this.form.filename = '';\r\n\r\n        return {};\r\n    }\r\n\r\n    @Watch('data')\r\n    public assignForm() {\r\n        this.form = { ...this.data };\r\n    }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEdit.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEdit.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MapEdit.vue?vue&type=template&id=49d239f3&\"\nimport script from \"./MapEdit.vue?vue&type=script&lang=ts&\"\nexport * from \"./MapEdit.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./MapEdit.vue?vue&type=style&index=0&lang=postcss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=style&index=0&lang=postcss&module=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Zone.vue?vue&type=style&index=0&lang=postcss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/index.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Zone.vue?vue&type=style&index=0&lang=postcss&module=true&\""],"sourceRoot":""}