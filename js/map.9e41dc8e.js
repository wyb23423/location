(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["map"],{"09a4":function(e,t,n){e.exports={box:"History_box_28f2B","tool-bar":"History_tool-bar_3iu_9",mark:"History_mark_3NHky"}},"0a43":function(e,t,n){"use strict";var r=n("0ebb"),a=n.n(r);t["default"]=a.a},"0ebb":function(e,t,n){e.exports={box:"Monitor_box_3P_5U","tool-bar":"Monitor_tool-bar_2GPUR",tools:"Monitor_tools_iFLWy","tool-item":"Monitor_tool-item_182Qz",switch:"Monitor_switch_3ZIU_"}},1250:function(e,t,n){e.exports={box:"Census_box_3bEXU"}},1637:function(e,t,n){e.exports={box:"Zone_box_2h2Ag"}},1896:function(e,t,n){"use strict";var r=n("1250"),a=n.n(r);t["default"]=a.a},"2a87":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[n("h3",{staticStyle:{color:"#009688"}},[e._v("\n        地图编辑\n    ")]),n("el-form",{attrs:{inline:""}},[n("el-form-item",{attrs:{label:"选择地图"}},[n("map-select",{on:{selectmap:e.selectMap}})],1),n("el-form-item",[e.permission.delete?n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.del}},[e._v("\n                删除\n            ")]):e._e()],1)],1),n("div",{staticClass:"el-divider el-divider--horizontal",staticStyle:{width:"95%","background-color":"#e00"}}),e.permission.put?n("map-form",{attrs:{data:e.map},on:{submit:e.onSubmit,"update:data":function(t){e.map=t}}}):e._e()],1)},a=[],o=n("cebc"),i=(n("28a5"),n("bd86")),s=(n("aef6"),n("7f7f"),n("d225")),c=n("b0b4"),u=n("308d"),l=n("6bb5"),f=n("4e2b"),d=n("9ab4"),h=n("2fe1"),p=n("2b0e"),v=n("61fd"),m=n("b20a"),g=n("60a3"),b=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.map={},e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"selectMap",value:function(e){var t=e.margin;this.map=Object(i["a"])({id:e.id,name:e.name,minX:t[0][0],maxX:t[2][0],minY:t[0][1],maxY:t[2][1],width:t[4][0],height:t[4][1],groupCode:e.groupCode},e.filepath.endsWith(".fmap")?"filename":"url",e.filepath)}},{key:"del",value:function(){var e=this;null!=this.map.id?this.$confirm("删除地图: ".concat(this.map.name,"?")).then(function(){return e.$http.post("/api/map/deleteMap",{id:e.map.id})}).then(function(){e.$message.success("删除成功"),location.href=location.href}).catch(console.log):this.$message.error("未选择地图!")}},{key:"onSubmit",value:function(e){var t=this;if(null==this.map.id)return this.$message.error("未选择地图!");this.$confirm("确认修改?").then(function(){return e.map?t.$http.post("/api/map/upload/mapfile",{file:e.map,mapName:e.map.name.split(".")[0]||"map"}):{resultMap:{mapUrl:e.filename||e.url}}}).then(function(n){var r=Date.now(),a=e.minX,i=e.maxX,s=e.minY,c=e.maxY;return t.$http.post({url:"/api/map/addMap",body:Object(o["a"])({},t.map,{filepath:n.resultMap.mapUrl,name:e.name,updateTime:r,updateUser:"null",margin:JSON.stringify([[a,s],[a,c],[i,c],[i,s],[e.width,e.height]])}),headers:{"Content-Type":"application/json"}})}).then(function(){t.$message.success("修改成功"),t.$refs.form.reset()}).catch(console.log)}}]),t}(p["default"]);d["a"]([Object(g["d"])()],b.prototype,"permission",void 0),b=d["a"]([Object(h["b"])({components:{"map-form":v["a"],"map-select":m["a"]}})],b);var y=b,w=y,_=n("2877"),x=Object(_["a"])(w,r,a,!1,null,null,null);t["default"]=x.exports},4078:function(e,t,n){"use strict";var r=n("b669"),a=n.n(r);t["default"]=a.a},"485c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.box},[n("div",{class:e.$style["tool-bar"]},[n("map-select",{staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}})],1),n("div",{ref:"map",staticStyle:{height:"100%",overflow:"hidden"}}),n("history-control",{ref:"control",attrs:{date:e.date,showPath:e.showPath,timeRange:e.timeRange,loadCall:e.loadCall},on:{"update:date":function(t){e.date=t},"update:showPath":function(t){e.showPath=t},"update:show-path":function(t){e.showPath=t},play:e.onPlay,progress:e.onProgress,pause:e.onPause,"set-icons":e.setIcons},model:{value:e.progress,callback:function(t){e.progress=t},expression:"progress"}}),e.isLoading?n("div",{staticClass:"flex-center",class:e.$style.mark},[n("i",{staticClass:"el-icon-loading"})]):e._e()],1)},a=[],o=(n("6762"),n("2fdb"),n("768b")),i=(n("ffc1"),n("96cf"),n("3b8d")),s=(n("f400"),n("ac6a"),n("5df3"),n("4f7f"),n("d225")),c=n("b0b4"),u=n("308d"),l=n("6bb5"),f=n("4e2b"),d=n("9ab4"),h=n("2fe1"),p=n("99d1"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{class:e.$style.control},[n("div",{class:e.$style.content},[n("div",{staticClass:"flex-center",class:e.$style.item,staticStyle:{"margin-right":"20px"}},[n("el-select",{staticStyle:{"min-width":"200px"},attrs:{disabled:e.isPlaying,"multiple-limit":5,loading:e.loading,"remote-method":e.remoteMethod,placeholder:"请输入关键词",multiple:"",remote:"",filterable:"","collapse-tags":""},on:{change:e.change},model:{value:e.tagNos,callback:function(t){e.tagNos=t},expression:"tagNos"}},e._l(e.options,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),n("el-date-picker",{staticStyle:{margin:"0 20px"},attrs:{disabled:e.isPlaying,type:"datetimerange","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.change},model:{value:e.dateProxy,callback:function(t){e.dateProxy=t},expression:"dateProxy"}}),n("el-switch",{staticStyle:{"flex-shrink":"0"},attrs:{"active-text":"显示","inactive-text":"隐藏",disabled:!e.hasData},model:{value:e.showPathProxy,callback:function(t){e.showPathProxy=t},expression:"showPathProxy"}})],1),n("div",{staticClass:"flex-center",class:e.$style.item},[n("el-button",{staticStyle:{"font-size":"24px"},attrs:{icon:e.isPlaying?"el-icon-video-pause":"el-icon-video-play",disabled:!e.canPlay,type:"text"},on:{click:e.play}}),n("el-button",{staticStyle:{"font-size":"24px"},attrs:{disabled:!e.hasData,icon:"el-icon-refresh",type:"text"},on:{click:e.rePlay}}),n("div",{staticClass:"flex-center",class:e.$style.progress},[n("span",[e._v(e._s(e._f("formatTime")(e.timeRange,e.progress)))]),n("el-slider",{staticStyle:{"flex-grow":"1",padding:"0 15px"},attrs:{disabled:!e.canPlay,"format-tooltip":e.format},on:{input:function(t){return e.$emit("progress")},change:function(t){return e.$emit("play")}},model:{value:e.progress,callback:function(t){e.progress=t},expression:"progress"}}),n("span",[e._v(e._s(e._f("formatTime")(e.timeRange,100)))])],1)],1)])])},m=[],g=(n("7f7f"),n("d8c9")),b=n("2b0e"),y=n("60a3"),w=n("cebc"),_=n("a002"),x=Object(w["a"])({},_,{getItem:function(e){return j(e,_)}});function j(e,t){return O.apply(this,arguments)}function O(){return O=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.getItem(t);case 2:if(r=e.sent,null!=r){e.next=5;break}return e.abrupt("return",Promise.reject());case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}},e)})),O.apply(this,arguments)}var k=12e5,S=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.tagNos=[],e.hasData=!1,e.fragmentLength=k,e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"destroyed",value:function(){this.controller&&this.controller.abort()}},{key:"loadData",value:function(){var e=this;if(!this.timeRange)return Promise.reject("时间范围错误");if(this.timeRange>108e5)return Promise.reject("选择的时间范围不得超过3小时");this.controller&&this.controller.abort();var t=this.index;t||(this.fragmentLength=k);var n=this.date[0]+t*this.fragmentLength,r=Math.min(n+this.fragmentLength,this.date[1]);return this.fetch(n,r).then(function(e){return t?e:x.clear().then(function(){return e})}).then(function(n){return t||(e.fragmentLength=1e4*k/(n.length||1e4)),e.hasData=!0,e.syncLoad(r,t).savePosition(t,n)})}},{key:"syncLoad",value:function(e,t){var n=this;if(!(this.date&&null!=this.date[1]&&e<this.date[1]))return this;this.controller=new AbortController;for(var r=[],a=function(a){if(r.push(n.fetch(e,Math.min(e+n.fragmentLength,n.date[1]),n.controller).then(function(e){n.savePosition(t+a,e),n.loadCall&&n.loadCall(n,t+a)})),e+=n.fragmentLength,e>=n.date[1])return"break"},o=1;o<=6;o++){var i=a(o);if("break"===i)break}return Promise.all(r).then(function(){return n.syncLoad(e,t+6)}).catch(console.log),this}},{key:"fetch",value:function(e,t,n){var r=6e4*(new Date).getTimezoneOffset();return this.$http.post({url:"/api/tag/queryTagHistory",body:{startTime:new Date(e-r),endTime:new Date(t-r),tagNos:this.tagNos},headers:{"Content-Type":"application/json"},controller:n}).then(function(e){var t=e.pagedData.datas;return Promise.resolve(t)})}},{key:"savePosition",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.getItem(t+"");case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e["catch"](0),r={},a=6e4*(new Date).getTimezoneOffset(),n.forEach(function(e){e.position.every(function(e){return+e>=0})&&(r[e.sTagNo]||(r[e.sTagNo]=[])).push({x:+e.position[1],y:+e.position[2],z:+e.position[3]||0,time:new Date(e.time).getTime()+a,group:e.sGroupNo})}),e.abrupt("return",x.setItem(t+"",r));case 12:case"end":return e.stop()}},e,null,[[0,6]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"dateProxy",get:function(){return this.date||null},set:function(e){this.$emit("update:date",e)}},{key:"progress",get:function(){return this.value||0},set:function(e){this.$emit("input",e)}},{key:"canPlay",get:function(){return!!(this.tagNos.length&&this.date&&this.date.length>=2)}},{key:"index",get:function(){var e=this.progress*this.timeRange/100-k;return e<=0?0:Math.ceil(e/this.fragmentLength)}},{key:"count",get:function(){if(!this.timeRange)return 0;var e=Math.max(0,this.timeRange-k);return Math.ceil(e/this.fragmentLength)+1}}]),t}(b["default"]);d["a"]([Object(y["d"])()],S.prototype,"date",void 0),d["a"]([Object(y["d"])()],S.prototype,"timeRange",void 0),d["a"]([Object(y["d"])()],S.prototype,"value",void 0),d["a"]([Object(y["d"])()],S.prototype,"loadCall",void 0),S=d["a"]([h["b"]],S);var I=S,N=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.loading=!1,e.remoteMethod=null,e.format=null,e.isPlaying=!1,e.options=[],e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){var e=this;this.format=function(t){return Object(g["c"])(e.timeRange,t)};var t=0;this.remoteMethod=function(n){if(!e.loading){if(clearTimeout(t),!n)return e.options.length=0;t=setTimeout(function(){e.loading=!0,e.$http.get("/api/tag/getall",{pageSize:100,currentPage:1,name:n}).then(function(t){e.options.length=0;var n=new Map;t.pagedData.datas.forEach(function(t){e.options.push({label:t.name,value:t.tagNo}),n.set(t.tagNo,t.photo)}),e.$emit("set-icons",n),e.loading=!1}).catch(console.log)},500)}}}},{key:"destroyed",value:function(){this.pause()}},{key:"change",value:function(){this.hasData=this.showPathProxy=!1,this.progress=0}},{key:"rePlay",value:function(){this.pause(),Promise.resolve().then(this.play.bind(this))}},{key:"play",value:function(){var e=this;this.isPlaying?this.pause(this.progress).$emit("pause"):this.hasData?(this.isPlaying=!0,this._play()):this.tagNos.length?(this.isPlaying=!0,this.loadData().then(this._play.bind(this)).catch(function(t){t&&e.$message.error(t),e.isPlaying=!1})):this.$message.warning("请选择标签")}},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.timer&&(cancelAnimationFrame(this.timer),this.timer=void 0),this.progress=e,this.isPlaying=!1,this}},{key:"_play",value:function(){var e=this;this.timer&&(cancelAnimationFrame(this.timer),this.timer=void 0);var t=Date.now(),n=function n(){var r=Date.now();e.isPlaying&&(e.progress+=(r-t)/e.timeRange*100),e.progress>=100?e.pause():e.timer=requestAnimationFrame(n),t=r};n(),this.$emit("play")}},{key:"showPathProxy",get:function(){return this.showPath},set:function(e){this.$emit("update:showPath",e)}}]),t}(Object(h["c"])(I));d["a"]([Object(y["d"])()],N.prototype,"showPath",void 0),N=d["a"]([Object(h["b"])({filters:{formatTime:g["c"]}})],N);var E=N,T=E,P=n("7833"),C=(n("baf6"),n("2877"));function R(e){this["$style"]=P["default"].locals||P["default"]}var D=Object(C["a"])(T,v,m,!1,R,null,null),A=D.exports,$=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.date=null,e.progress=0,e.loadCall=null,e.isLoading=!1,e.renderTags=new Set,e.next={},e.moving=new Set,e.fragmentIndex=-1,e.points={},e.icons=new Map,e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){var e=this;this.loadCall=function(t,n){n===e.fragmentIndex&&e.isLoading&&(e.isLoading=!1,t.play())}}},{key:"setIcons",value:function(e){var t=this;e.forEach(function(e,n){return t.icons.set(n,e)})}},{key:"onPlay",value:function(){var e=this;this.mgr&&this.date&&this.date.length>=2&&this.getFragment().then(function(){e.mgr&&e.mgr.remove(),setTimeout(function(){e.next={},e.moving.clear(),e.renderTags.clear()},100)}).catch(console.log)}},{key:"onProgress",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,i,s,c=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.fragmentIndex<0)){e.next=2;break}return e.abrupt("return");case 2:return t=this.fragmentIndex,n=this.points,e.prev=4,e.next=7,this.getFragment();case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](4),e.abrupt("return",console.log(e.t0));case 12:r=function(){var e=Object(o["a"])(i[a],2),r=e[0],s=e[1];if(c.moving.has(r))return"continue";Promise.resolve().then(function(){return c.mgr?c.parseProgress(s,t,n[r]||[],r):Promise.reject("地图不存在")}).then(function(e){var t=e.prev,n=e.target,a=e.record;if(!c.groups.includes(n.group))return c.mgr&&(c.mgr.remove(r),c.mgr.lineMgr.remove(r)),c.renderTags.delete(r);if(t&&c.renderTags.has(r)){var o=n.time-t.time+a.errorTime;c.moveTo(r,n,o).then(function(){return c.moving.delete(r)}),c.moving.add(r),a.index++,c.next[r]=a}else c.start(n,r)}).catch(console.log)},a=0,i=Object.entries(this.points);case 14:if(!(a<i.length)){e.next=21;break}if(s=r(),"continue"!==s){e.next=18;break}return e.abrupt("continue",18);case 18:a++,e.next=14;break;case 21:case"end":return e.stop()}},e,this,[[4,9]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onPause",value:function(){this.mgr&&this.mgr.stopMoveTo()}},{key:"parseProgress",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n,r,a){var o,i,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=this.next[a]||{index:0,errorTime:0},n===this.fragmentIndex?(i=t[o.index],s=t[o.index-1]):(i=t[0],s=r?r.pop():null),i){e.next=18;break}if(t.length&&!(this.control.count<=this.fragmentIndex+1)){e.next=8;break}return this.mgr&&this.mgr.remove(a),e.abrupt("return",Promise.reject());case 8:return e.prev=8,e.next=11,x.getItem(this.fragmentIndex+1+"");case 11:return c=e.sent,e.abrupt("return",this.parseProgress(c[a]||[],n,r,a));case 15:return e.prev=15,e.t0=e["catch"](8),e.abrupt("return",this.loading());case 18:return e.abrupt("return",{target:i,prev:s,record:o});case 19:case"end":return e.stop()}},e,this,[[8,15]])}));function t(t,n,r,a){return e.apply(this,arguments)}return t}()},{key:"start",value:function(e,t){if(this.mgr&&this.date&&this.date.length>=2){var n=this.timeRange*this.progress/100,r=e.time-this.date[0];n>=r&&(this.mgr.addImage({x:e.x,y:e.y,height:.5,url:this.icons.get(t),size:48},t,void 0,!1),this.renderTags.add(t),this.next[t]={index:1,errorTime:0})}}},{key:"getFragment",value:function(){var e=this;return Promise.resolve().then(function(){var t=e.control.index;return t!==e.fragmentIndex?(e.fragmentIndex=t,x.getItem(t+"")):e.points}).then(function(t){return e.points=t}).catch(this.loading.bind(this))}},{key:"loading",value:function(){return this.isLoading=!0,this.control.pause(),Promise.reject("loading...")}},{key:"timeRange",get:function(){return!this.date||this.date.length<2?0:this.date[1]-this.date[0]}}]),t}(Object(h["c"])(p["a"]));d["a"]([Object(y["e"])("control")],$.prototype,"control",void 0),$=d["a"]([Object(h["b"])({components:{"history-control":A}})],$);var M=$,z=M,B=n("e87d");function L(e){this["$style"]=B["default"].locals||B["default"]}var F=Object(C["a"])(z,r,a,!1,L,null,null);t["default"]=F.exports},"5eed":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[e._m(0),n("map-form",{ref:"form",on:{submit:e.onSubmit}})],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h3",{staticStyle:{color:"#009688"}},[e._v("\n        地图添加\n        "),n("span",{staticStyle:{"font-size":"12px"}},[e._v('\n            (注意: 如果地图文件是fengmap文件, 需将其对应的主题文件夹放入\n            "/data/theme/" 目录)\n        ')])])}],o=(n("7f7f"),n("28a5"),n("d225")),i=n("b0b4"),s=n("308d"),c=n("6bb5"),u=n("4e2b"),l=n("9ab4"),f=n("2fe1"),d=n("2b0e"),h=n("61fd"),p=function(e){function t(){return Object(o["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"onSubmit",value:function(e){var t=this;this.$http.post("/api/map/upload/mapfile",{file:e.map,mapName:e.map.name.split(".")[0]||"map"}).then(function(n){var r=Date.now(),a=e.minX,o=e.maxX,i=e.minY,s=e.maxY;return t.$http.post({url:"/api/map/addMap",body:{createTime:r,createUser:"null",filepath:n.resultMap.mapUrl,name:e.name,updateTime:r,updateUser:"null",margin:JSON.stringify([[a,i],[a,s],[o,s],[o,i],[e.width,e.height]])},headers:{"Content-Type":"application/json"}})}).then(function(){t.$message.success("添加成功"),t.$refs.form.reset()}).catch(console.log)}}]),t}(d["default"]);p=l["a"]([Object(f["b"])({components:{"map-form":h["a"]}})],p);var v=p,m=v,g=n("2877"),b=Object(g["a"])(m,r,a,!1,null,null,null);t["default"]=b.exports},"61fd":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"form",attrs:{"label-width":"auto",model:e.form}},[n("el-form-item",{attrs:{label:"地图名称",prop:"name",required:""}},[n("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入地图名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._l(["minX","maxX","minY","maxY"],function(t){return n("el-form-item",{key:t,attrs:{label:t,prop:t,required:""}},[n("el-input-number",{attrs:{step:100,placeholder:"地图坐标"},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[k]"}})],1)}),n("el-form-item",{attrs:{label:"地图大小",required:""}},[n("el-form-item",{class:e.$style.inline,attrs:{required:"",prop:"width"}},[n("el-input-number",{attrs:{step:100,placeholder:"宽(实际)"},model:{value:e.form.width,callback:function(t){e.$set(e.form,"width",t)},expression:"form.width"}})],1),n("el-form-item",{class:e.$style.inline,staticStyle:{"margin-left":"20px"},attrs:{required:"",prop:"height"}},[n("el-input-number",{attrs:{step:100,placeholder:"高(实际)"},model:{value:e.form.height,callback:function(t){e.$set(e.form,"height",t)},expression:"form.height"}})],1)],1),n("el-form-item",{attrs:{label:"关联分组",prop:"groupCode",required:""}},[n("el-select",{staticClass:"select_input",attrs:{multiple:"",filterable:"","allow-create":"",clearable:"","default-first-option":"",placeholder:"关联分组","popper-class":e.$style.hidden},model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1),n("el-form-item",{attrs:{required:"",label:"地图"}},[n("el-upload",{attrs:{"auto-upload":!1,action:"","show-file-list":!1,"on-change":e.changeUpload}},[n("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload"}},[e._v("\n                选择文件\n            ")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e.form.url?n("img",{class:e.$style.img,attrs:{src:e.form.url}}):[e._v("\n                    "+e._s(e.form.filename||"只能上传jpg/png/fmp文件，且不超过5M")+"\n                ")]],2)],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"success"},on:{click:e.submit}},[e._v("立即提交")])],1)],2)},a=[],o=n("cebc"),i=(n("7f7f"),n("aef6"),n("d225")),s=n("b0b4"),c=n("308d"),u=n("6bb5"),l=n("4e2b"),f=n("9ab4"),d=n("2b0e"),h=n("2fe1"),p=n("60a3"),v=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.form={url:"",filename:"",map:null,name:"",groupCode:[]},e.changeUpload=null,e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){var e=this;this.changeUpload=function(t){if("image/png"!==t.raw.type&&"image/jpeg"!==t.raw.type&&!t.name.endsWith(".fmap"))return e.$message.error("只能上传jpg/png/fmag文件!");if(t.size/1024/1024>5)return e.$message.error("上传文件大小不能超过 5MB!");if(t.name.endsWith(".fmap"))e.form.url="",e.form.filename=t.name;else{var n=new FileReader;n.onload=function(t){e.form.filename="",e.form.url=t.target.result},n.readAsDataURL(t.raw)}e.form.map=t.raw}}},{key:"submit",value:function(){var e=this,t=this.$refs.form;t.validate().then(function(){if(!(e.form.map||e.form.url||e.form.filename))return e.$message.warning("地图文件不能为空");var t=Object(o["a"])({},e.form,{groupCode:e.form.groupCode.join(",")});e.$emit("update:data",t),e.$emit("submit",t)}).catch(console.log)}},{key:"reset",value:function(){return this.$refs.form.resetFields(),this.form.map=null,this.form.url=this.form.filename="",{}}},{key:"assignForm",value:function(){Object.assign(this.form,this.data)}}]),t}(d["default"]);f["a"]([Object(p["d"])({default:function(){return{}}})],v.prototype,"data",void 0),f["a"]([Object(p["b"])("update:data")],v.prototype,"reset",null),f["a"]([Object(p["f"])("data")],v.prototype,"assignForm",null),v=f["a"]([h["b"]],v);var m=v,g=m,b=n("4078"),y=(n("ded2"),n("2877"));function w(e){this["$style"]=b["default"].locals||b["default"]}var _=Object(y["a"])(g,r,a,!1,w,null,null);t["a"]=_.exports},"69b2":function(e,t,n){},"6b39":function(e,t,n){},7833:function(e,t,n){"use strict";var r=n("8a47"),a=n.n(r);t["default"]=a.a},8615:function(e,t,n){var r=n("5ca1"),a=n("504c")(!1);r(r.S,"Object",{values:function(e){return a(e)}})},"89b9":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.box,on:{click:e.hiddenCover}},[n("div",{staticClass:"flex-center",class:e.$style["tool-bar"]},[n("map-select",{on:{selectmap:e.selectMap}}),n("el-input",{staticStyle:{"max-width":"350px"},attrs:{placeholder:"请输入"+(e.isName?"标签名":"标签号"),type:"search"},model:{value:e.findTarget,callback:function(t){e.findTarget=t},expression:"findTarget"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.isName,callback:function(t){e.isName=t},expression:"isName"}},[n("el-option",{attrs:{value:0,label:"标签号"}}),n("el-option",{attrs:{value:1,label:"标签名"}})],1),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.find},slot:"append"})],1)],1),n("el-switch",{class:e.$style.switch,attrs:{"active-text":"显示轨迹","inactive-text":"隐藏轨迹","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.showPath,callback:function(t){e.showPath=t},expression:"showPath"}}),n("div",{ref:"map",staticStyle:{height:"100%",overflow:"hidden"}}),n("div",{class:e.$style.tools},e._l(e.tools,function(t,r){return n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"v.display"}],key:r,class:e.$style["tool-item"],attrs:{type:t.active?"primary":""},on:{click:function(t){return t.stopPropagation(),e.swithDisplay(r)}}},[e._v("\n            "+e._s(t.name)+"\n        ")])}),1),n("transition",{attrs:{name:"el-zoom-in-bottom"}},[e.tools[4].active?n("Census",{attrs:{zones:e.zoneAll,renderTags:e.renderTags},on:{close:function(t){e.tools[4].active=!1}}}):e._e()],1),n("transition",{attrs:{name:"el-fade-in-linear"}},[e.tools[3].active?n("Group",{attrs:{group:e.groupData}}):e._e(),e.tools[2].active?n("Zone",{attrs:{zones:e.zoneAll}}):e._e()],1)],1)},a=[],o=n("cebc"),i=(n("4917"),n("75fc")),s=n("768b"),c=(n("ac4d"),n("8a81"),n("7f7f"),n("7514"),n("8615"),n("96cf"),n("3b8d")),u=(n("ac6a"),n("5df3"),n("f400"),n("d225")),l=n("b0b4"),f=n("308d"),d=n("6bb5"),h=n("4e2b"),p=n("9ab4"),v=n("2fe1"),m=n("99d1"),g=n("d8c9"),b=n("b3af"),y=n("ae85"),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(e){e.stopPropagation()}}},[n("el-card",{ref:"table",staticClass:"card",class:e.$style.box},[n("app-table",{attrs:{"max-height":500,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:[{type:"danger",name:"switch",desc:"切换显示"}],isSmall:!0,noPrint:!0},on:{switch:e.switchZone,updateData:e.getData}})],1)],1)},_=[],x=(n("d185"),n("4f7f"),n("60a3")),j=new Set,O=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(f["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"name",label:"区域"},{prop:"status",label:"状态"}],e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"switchZone",value:function(e){if(this.$parent){var t=Reflect.get(this.$parent,"mgr");t&&(j.has(e.name)?(t.remove(e.name),j.delete(e.name)):(t.zoneOpen(e),j.add(e.name)))}}},{key:"fetch",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=this.zones.slice((t-1)*n,t*n),e.abrupt("return",{count:this.zones.length,data:r.map(function(e){var t=Object(o["a"])({},e);return t.status=e.enable?"开启":"关闭",t.position="string"===typeof e.position?JSON.parse(e.position):e.position,t})});case 2:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()}]),t}(Object(v["c"])(y["a"]));p["a"]([Object(x["d"])()],O.prototype,"zones",void 0),O=p["a"]([v["b"]],O);var k=O,S=k,I=n("fcc3"),N=n("2877");function E(e){this["$style"]=I["default"].locals||I["default"]}var T=Object(N["a"])(S,w,_,!1,E,null,null),P=T.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(e){e.stopPropagation()}}},[n("el-card",{ref:"table",staticClass:"card",class:e.$style.box},[n("app-table",{attrs:{"max-height":500,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:[{type:"danger",name:"switch",desc:"切换显示"}],isSmall:!0,noPrint:!0},on:{switch:e.switchZone,updateData:e.getData}})],1)],1)},R=[],D=(n("ffc1"),function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(f["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"分组"}],e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"switchZone",value:function(e){if(this.$parent){var t=Reflect.get(this.$parent,"mgr");t&&e.children.forEach(function(e){return t.show(e.baseNo)})}}},{key:"fetch",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=Object.entries(this.group).slice((t-1)*n,t*n),e.abrupt("return",{count:r.length,data:r.map(function(e){return{id:e[0],children:e[1]}})});case 2:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()}]),t}(Object(v["c"])(y["a"])));p["a"]([Object(x["d"])()],D.prototype,"group",void 0),D=p["a"]([v["b"]],D);var A=D,$=A,M=n("932b");function z(e){this["$style"]=M["default"].locals||M["default"]}var B=Object(N["a"])($,C,R,!1,z,null,null),L=B.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(e){e.stopPropagation()}}},[n("el-card",{class:e.$style.box},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("标签统计")]),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text",icon:"el-icon-close"},on:{click:function(t){return e.$emit("close")}}})],1),n("el-form",{staticStyle:{margin:"0 auto 44px"}},[n("el-form-item",{attrs:{label:"选择区域"}},[n("el-select",{attrs:{filterable:""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[n("el-option",{attrs:{label:"当前地图",value:-1}}),e._l(e.zones,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1),n("div",{staticStyle:{"text-align":"center"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!!e.info,expression:"!!info"}],staticStyle:{"border-bottom":"1px solid #ccc"}},[e._v("\n                "+e._s((e.info||{}).name)+"标签数量: "+e._s((e.info||{}).count)+"\n            ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.info,expression:"!info"}]},[n("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"24px"}})])])],1)],1)},U=[],W=(n("aef6"),n("f6b3"),n("2b0e")),q=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(f["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.value=-1,e.info={name:"当前地图",count:0},e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.info=this.getAllInfo()}},{key:"getAllInfo",value:function(){return{name:"当前地图",count:Object.values(this.renderTags).filter(function(e){return e>=0}).length}}},{key:"getInfo",value:function(){var e=this;if(this.zones&&this.renderTags)if(-1===this.value)this.info=this.getAllInfo();else{var t=this.zones.find(function(t){return t.id===e.value});t&&this.$http.get("/api/tag/getall",{currentPage:1,pageSize:1e8,zone:this.value}).then(function(n){var r=n.pagedData.datas.filter(function(t){return Reflect.has(e.renderTags,t.tagNo)&&e.renderTags[t.tagNo]>=0});e.info={name:t.name+(t.name.endsWith("区域")?"":"区域"),count:r.length}}),this.info=null}}}]),t}(W["default"]);p["a"]([Object(x["d"])()],q.prototype,"tags",void 0),p["a"]([Object(x["d"])()],q.prototype,"zones",void 0),p["a"]([Object(x["d"])()],q.prototype,"renderTags",void 0),p["a"]([Object(x["f"])("renderTags",{deep:!0}),Object(x["f"])("value")],q.prototype,"getInfo",null),q=p["a"]([v["b"]],q);var H=q,X=H,J=n("1896");function Y(e){this["$style"]=J["default"].locals||J["default"]}var G=Object(N["a"])(X,F,U,!1,Y,null,null),K=G.exports,Z=n("c860"),Q=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(f["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.groupData={},e.tools=[{name:"2D",active:!0,display:!0},{name:"3D",active:!1,display:!1},{name:"区域列表",active:!1,display:!0},{name:"分组列表",active:!1,display:!0},{name:"统计",active:!1,display:!0}],e.zoneAll=[],e.findTarget="",e.showPath=!1,e.isName=0,e.renderTags={},e.baseAll=[],e.ws=[],e.pops=new Map,e.infoArr=[],e.timer=0,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=this;this.tagAll={},Promise.all(["tag","zone"].map(function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/api/".concat(n,"/getall"),{currentPage:1,pageSize:1e8});case 3:return r=t.sent,t.abrupt("return",r.pagedData.datas);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",[]);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}())).then(function(t){e.zoneAll=t[1],e.tagAll=Object(g["a"])(t[0],"tagNo",!1)}),this.warning()}},{key:"beforeDestroy",value:function(){var e=this.ws.pop();while(e)e.close(),e.onmessage=null,e=this.ws.pop();Object.values(this.renderTags).forEach(clearTimeout),this.pops.forEach(function(e){return e.close()}),this.tagAll={},cancelAnimationFrame(this.timer)}},{key:"swithDisplay",value:function(e){var t=this.tools[e];if(e<2){if(t.active)return;var n=this.tools[e?0:1];n.active=!n.active,this.mgr&&this.mgr.switchViewMode()}if(t.active=!t.active,2===e||3===e){var r=this.tools[2===e?3:2];t.active&&(r.active=!1)}}},{key:"hiddenCover",value:function(){for(var e=2;e<this.tools.length;e++)this.tools[e].active=!1}},{key:"find",value:function(){var e=this,t=this.isName?"标签名":"标签号";if(!this.findTarget)return this.$message.warning("请输入"+t);if(this.mgr&&!this.pops.has(this.findTarget)){var n=this.mgr.find(this.findTarget,!!this.isName);n.length?n.forEach(function(t){var n=t.custom&&t.custom.info?t.custom.info:null;n&&e.pops.set(n.name,e.mgr.addPopInfo(t))}):this.$message.info("未找到标签".concat(t,"为").concat(this.findTarget,"的标签"))}this.findTarget=""}},{key:"bindEvents",value:function(){var e=this;this.mgr.on("loadComplete",function(){e.mgr&&(e.tools[0].active=!0,e.tools[1].active=!1,e.tools[1].display=e.mgr.has3D,e.tagAnchor().then(function(t){e.baseAll=t,e.groupData=Object(g["a"])(t,"groupCode"),e.initWebSoket()}),e.init())}),this.mgr.on("mapClickNode",function(t){if(e.mgr)if(t.nodeType===fengmap.FMNodeType.IMAGE_MARKER&&t.target.custom&&t.target.custom.info.tagNo){var n=t.target.custom.info.tagNo;e.pops.has(n)||e.pops.set(n,e.mgr.addPopInfo(t.target))}else{var r=!0,a=!1,o=void 0;try{for(var i,c=e.pops.entries()[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=Object(s["a"])(i.value,2),l=u[0],f=u[1];f.close()&&e.pops.delete(l)}}catch(d){a=!0,o=d}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}}})}},{key:"init",value:function(){Object.values(this.renderTags).forEach(clearTimeout),this.renderTags={},this.pops.forEach(function(e){return e.close()}),this.pops.clear(),this.showPath=!1,this.findTarget="";for(var e=2;e<this.tools.length;e++)this.tools[e].active=!1;this.infoArr.length=0}},{key:"tagAnchor",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,o,s,c,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=Object(i["a"])(this.baseAll),t.length){e.next=7;break}return e.next=5,this.$http.get("/api/base/getall",{currentPage:1,pageSize:1e4});case 5:n=e.sent,t=n.pagedData.datas;case 7:if(!this.mgr){e.next=27;break}for(r=!0,a=!1,o=void 0,e.prev=11,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0)u=c.value,this.addIcon(1,{x:u.coordx,y:u.coordy,name:u.baseNo,groupid:u.groupCode,photo:"/images/anchor.png",size:32},2),this.mgr.addTextMarker({height:2,fillcolor:"#009688",fontsize:15,type:1,strokecolor:"255,255,0",x:u.coordx,y:u.coordy-40},u.baseNo+"");e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),a=!0,o=e.t0;case 19:e.prev=19,e.prev=20,r||null==s.return||s.return();case 22:if(e.prev=22,!a){e.next=25;break}throw o;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return e.abrupt("return",t);case 30:return e.prev=30,e.t1=e["catch"](0),e.abrupt("return",[]);case 33:case"end":return e.stop()}},e,this,[[0,30],[11,15,19,27],[20,,22,26]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"addIcon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.mgr){var r=this.mgr.map;return this.mgr instanceof Z["a"]&&(r.gestureEnableController.enableMapHover=!0),this.mgr.addImage({x:t.x,y:t.y,height:1,url:t.photo,size:t.size||24,callback:function(e){e.custom||(e.custom={}),Object.assign(e.custom,{type:n,info:t}),t.callback&&t.callback(e)}},t.name,e,!!t.isMapCoor)}}},{key:"initWebSoket",value:function(){var e=this,t=location.hostname,n=[],r=0,a=function(t){var a=JSON.parse(t.data);e.tagAll[a.sTagNo]&&(n.push(a),Date.now()-r>50/3&&(n.forEach(function(t){return e.move(t)}),n.length=0,r=Date.now()))},o=JSON.parse(sessionStorage.getItem("config")).SOCKET_COUNT;if("multiple"===o){var i=Date.now();this.ws=this.groups.map(function(e){var n=new WebSocket("ws://".concat(t,"/realtime/position/").concat(e,"/").concat(i));return n.onmessage=a,n})}else{var s=new WebSocket("ws://".concat(t,"/realtime/position"));s.onmessage=a,this.ws=[s]}}},{key:"move",value:function(e){var t=this;if(!this.mgr)return console.log("获取地图失败!!");if(e.position.every(function(e){return+e>=0})){var n=this.renderTags[e.sTagNo],r={x:+e.position[0],y:+e.position[1],z:1};if(n)clearTimeout(n),this.mgr.show(e.sTagNo,!0),this.moveTo(e.sTagNo,r,1,function(){var n=t.pops.get(e.sTagNo);n&&n.update&&(n.update()||t.pops.delete(e.sTagNo))});else{var a=this.tagAll[e.sTagNo],i=Object(o["a"])({},a||{},{name:e.sTagNo,tagName:a?a.name:"未知标签"},r),s=this.mgr.map.groupIDs;this.addIcon(s?s[0]:0,i)}this.renderTags[e.sTagNo]=setTimeout(function(){return t.infoArr.push(e.sTagNo)},b["f"])}}},{key:"warning",value:function(){var e=this.infoArr.shift();e&&(this.$notify.warning("标签".concat(e,"异常。信号丢失!")),this.mgr&&(this.mgr.show(e,!1),this.renderTags[e]=-1,this.pops.has(e)&&(this.pops.get(e).close(!0),this.pops.delete(e)))),this.timer=requestAnimationFrame(this.warning.bind(this))}}]),t}(Object(v["c"])(m["a"],y["a"]));Q=p["a"]([Object(v["b"])({components:{Zone:P,Group:L,Census:K}})],Q);var V=Q,ee=V,te=n("0a43");function ne(e){this["$style"]=te["default"].locals||te["default"]}var re=Object(N["a"])(ee,r,a,!1,ne,null,null);t["default"]=re.exports},"8a47":function(e,t,n){e.exports={control:"Control_control_-Xm__",content:"Control_content_8jrU1",progress:"Control_progress_3Owql",item:"Control_item_3l-J0"}},"932b":function(e,t,n){"use strict";var r=n("c055"),a=n.n(r);t["default"]=a.a},a002:function(e,t,n){(function(t){var n;
/*!
    localForage -- Offline Storage, Improved
    Version 1.7.3
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
(function(t){e.exports=t()})(function(){return function e(t,r,a){function o(s,c){if(!r[s]){if(!t[s]){var u="function"==typeof n&&n;if(!c&&u)return n(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return o(n||e)},f,f.exports,e,t,r,a)}return r[s].exports}for(var i="function"==typeof n&&n,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(e,n,r){(function(e){"use strict";var t,r,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var o=0,i=new a(l),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),t=function(){s.data=o=++o%2}}else if(e.setImmediate||"undefined"===typeof e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var c=new e.MessageChannel;c.port1.onmessage=l,t=function(){c.port2.postMessage(0)}}var u=[];function l(){var e,t;r=!0;var n=u.length;while(n){t=u,u=[],e=-1;while(++e<n)t[e]();n=u.length}r=!1}function f(e){1!==u.push(e)||r||t()}n.exports=f}).call(this,"undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function a(){}var o={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function u(e){if("function"!==typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==a&&h(this,e)}function l(e,t,n){this.promise=e,"function"===typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"===typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(e,t,n){r(function(){var r;try{r=t(n)}catch(a){return o.reject(e,a)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}function d(e){var t=e&&e.then;if(e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function a(t){n||(n=!0,o.resolve(e,t))}function i(){t(a,r)}var s=p(i);"error"===s.status&&r(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}function v(e){return e instanceof this?e:o.resolve(new this(a),e)}function m(e){var t=new this(a);return o.reject(t,e)}function g(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);var i=new Array(n),s=0,c=-1,u=new this(a);while(++c<n)l(e[c],c);return u;function l(e,a){function c(e){i[a]=e,++s!==n||r||(r=!0,o.resolve(u,i))}t.resolve(e).then(c,function(e){r||(r=!0,o.reject(u,e))})}}function b(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);var i=-1,s=new this(a);while(++i<n)c(e[i]);return s;function c(e){t.resolve(e).then(function(e){r||(r=!0,o.resolve(s,e))},function(e){r||(r=!0,o.reject(s,e))})}}t.exports=u,u.prototype["catch"]=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!==typeof e&&this.state===s||"function"!==typeof t&&this.state===i)return this;var n=new this.constructor(a);if(this.state!==c){var r=this.state===s?e:t;f(n,r,this.outcome)}else this.queue.push(new l(n,e,t));return n},l.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){o.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;var a=-1,i=e.queue.length;while(++a<i)e.queue[a].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;var n=-1,r=e.queue.length;while(++n<r)e.queue[n].callRejected(t);return e},u.resolve=v,u.reject=m,u.all=g,u.race=b},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!==typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!==typeof indexedDB)return indexedDB;if("undefined"!==typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!==typeof mozIndexedDB)return mozIndexedDB;if("undefined"!==typeof OIndexedDB)return OIndexedDB;if("undefined"!==typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=o();function s(){try{if(!i)return!1;var e="undefined"!==typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"===typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange}catch(n){return!1}}function c(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n="undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,a=0;a<e.length;a+=1)r.append(e[a]);return r.getBlob(t.type)}}"undefined"===typeof Promise&&e(3);var u=Promise;function l(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function f(e,t,n){"function"===typeof t&&e.then(t),"function"===typeof n&&e["catch"](n)}function d(e){return"string"!==typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function h(){if(arguments.length&&"function"===typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",v=void 0,m={},g=Object.prototype.toString,b="readonly",y="readwrite";function w(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),a=0;a<t;a++)r[a]=e.charCodeAt(a);return n}function _(e){return new u(function(t){var n=e.transaction(p,y),r=c([""]);n.objectStore(p).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})["catch"](function(){return!1})}function x(e){return"boolean"===typeof v?u.resolve(v):_(e).then(function(e){return v=e,v})}function j(e){var t=m[e.name],n={};n.promise=new u(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function O(e){var t=m[e.name],n=t.deferredOperations.pop();if(n)return n.resolve(),n.promise}function k(e,t){var n=m[e.name],r=n.deferredOperations.pop();if(r)return r.reject(t),r.promise}function S(e,t){return new u(function(n,r){if(m[e.name]=m[e.name]||$(),e.db){if(!t)return n(e.db);j(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var o=i.open.apply(i,a);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(p)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),O(e)}})}function I(e){return S(e,!1)}function N(e){return S(e,!0)}function E(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,a=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function T(e){return new u(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function P(e){var t=w(atob(e.data));return c([t],{type:e.type})}function C(e){return e&&e.__local_forage_encoded_blob}function R(e){var t=this,n=t._initReady().then(function(){var e=m[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return f(n,e,e),n}function D(e){j(e);for(var t=m[e.name],n=t.forages,r=0;r<n.length;r++){var a=n[r];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,I(e).then(function(t){return e.db=t,E(e)?N(e):t}).then(function(r){e.db=t.db=r;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=r})["catch"](function(t){throw k(e,t),t})}function A(e,t,n,r){void 0===r&&(r=1);try{var a=e.db.transaction(e.storeName,t);n(null,a)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return u.resolve().then(function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),N(e)}).then(function(){return D(e).then(function(){A(e,t,n,r-1)})})["catch"](n);n(o)}}function $(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function M(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var a=m[n.name];a||(a=$(),m[n.name]=a),a.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=R);var o=[];function i(){return u.resolve()}for(var s=0;s<a.forages.length;s++){var c=a.forages[s];c!==t&&o.push(c._initReady()["catch"](i))}var l=a.forages.slice(0);return u.all(o).then(function(){return n.db=a.db,I(n)}).then(function(e){return n.db=e,E(n,t._defaultConfig.version)?N(n):e}).then(function(e){n.db=a.db=e,t._dbInfo=n;for(var r=0;r<l.length;r++){var o=l[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})}function z(e,t){var n=this;e=d(e);var r=new u(function(t,r){n.ready().then(function(){A(n._dbInfo,b,function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=i.get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),C(e)&&(e=P(e)),t(e)},s.onerror=function(){r(s.error)}}catch(c){r(c)}})})["catch"](r)});return l(r,t),r}function B(e,t){var n=this,r=new u(function(t,r){n.ready().then(function(){A(n._dbInfo,b,function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=i.openCursor(),c=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;C(r)&&(r=P(r));var a=e(r,n.key,c++);void 0!==a?t(a):n["continue"]()}else t()},s.onerror=function(){r(s.error)}}catch(u){r(u)}})})["catch"](r)});return l(r,t),r}function L(e,t,n){var r=this;e=d(e);var a=new u(function(n,a){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===g.call(t)?x(o.db).then(function(e){return e?t:T(t)}):t}).then(function(t){A(r._dbInfo,y,function(o,i){if(o)return a(o);try{var s=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;a(e)}}catch(u){a(u)}})})["catch"](a)});return l(a,n),a}function F(e,t){var n=this;e=d(e);var r=new u(function(t,r){n.ready().then(function(){A(n._dbInfo,y,function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=i["delete"](e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(c){r(c)}})})["catch"](r)});return l(r,t),r}function U(e){var t=this,n=new u(function(e,n){t.ready().then(function(){A(t._dbInfo,y,function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName),i=o.clear();a.oncomplete=function(){e()},a.onabort=a.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(s){n(s)}})})["catch"](n)});return l(n,e),n}function W(e){var t=this,n=new u(function(e,n){t.ready().then(function(){A(t._dbInfo,b,function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName),i=o.count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(s){n(s)}})})["catch"](n)});return l(n,e),n}function q(e,t){var n=this,r=new u(function(t,r){e<0?t(null):n.ready().then(function(){A(n._dbInfo,b,function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=!1,c=i.openCursor();c.onsuccess=function(){var n=c.result;n?0===e?t(n.key):s?t(n.key):(s=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(u){r(u)}})})["catch"](r)});return l(r,t),r}function H(e){var t=this,n=new u(function(e,n){t.ready().then(function(){A(t._dbInfo,b,function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName),i=o.openCursor(),s=[];i.onsuccess=function(){var t=i.result;t?(s.push(t.key),t["continue"]()):e(s)},i.onerror=function(){n(i.error)}}catch(c){n(c)}})})["catch"](n)});return l(n,e),n}function X(e,t){t=h.apply(this,arguments);var n=this.config();e="function"!==typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;if(e.name){var o=e.name===n.name&&a._dbInfo.db,s=o?u.resolve(a._dbInfo.db):I(e).then(function(t){var n=m[e.name],r=n.forages;n.db=t;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=t;return t});r=e.storeName?s.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;j(e);var r=m[e.name],a=r.forages;t.close();for(var o=0;o<a.length;o++){var s=a[o];s._dbInfo.db=null,s._dbInfo.version=n}var c=new u(function(t,r){var a=i.open(e.name,n);a.onerror=function(e){var t=a.result;t.close(),r(e)},a.onupgradeneeded=function(){var t=a.result;t.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}});return c.then(function(e){r.db=e;for(var t=0;t<a.length;t++){var n=a[t];n._dbInfo.db=e,O(n._dbInfo)}})["catch"](function(t){throw(k(e,t)||u.resolve())["catch"](function(){}),t})}}):s.then(function(t){j(e);var n=m[e.name],r=n.forages;t.close();for(var a=0;a<r.length;a++){var o=r[a];o._dbInfo.db=null}var s=new u(function(t,n){var r=i.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}});return s.then(function(e){n.db=e;for(var t=0;t<r.length;t++){var a=r[t];O(a._dbInfo)}})["catch"](function(t){throw(k(e,t)||u.resolve())["catch"](function(){}),t})})}else r=u.reject("Invalid arguments");return l(r,t),r}var J={_driver:"asyncStorage",_initStorage:M,_support:s(),iterate:B,getItem:z,setItem:L,removeItem:F,clear:U,length:W,key:q,keys:H,dropInstance:X};function Y(){return"function"===typeof openDatabase}var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="~~local_forage_type~",Z=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",V=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",ae="uic8",oe="si16",ie="si32",se="ur16",ce="ui32",ue="fl32",le="fl64",fe=V+ee.length,de=Object.prototype.toString;function he(e){var t,n,r,a,o,i=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var u=new ArrayBuffer(i),l=new Uint8Array(u);for(t=0;t<s;t+=4)n=G.indexOf(e[t]),r=G.indexOf(e[t+1]),a=G.indexOf(e[t+2]),o=G.indexOf(e[t+3]),l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|a>>2,l[c++]=(3&a)<<6|63&o;return u}function pe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=G[n[t]>>2],r+=G[(3&n[t])<<4|n[t+1]>>4],r+=G[(15&n[t+1])<<2|n[t+2]>>6],r+=G[63&n[t+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function ve(e,t){var n="";if(e&&(n=de.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===de.call(e.buffer))){var r,a=Q;e instanceof ArrayBuffer?(r=e,a+=ee):(r=e.buffer,"[object Int8Array]"===n?a+=ne:"[object Uint8Array]"===n?a+=re:"[object Uint8ClampedArray]"===n?a+=ae:"[object Int16Array]"===n?a+=oe:"[object Uint16Array]"===n?a+=se:"[object Int32Array]"===n?a+=ie:"[object Uint32Array]"===n?a+=ce:"[object Float32Array]"===n?a+=ue:"[object Float64Array]"===n?a+=le:t(new Error("Failed to get type for BinaryArray"))),t(a+pe(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=K+e.type+"~"+pe(this.result);t(Q+te+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}}function me(e){if(e.substring(0,V)!==Q)return JSON.parse(e);var t,n=e.substring(fe),r=e.substring(V,fe);if(r===te&&Z.test(n)){var a=n.match(Z);t=a[1],n=n.substring(a[0].length)}var o=he(n);switch(r){case ee:return o;case te:return c([o],{type:t});case ne:return new Int8Array(o);case re:return new Uint8Array(o);case ae:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case se:return new Uint16Array(o);case ie:return new Int32Array(o);case ce:return new Uint32Array(o);case ue:return new Float32Array(o);case le:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var ge={serialize:ve,deserialize:me,stringToBuffer:he,bufferToString:pe};function be(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ye(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!==typeof e[r]?e[r].toString():e[r];var a=new u(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(a){return r(a)}n.db.transaction(function(a){be(a,n,function(){t._dbInfo=n,e()},function(e,t){r(t)})},r)});return n.serializer=ge,a}function we(e,t,n,r,a,o){e.executeSql(n,r,a,function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,s){s.rows.length?o(e,i):be(e,t,function(){e.executeSql(n,r,a,o)},o)},o):o(e,i)},o)}function _e(e,t){var n=this;e=d(e);var r=new u(function(t,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){we(n,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=a.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function xe(e,t){var n=this,r=new u(function(t,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){we(n,a,"SELECT * FROM "+a.storeName,[],function(n,r){for(var o=r.rows,i=o.length,s=0;s<i;s++){var c=o.item(s),u=c.value;if(u&&(u=a.serializer.deserialize(u)),u=e(u,c.key,s+1),void 0!==u)return void t(u)}t()},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function je(e,t,n,r){var a=this;e=d(e);var o=new u(function(o,i){a.ready().then(function(){void 0===t&&(t=null);var s=t,c=a._dbInfo;c.serializer.serialize(t,function(t,u){u?i(u):c.db.transaction(function(n){we(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){o(s)},function(e,t){i(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(je.apply(a,[e,s,n,r-1]));i(t)}})})})["catch"](i)});return l(o,n),o}function Oe(e,t,n){return je.apply(this,[e,t,n,1])}function ke(e,t){var n=this;e=d(e);var r=new u(function(t,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){we(n,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function Se(e){var t=this,n=new u(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){we(t,r,"DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function Ie(e){var t=this,n=new u(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){we(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function Ne(e,t){var n=this,r=new u(function(t,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){we(n,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function Ee(e){var t=this,n=new u(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){we(t,r,"SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],a=0;a<n.rows.length;a++)r.push(n.rows.item(a).key);e(r)},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function Te(e){return new u(function(t,n){e.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var a=[],o=0;o<r.rows.length;o++)a.push(r.rows.item(o).name);t({db:e,storeNames:a})},function(e,t){n(t)})},function(e){n(e)})})}function Pe(e,t){t=h.apply(this,arguments);var n=this.config();e="function"!==typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;return r=e.name?new u(function(t){var r;r=e.name===n.name?a._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Te(r))}).then(function(e){return new u(function(t,n){e.db.transaction(function(r){function a(e){return new u(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}for(var o=[],i=0,s=e.storeNames.length;i<s;i++)o.push(a(e.storeNames[i]));u.all(o).then(function(){t()})["catch"](function(e){n(e)})},function(e){n(e)})})}):u.reject("Invalid arguments"),l(r,t),r}var Ce={_driver:"webSQLStorage",_initStorage:ye,_support:Y(),iterate:xe,getItem:_e,setItem:Oe,removeItem:ke,clear:Se,length:Ie,key:Ne,keys:Ee,dropInstance:Pe};function Re(){try{return"undefined"!==typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function De(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function Ae(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(t){return!0}}function $e(){return!Ae()||localStorage.length>0}function Me(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=De(e,t._defaultConfig),$e()?(t._dbInfo=n,n.serializer=ge,u.resolve()):u.reject()}function ze(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return l(n,e),n}function Be(e,t){var n=this;e=d(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return l(r,t),r}function Le(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,a=r.length,o=localStorage.length,i=1,s=0;s<o;s++){var c=localStorage.key(s);if(0===c.indexOf(r)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),u=e(u,c.substring(a),i++),void 0!==u)return u}}});return l(r,t),r}function Fe(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(a){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return l(r,t),r}function Ue(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],a=0;a<n;a++){var o=localStorage.key(a);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r});return l(n,e),n}function We(e){var t=this,n=t.keys().then(function(e){return e.length});return l(n,e),n}function qe(e,t){var n=this;e=d(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return l(r,t),r}function He(e,t,n){var r=this;e=d(e);var a=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new u(function(a,o){var i=r._dbInfo;i.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(i.keyPrefix+e,t),a(n)}catch(s){"QuotaExceededError"!==s.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==s.name||o(s),o(s)}})})});return l(a,n),a}function Xe(e,t){if(t=h.apply(this,arguments),e="function"!==typeof e&&e||{},!e.name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,a=this;return r=e.name?new u(function(t){e.storeName?t(De(e,a._defaultConfig)):t(e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):u.reject("Invalid arguments"),l(r,t),r}var Je={_driver:"localStorageWrapper",_initStorage:Me,_support:Re(),iterate:Le,getItem:Be,setItem:He,removeItem:qe,clear:ze,length:We,key:Fe,keys:Ue,dropInstance:Xe},Ye=function(e,t){return e===t||"number"===typeof e&&"number"===typeof t&&isNaN(e)&&isNaN(t)},Ge=function(e,t){var n=e.length,r=0;while(r<n){if(Ye(e[r],t))return!0;r++}return!1},Ke=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ze={},Qe={},Ve={INDEXEDDB:J,WEBSQL:Ce,LOCALSTORAGE:Je},et=[Ve.INDEXEDDB._driver,Ve.WEBSQL._driver,Ve.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function at(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ke(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var it=function(){function e(t){for(var n in a(this,e),Ve)if(Ve.hasOwnProperty(n)){var r=Ve[n],o=r._driver;this[n]=o,Ze[o]||this.defineDriver(r)}this._defaultConfig=ot({},rt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)["catch"](function(){})}return e.prototype.config=function(e){if("object"===("undefined"===typeof e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!==typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"===typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new u(function(t,n){try{var r=e._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(a);for(var o=nt.concat("_initStorage"),i=0,s=o.length;i<s;i++){var c=o[i],f=!Ge(tt,c);if((f||e[c])&&"function"!==typeof e[c])return void n(a)}var d=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=u.reject(t);return l(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var a=tt[n];e[a]||(e[a]=t(a))}};d();var h=function(n){Ze[r]&&console.info("Redefining LocalForage driver: "+r),Ze[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"===typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(p){n(p)}});return f(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ze[e]?u.resolve(Ze[e]):u.reject(new Error("Driver not found."));return f(r,t,n),r},e.prototype.getSerializer=function(e){var t=u.resolve(ge);return f(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return f(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ke(e)||(e=[e]);var a=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function i(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function s(e){return function(){var t=0;function n(){while(t<e.length){var a=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(a).then(i)["catch"](n)}o();var s=new Error("No available storage method found.");return r._driverSet=u.reject(s),r._driverSet}return n()}}var c=null!==this._driverSet?this._driverSet["catch"](function(){return u.resolve()}):u.resolve();return this._driverSet=c.then(function(){var e=a[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then(function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(a)})})["catch"](function(){o();var e=new Error("No available storage method found.");return r._driverSet=u.reject(e),r._driverSet}),f(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];this.supports(a)&&t.push(a)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)at(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),st=new it;t.exports=st},{3:3}]},{},[4])(4)})}).call(this,n("c8ba"))},a89f:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"main"},[n("div",{staticStyle:{"overflow-y":"auto"},style:{height:e.mainHeight}},[n("router-view")],1)]),n("app-aside",{attrs:{tabs:e.tabs}})],1)},a=[],o=n("d225"),i=n("308d"),s=n("6bb5"),c=n("4e2b"),u=n("9ab4"),l=n("2fe1"),f=n("3d13"),d=n("cda1"),h=n("2b0e"),p=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(i["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.tabs=[{title:"实时监控",to:"/monitor",icon:"el-icon-view"},{title:"历史轨迹",to:"/monitor/history",icon:"el-icon-film"},{title:"地图编辑",to:"/monitor/edit",icon:"el-icon-edit"},{title:"地图添加",to:"/monitor/add",icon:"el-icon-document-add"}],e}return Object(c["a"])(t,e),t}(h["default"]);u["a"]([Object(d["a"])("mainHeight")],p.prototype,"mainHeight",void 0),p=u["a"]([Object(l["b"])({components:{"app-aside":f["a"]}})],p);var v=p,m=v,g=n("2877"),b=Object(g["a"])(m,r,a,!1,null,null,null);t["default"]=b.exports},aef6:function(e,t,n){"use strict";var r=n("5ca1"),a=n("9def"),o=n("d2c8"),i="endsWith",s=""[i];r(r.P+r.F*n("5147")(i),"String",{endsWith:function(e){var t=o(this,e,i),n=arguments.length>1?arguments[1]:void 0,r=a(t.length),c=void 0===n?r:Math.min(a(n),r),u=String(e);return s?s.call(t,u,c):t.slice(c-u.length,c)===u}})},b669:function(e,t,n){e.exports={img:"MapEdit_img_1sgW2",inline:"MapEdit_inline_2M2U8",hidden:"MapEdit_hidden_3KdCb"}},baf6:function(e,t,n){"use strict";var r=n("69b2"),a=n.n(r);a.a},c055:function(e,t,n){e.exports={box:"Group_box_MIaUk"}},ded2:function(e,t,n){"use strict";var r=n("6b39"),a=n.n(r);a.a},e87d:function(e,t,n){"use strict";var r=n("09a4"),a=n.n(r);t["default"]=a.a},f6b3:function(e,t,n){var r=n("5ca1");r(r.S,"Reflect",{has:function(e,t){return t in e}})},fcc3:function(e,t,n){"use strict";var r=n("1637"),a=n.n(r);t["default"]=a.a}}]);
//# sourceMappingURL=map.9e41dc8e.js.map