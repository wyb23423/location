(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["system"],{1422:function(e,t,a){e.exports={box:"Fence_box_2lT68","tool-bar":"Fence_tool-bar_2FZ4x",op:"Fence_op_1V_MP",form:"Fence_form_vw2BH",submit:"Fence_submit_Thr33",point:"Fence_point_16SnX"}},"1b8b":function(e,t,a){"use strict";var o=a("6558"),r=a.n(o);t["default"]=r.a},"20d6":function(e,t,a){"use strict";var o=a("5ca1"),r=a("0a49")(6),n="findIndex",i=!0;n in[]&&Array(1)[n](function(){i=!1}),o(o.P+o.F*i,"Array",{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(n)},"2c1b":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":200,isSmall:!0},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},r=[],n=(a("c5f6"),a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),m=a("ae85"),d=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"ID",sortable:!0,width:220},{prop:"name",label:"协议名称",width:220},{prop:"port",label:"协议端口号",width:220},{prop:"effect",label:"协议作用",width:220},{prop:"content",label:"协议内容",width:220}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除协议".concat(e.id,"?")).then(function(){return t.$http.post("/api/protocol/deleteProtocol",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,a){var o,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=[],r=0,e.prev=2,e.next=5,this.$http.get("/api/protocol/getall",{pageSize:Number.MAX_VALUE,currentPage:1});case 5:n=e.sent,o=n.pagedData.datas,r=n.pagedData.totalCount||o.length,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:r,data:o});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()}]),t}(Object(f["c"])(m["a"]));d=p["a"]([f["b"]],d);var b=d,h=b,v=a("2877"),g=Object(v["a"])(h,o,r,!1,null,null,null);t["default"]=g.exports},"54b6":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{paste:function(t){return e.paste(t)}}},e._l(new Array(e.length).fill(1),function(t,o){return a("el-input",{key:o,ref:"ip",refInFor:!0,class:e.$style.ip,on:{input:function(t){return e.next(o)}},model:{value:e.value[o],callback:function(t){e.$set(e.value,o,t)},expression:"value[i]"}},[o<e.length-1?a("span",{attrs:{slot:"append"},slot:"append"},[e._v(".")]):e._e()])}),1)},r=[],n=(a("c5f6"),a("fca0"),a("ac4d"),a("8a81"),a("28a5"),a("ac6a"),a("5df3"),a("1c4c"),a("20d6"),a("d225")),i=a("b0b4"),s=a("308d"),l=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("2b0e"),f=a("2fe1"),m=a("60a3"),d=function(e){function t(){return Object(n["a"])(this,t),Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(i["a"])(t,[{key:"next",value:function(e){var t=this.value[e],a=this.parseIp(t);return this.$set(this.value,e,a),a.length>=(this.max+"").length&&e<this.length-1&&this.$refs.ip[e+1].focus(),t.length<=0&&e>0&&this.$refs.ip[e-1].focus(),this.value}},{key:"paste",value:function(e){var t=this,a=this.$refs.ip.findIndex(function(t){return t.$refs.input===e.target});if(a>-1)for(var o=0,r=Array.from(e.clipboardData.items);o<r.length;o++){var n=r[o];"text/plain"===n.type&&n.getAsString(function(e){return t.pasteHandler(e,a)})}return this.value}},{key:"pasteHandler",value:function(e,t){this.$refs.ip;var a=!0,o=!1,r=void 0;try{for(var n,i=e.split(".")[Symbol.iterator]();!(a=(n=i.next()).done);a=!0){var s=n.value;if(t>this.length-1)break;s&&this.$set(this.value,t++,this.parseIp(s).substr(0,3))}}catch(l){o=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}}},{key:"parseIp",value:function(e){var t=parseInt(e,10);return Number.isFinite(t)?(t=Math.max(this.min,Math.min(t,this.max)),t+""):""}}]),t}(p["default"]);u["a"]([Object(m["c"])({default:function(){return[]}})],d.prototype,"value",void 0),u["a"]([Object(m["c"])({default:function(){return 0}})],d.prototype,"min",void 0),u["a"]([Object(m["c"])({default:function(){return 255}})],d.prototype,"max",void 0),u["a"]([Object(m["c"])({default:function(){return 4}})],d.prototype,"length",void 0),u["a"]([Object(m["b"])("input")],d.prototype,"next",null),u["a"]([Object(m["b"])("input")],d.prototype,"paste",null),d=u["a"]([f["b"]],d);var b=d,h=b,v=a("1b8b"),g=a("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var x=Object(g["a"])(h,o,r,!1,y,null,null);t["a"]=x.exports},6558:function(e,t,a){e.exports={ip:"IpInput_ip_1-NJb"}},"6efb":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{ref:"table",staticClass:"card"},[a("app-table",{attrs:{"max-height":e.maxHeight,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.op,"op-width":120},on:{del:e.del,updateData:e.getData,toExcel:e.toExcel}})],1)],1)},r=[],n=(a("96cf"),a("3b8d")),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),m=a("cda1"),d=a("ae85"),b=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.colCfg=[{prop:"id",label:"摄像头ID",sortable:!0,width:140},{prop:"ip",label:"摄像头IP",width:260},{prop:"port",label:"设备端口号",width:200},{prop:"groupCode",label:"所属组号",sortable:!0,width:200},{prop:"username",label:"用户名",width:220},{prop:"windowSplit",label:"窗口分割数",width:140}],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"del",value:function(e){var t=this;this.$confirm("删除摄像头".concat(e.id,"?")).then(function(){return t.$http.post("/api/camera/deleteCamera",{id:e.id})}).then(function(){t.$message.success("删除成功"),t.refresh()}).catch(console.log)}},{key:"fetch",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,a){var o,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=[],r=0,e.prev=2,e.next=5,this.$http.get("/api/camera/getall",{pageSize:a,currentPage:t});case 5:n=e.sent,o=n.pagedData.datas,r=n.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:r,data:o});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()}]),t}(Object(f["c"])(d["a"]));p["a"]([m["b"]],b.prototype,"baseUrl",void 0),b=p["a"]([f["b"]],b);var h=b,v=h,g=a("2877"),y=Object(g["a"])(v,o,r,!1,null,null,null);t["default"]=y.exports},"7d65":function(e,t,a){e.exports={alert:"Submissio_alert_pkBiZ"}},"93f1":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5%",height:"100%"}},[a("el-card",{staticClass:"card"},[a("div",{class:e.$style.alert},[e._v("协议下发 请选择")]),a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"选择基站：",prop:"base",required:""}},[a("el-cascader",{attrs:{options:e.base,props:{expandTrigger:"hover"},filterable:"","show-all-levels":!1},model:{value:e.form.base,callback:function(t){e.$set(e.form,"base",t)},expression:"form.base"}})],1),a("el-form-item",{attrs:{label:"选择协议：",prop:"protocol",required:""}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.protocol,callback:function(t){e.$set(e.form,"protocol",t)},expression:"form.protocol"}},e._l(e.protocols,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"端口号："}},[a("el-radio",{attrs:{label:5e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    50000端口\n                ")]),a("el-radio",{attrs:{label:6e4},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}},[e._v("\n                    60000端口\n                ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                    立即提交\n                ")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)],1)},r=[],n=a("768b"),i=(a("ffc1"),a("ac6a"),a("7f7f"),a("d225")),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),m=a("2b0e"),d=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e.base=[],e.tags=[],e.protocols=[],e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init(),this.getData()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){Date.now();var a={ip:e.form.base[1],port:e.form.port,protocol:e.form.protocol};e.$http.post("/api/protocol/sendProtocol",a).then(function(t){e.$message.success(t.message),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={base:[],port:5e4,protocol:"",tagNo:""}}},{key:"getData",value:function(){var e=this;this.$http.get("/api/base/getall",{pageSize:1e7,currentPage:1}).then(this.toTree.bind(this)).catch(console.error),this.$http.get("/api/tag/getall",{pageSize:1e7,currentPage:1}).then(function(e){return e.pagedData.datas.map(function(e){return{value:e.tagNo,label:"".concat(e.name,": ").concat(e.tagNo)}})}).then(function(t){return e.tags=t}).catch(console.error),this.$http.get("/api/protocol/getall",{pageSize:1e7,currentPage:1}).then(function(t){e.protocols=t.pagedData.datas.map(function(e){return{value:e.content,label:e.name}})}).catch(console.error)}},{key:"toTree",value:function(e){this.base.length=0;var t={};e.pagedData.datas.forEach(function(e){(t[e.groupCode]||(t[e.groupCode]=[])).push({value:e.ip,label:"".concat(e.name,": ").concat(e.baseNo,"; ").concat(e.main?"主":"从","基站")})});for(var a=0,o=Object.entries(t);a<o.length;a++){var r=Object(n["a"])(o[a],2),i=r[0],s=r[1];this.base.push({label:"分组".concat(i),children:s})}}}]),t}(m["default"]);d=p["a"]([f["b"]],d);var b=d,h=b,v=a("a810"),g=a("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var x=Object(g["a"])(h,o,r,!1,y,null,null);t["default"]=x.exports},9826:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main"},[a("div",{staticStyle:{"overflow-y":"auto"},style:{height:e.mainHeight}},[a("router-view")],1)]),a("app-aside",{attrs:{tabs:e.tabs}})],1)},r=[],n=a("d225"),i=a("308d"),s=a("6bb5"),l=a("4e2b"),c=a("9ab4"),u=a("2fe1"),p=a("3d13"),f=a("cda1"),m=a("2b0e"),d=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(i["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.tabs=[{title:"电子围栏",to:"/system/fence",icon:"el-icon-crop"},{title:"摄像头",to:"camera",icon:"el-icon-video-camera",children:[{title:"摄像头添加",to:"/system/camera/add",icon:"el-icon-circle-plus-outline"},{title:"摄像头列表",to:"/system/camera/list",icon:"el-icon-tickets"}]},{title:"协议",to:"protocol",icon:"el-icon-document",children:[{title:"协议添加",to:"/system/protocol/add",icon:"el-icon-document-add"},{title:"协议列表",to:"/system/protocol/list",icon:"el-icon-document-copy"},{title:"下发协议",to:"/system/protocol/submissio",icon:"el-icon-takeaway-box"}]}],e}return Object(l["a"])(t,e),t}(m["default"]);c["a"]([Object(f["a"])("mainHeight")],d.prototype,"mainHeight",void 0),d=c["a"]([Object(u["b"])({components:{"app-aside":p["a"]}})],d);var b=d,h=b,v=a("2877"),g=Object(v["a"])(h,o,r,!1,null,null,null);t["default"]=g.exports},"9b6a":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"摄像头IP：",required:""}},[a("ip-input",{model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),a("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),a("el-form-item",{attrs:{label:"用户名：",prop:"username",required:""}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),a("el-input",{staticClass:"hidden"})],1),a("el-form-item",{attrs:{label:"密码：",prop:"password",required:""}},[a("el-input",{staticClass:"hidden",attrs:{type:"password"}}),a("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("el-form-item",{attrs:{label:"窗口分割数: ",prop:"windowSplit",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.windowSplit,callback:function(t){e.$set(e.form,"windowSplit",t)},expression:"form.windowSplit"}},e._l([1,2,3,4],function(e){return a("el-option",{key:e,attrs:{value:e,label:e+"X"+e}})}),1)],1),a("el-form-item",{attrs:{label:"所在组号：",prop:"groupCode",required:""}},[a("el-input",{model:{value:e.form.groupCode,callback:function(t){e.$set(e.form,"groupCode",t)},expression:"form.groupCode"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},r=[],n=a("cebc"),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),m=a("2b0e"),d=a("54b6"),b=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.form.ip.every(function(e){return!isNaN(+e)}),a=this.$refs.form;a.validate(function(a){if(!t)return e.$message.warning("摄像头ip不完整");if(isNaN(e.form.groupCode))return e.$message.warning("组号只能包含数字");if(a){Date.now();var o=Object(n["a"])({},e.form);o.ip=e.form.ip.join("."),o.createTime=o.updateTime=Date.now(),o.createUser=o.updateUser="string",e.$http.post("/api/camera/addCamera",o,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={username:"",ip:["","","",""],port:"",groupCode:"",windowSplit:1,password:""}}}]),t}(m["default"]);b=p["a"]([Object(f["b"])({components:{"ip-input":d["a"]}})],b);var h=b,v=h,g=a("2877"),y=Object(g["a"])(v,o,r,!1,null,null,null);t["default"]=y.exports},a810:function(e,t,a){"use strict";var o=a("7d65"),r=a.n(o);t["default"]=r.a},b1fa:function(e,t,a){"use strict";var o=a("1422"),r=a.n(o);t["default"]=r.a},ba16:function(e,t,a){var o=a("5ca1"),r=a("11e9").f,n=a("cb7c");o(o.S,"Reflect",{deleteProperty:function(e,t){var a=r(n(e),t);return!(a&&!a.configurable)&&delete e[t]}})},be03:function(e,t,a){e.exports={ip:"ProtocolAdd_ip_2eYu2"}},c3e5:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"5%","padding-top":"3%"}},[a("h3",{staticStyle:{color:"#009688"}},[e._v("\n        协议添加\n    ")]),a("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{model:e.form,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"协议名称：",prop:"name",required:""}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"协议作用：",prop:"effect",required:""}},[a("el-input",{model:{value:e.form.effect,callback:function(t){e.$set(e.form,"effect",t)},expression:"form.effect"}})],1),a("el-form-item",{attrs:{label:"协议内容：",prop:"content",required:""}},[a("el-input",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),a("el-form-item",{attrs:{label:"设备端口号：",prop:"port",required:""}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},r=[],n=a("cebc"),i=a("d225"),s=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),f=a("2fe1"),m=a("2b0e"),d=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e}return Object(u["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.init()}},{key:"onSubmit",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){var a=Object(n["a"])({},e.form);a.createTime=a.updateTime=Date.now(),a.createUser=a.updateUser="string",e.$http.post("/api/protocol/addProtocol",a,{"Content-Type":"application/json"}).then(function(){e.$message.success("添加成功"),e.reset()}).catch(console.log)}})}},{key:"reset",value:function(){this.$refs.form.resetFields(),this.init()}},{key:"init",value:function(){this.form={name:"",port:"",effect:"",content:""}}}]),t}(m["default"]);d=p["a"]([f["b"]],d);var b=d,h=b,v=a("d34c"),g=a("2877");function y(e){this["$style"]=v["default"].locals||v["default"]}var x=Object(g["a"])(h,o,r,!1,y,null,null);t["default"]=x.exports},d34c:function(e,t,a){"use strict";var o=a("be03"),r=a.n(o);t["default"]=r.a},fc9b:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.$style.box},[a("div",{class:e.$style["tool-bar"]},[a("map-select",{staticStyle:{"margin-left":"50px"},on:{selectmap:e.selectMap}})],1),a("div",{ref:"map",staticStyle:{height:"100%",overflow:"hidden"}}),a("el-collapse",{class:e.$style.op,model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[e.permission.get?a("el-collapse-item",{attrs:{name:"info",title:"区域信息"}},[a("app-table",{class:e.$style.table,attrs:{"max-height":255,"table-data":e.tableData,"col-cfg":e.colCfg,"total-count":e.totalCount,op:e.operation,"op-width":200,noPrint:!0,isSmall:!0},on:{updateData:e.getData,del:e.del,setting:function(t){e.zone=t},display:e.display}})],1):e._e(),e.permission.post?a("el-collapse-item",{attrs:{title:"添加区域",name:"add"}},[a("el-form",{ref:"form",class:e.$style.form,style:{"max-height":e.formHeight},attrs:{model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"区域名称",required:""}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"区域模式"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[a("el-option",{attrs:{label:"进入区域",value:0}}),a("el-option",{attrs:{label:"离开区域",value:1}}),e.groups.length>=2?a("el-option",{attrs:{label:"切换区域",value:2}}):e._e()],1)],1),2===e.form.mode?[a("el-form-item",{attrs:{label:"基站分组1",required:"",prop:"group1"}},[a("el-select",{model:{value:e.form.group1,callback:function(t){e.$set(e.form,"group1",t)},expression:"form.group1"}},e._l(e.groups,function(t){return a("el-option",{key:t,attrs:{value:t,disabled:t===e.form.group2}})}),1)],1),a("el-form-item",{attrs:{label:"基站分组2",required:"",prop:"group2"}},[a("el-select",{model:{value:e.form.group2,callback:function(t){e.$set(e.form,"group2",t)},expression:"form.group2"}},e._l(e.groups,function(t){return a("el-option",{key:t,attrs:{value:t,disabled:t===e.form.group1}})}),1)],1)]:e._e(),e._l(e.form.position,function(t,o){return a("el-form-item",{key:o,attrs:{label:"区域坐标"+(o+1)}},[a("el-button",{attrs:{type:t?"warning":"success",size:"mini"},on:{click:function(a){return e.setPosition(t,o)}}},[e._v("\n                        "+e._s(t?"删除":e.pointIndex>=0?"...":"设置")+"\n                    ")]),a("span",{staticClass:"ellipsis",class:e.$style.point},[e._v("\n                        "+e._s(t?JSON.stringify(t):"")+"\n                    ")])],1)}),a("el-form-item",{attrs:{label:"启动"}},[a("el-switch",{attrs:{"active-text":"true","inactive-text":"false"},model:{value:e.form.open,callback:function(t){e.$set(e.form,"open",t)},expression:"form.open"}})],1)],2),a("el-button",{class:e.$style.submit,attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("\n                提交\n            ")])],1):e._e()],1),e.zone?[a("el-dialog",{attrs:{title:"更改区域信息",visible:!!e.zone,"modal-append-to-body":!1},on:{close:function(t){e.zone=null}}},[a("el-form",{ref:"form",attrs:{"label-width":"auto"}},[a("el-form-item",{attrs:{label:"区域名称",required:""}},[a("el-input",{staticStyle:{width:"70%"},model:{value:e.zone.name,callback:function(t){e.$set(e.zone,"name",t)},expression:"zone.name"}})],1),a("el-form-item",{attrs:{label:"区域模式"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.zone.mode,callback:function(t){e.$set(e.zone,"mode",t)},expression:"zone.mode"}},[a("el-option",{attrs:{label:"进入区域",value:0}}),a("el-option",{attrs:{label:"离开区域",value:1}}),a("el-option",{attrs:{label:"切换区域",value:2}})],1)],1),a("el-form-item",{attrs:{label:"启动"}},[a("el-switch",{attrs:{"active-text":"true","inactive-text":"false"},model:{value:e.zone.open,callback:function(t){e.$set(e.zone,"open",t)},expression:"zone.open"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{on:{click:function(t){e.zone=null}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],2)]:e._e()],2)},r=[],n=(a("ba16"),a("ac6a"),a("cebc")),i=a("75fc"),s=(a("20d6"),a("7f7f"),a("96cf"),a("3b8d")),l=a("d225"),c=a("b0b4"),u=a("308d"),p=a("6bb5"),f=a("4e2b"),m=a("9ab4"),d=a("2fe1"),b=a("ae85"),h=a("99d1"),v=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(u["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.activeNames=["info","add"],e.pointIndex=-1,e.zone=null,e.colCfg=[{prop:"name",label:"区域",sortable:!0,width:90},{prop:"status",label:"状态",width:60}],e.operation=[{type:{default:"primary"},name:"display",desc:{default:"显示"}}],e.form={name:"",mode:0,position:[null],open:!0,group1:"",group2:""},e.isFirst=!0,e}return Object(f["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){this.permission.delete&&this.operation.push({type:"danger",name:"del",desc:"删除"}),this.permission.put&&this.operation.push({type:"warning",name:"setting",desc:"设置"})}},{key:"del",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("确认删除区域".concat(t.name,"?"),"确认删除");case 3:return e.next=5,this.$http.post("/api/zone/deleteZone",{id:t.id});case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",console.log(e.t0));case 10:this.$message.success("删除成功"),this.refresh(),this.display(t,a,!0);case 13:case"end":return e.stop()}},e,this,[[0,7]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"display",value:function(e,t,a){var o=this.operation.findIndex(function(e){return"display"===e.name});if(o>-1){var r=this.operation[o];r.type[t]||a?(r.type[t]=void 0,this.mgr&&this.mgr.remove(e.name)):(r.type[t]="success",this.mgr&&this.mgr.zoneOpen(e)),r.desc[t]=r.desc[t]||a?void 0:"隐藏",this.$set(this.operation,o,r)}}},{key:"setPosition",value:function(e,t){var a=this.form.position.indexOf(e);e&&a>-1?(this.form.position.splice(a,1),this.mgr&&this.mgr.remove(JSON.stringify(e))):(this.pointIndex=t,this.isFirst&&(this.$message.info("点击地图设置区域顶点"),this.isFirst=!1))}},{key:"onSubmit",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs.form.validate();case 3:if(!(this.form.position.length<4)){e.next=5;break}return e.abrupt("return",this.$message.warning("区域坐标最少设置3个"));case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return");case 10:t=Object(i["a"])(this.form.position),t.pop(),this.mgr&&this.mgr.createPolygonMarker(t,this.form.name,!0),setTimeout(function(){return a.put(t)},1e3);case 14:case"end":return e.stop()}},e,this,[[0,7]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=this;if(this.zone){if(!this.zone.name)return this.$message.error("区域名称不能为空");var t=Object(n["a"])({},this.zone,{position:JSON.stringify(this.zone.position),updateTime:Date.now(),enable:this.zone.open?1:0});this.$http.post("/api/zone/updateZone",t,{"Content-Type":"application/json"}).then(function(){e.$message.success("修改区域信息成功"),e.refresh()}).catch(console.log)}}},{key:"fetch",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,a){var o,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=[],r=0,e.prev=2,e.next=5,this.$http.get("/api/zone/getall",{pageSize:a,currentPage:t});case 5:n=e.sent,o=n.pagedData.datas.map(function(e){return e.status=e.enable?"开启":"关闭",e.position=JSON.parse(e.position),e.open=!!e.enable,e.mode=null==e.mode?0:e.mode,e}),r=n.pagedData.totalCount,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0);case 13:return e.abrupt("return",{count:r,data:o});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"bindEvents",value:function(){var e=this;this.mgr.on("mapClickNode",function(t){if(t.nodeType!==fengmap.FMNodeType.NONE&&e.pointIndex>-1){var a=t.eventInfo.coord,o=e.mgr.addImage({x:a.x,y:a.y,url:"/images/blueImageMarker.png",size:32,height:2});e.$set(e.form.position,e.pointIndex,o),e.pointIndex=-1,e.form.position.push(null)}})}},{key:"put",value:function(e){var t=this;this.$confirm("请确定当前区域范围","提示",{type:"info"}).then(function(){return t.assemble(e)}).then(function(a){return e.forEach(t.setPosition,t),t.mgr?(a.position=JSON.stringify(e.map(function(e){return t.mgr.getCoordinate(e)})),Reflect.deleteProperty(a,"id"),t.$http.post("/api/zone/addZone",a,{"Content-Type":"application/json"})):(t.$message.error("地图不存在, 提交失败!"),Promise.reject("地图不存在"))}).then(function(){t.$message.success("添加成功"),t.refresh(t.page)}).catch(console.log).finally(function(){t.mgr&&t.mgr.remove(t.form.name),t.$refs.form.resetFields()})}},{key:"assemble",value:function(e){var t=Date.now(),a={id:0,position:e,name:this.form.name,enable:this.form.open?1:0,createTime:t,updateTime:t,mode:this.form.mode,group:""};return this.form.group1&&this.form.group2&&(a.group=this.form.group1+","+this.form.group2),a}},{key:"formHeight",get:function(){return"calc(".concat(100/this.$store.state.rootScale,"vh - 500px)")}}]),t}(Object(d["c"])(b["a"],h["a"]));v=m["a"]([d["b"]],v);var g=v,y=g,x=a("b1fa"),$=a("2877");function k(e){this["$style"]=x["default"].locals||x["default"]}var w=Object($["a"])(y,o,r,!1,k,null,null);t["default"]=w.exports},fca0:function(e,t,a){var o=a("5ca1"),r=a("7726").isFinite;o(o.S,"Number",{isFinite:function(e){return"number"==typeof e&&r(e)}})}}]);
//# sourceMappingURL=system.84d6157e.js.map