<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>数据展示</title>
		<link rel="stylesheet" href="../../../../public/css/bootstrap.min.css">

		<link rel="stylesheet" type="text/css" href="../../../../public/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../public/css/style.css" />
		<link rel="stylesheet" type="text/css" href="../public/fSelect.css" />
		<link rel="stylesheet" type="text/css" href="../public/dataObj.css" />
		<style type="text/css">
			#echartCont>div>div {
				height: 500px;
				padding: 0;
			}
			
			.left_silde>ul,
			#fengMap {
				height: auto;
			}
			
			.fenmapcont {
				margin-top: -200px;
			}
		</style>
	</head>

	<body>
		<div id="header" class="clearfix">

		</div>
		<div class="" id="echartCont" style="overflow: hidden">
			<div id="" class="clearfix" style="    overflow: hidden;">
				<div id="" class="col-xs-3" style="background:#b1b1b1;">
					<div id="" class="clearfix" style="">
						<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
							<legend>监控信息：图表</legend>
						</fieldset>
						<div class="chartCont listhide">
							<div class="">
								<div id="main" class=" text-center" style="width: ;height:400px;">

								</div>

							</div>
						</div>
					</div>
				</div>

				<div id="" class="col-xs-6" style="background: #01AAED;">
					<div class="fenmapcont">
						<div class="operating">
							<button class="btn btn-default" id="showData">显示数据热力图</button>
							<button class="btn btn-default btn-primary" id="2D">2D</button>
							<button class="btn btn-default " id="3D">3D</button>
						</div>
						<div class="fenmap " id="fengMap"></div>
					</div>
				</div>

				<div id="rightDom" class="col-xs-3" style="background: #245269;">

				</div>
				<style type="text/css">
					#rightDom {
						background: #b1b1b1 !important;
					}
					
					.operating {
						position: absolute;
						top: 7px;
						right: 18px;
					}
				</style>
			</div>
			<div id="" class="clearfix">
				<div id=" " class="col-xs-3">

				</div>
				<div class="col-xs-6" id="Characteristics">

				</div>
				<div id="" class="col-xs-3">
					<div class="" style="background:#b1b1b1;padding: 10px;height: 500px;">
						<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
							<legend>监控信息：记录</legend>
						</fieldset>
						<ul class="layui-timeline listhide">
							<li class="layui-timeline-item">
								<i class="layui-icon layui-timeline-axis"></i>
								<div class="layui-timeline-content layui-text">
									<div class="layui-timeline-title">2018年5月3号 13：00 ，监控区域1设备损坏，需要紧急检查维修。 </div>
								</div>
							</li>
							<li class="layui-timeline-item">
								<i class="layui-icon layui-timeline-axis"></i>
								<div class="layui-timeline-content layui-text">
									<div class="layui-timeline-title">2018年5月4号 13：00 ，监控区域1，监控人员XX，在该区域F地区越界警告，</div>
								</div>
							</li>
							<li class="layui-timeline-item">
								<i class="layui-icon layui-timeline-axis"></i>
								<div class="layui-timeline-content layui-text">
									<div class="layui-timeline-title">2018年5月4号 13：40 ，监控区域2，监控人员XX，穿过禁止通过通道</div>
								</div>
							</li>
							<li class="layui-timeline-item">
								<i class="layui-icon layui-timeline-axis"></i>
								<div class="layui-timeline-content layui-text">
									<div class="layui-timeline-title">2018年5月4号 14：00 ，监控区域2，监控人员XX，处于禁止区域，请负责人尽快处理</div>
								</div>
							</li>
							<li class="layui-timeline-item">
								<i class="layui-icon layui-timeline-axis"></i>
								<div class="layui-timeline-content layui-text">
									<div class="layui-timeline-title">2018年5月4号 14：40 ，监控区域2，监控人员XX，被负责人XX带回区域。</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<script src=" ../../../public/js/jquery.js"></script>
		<script src=" ../../../public/layui/layui.all.js" type="text/javascript" charset="utf-8"></script>
		<script src=" ../../../public/js/fengmap.min.js" type="text/javascript" charset="utf-8"></script>

		<script src=" ../../../public/echart/echarts.js"></script>
		<script src="../../red/js/header.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			// 区域数据统计
			var myChart = echarts.init(document.getElementById('main'));
			option = {
				title: {
					text: '区域标签数据统计',
					subtext: '数据实况',
					x: 'center',
					color: "#fff"
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a} <br/>{b} : {c} ({d}%)"
				},
				legend: {
					orient: 'vertical',
					left: 'left',
					data: ['经理室', '会议室', '办公区域', '前厅', '休息室']
				},
				series: [{
					name: '标签数量',
					type: 'pie',
					radius: '55%',
					center: ['50%', '60%'],
					data: [{
							value: 335,
							name: '经理室'
						},
						{
							value: 310,
							name: '会议室'
						},
						{
							value: 234,
							name: '办公区域'
						},
						{
							value: 135,
							name: '前厅'
						},
						{
							value: 1548,
							name: '休息室'
						}
					],
					itemStyle: {
						emphasis: {
							shadowBlur: 10,
							shadowOffsetX: 0,
							shadowColor: 'rgba(0, 0, 0, 0.6)'
						}
					}
				}]
			};

			myChart.setOption(option);
			// 地图展示
			var map;
			var map = null;
			//热力图实例
			var heatmapInstance = null;
			var randomHeatmap = false;
			var dataHeatmap = false;
			var groupLayer;
			window.onload = function() {

				var fmapID = 'huijinguangchang';
				//				var addmap=	 setTimeout(function(){
				var urls = $("#myheaderimg").attr("src");
				map = new fengmap.FMMap({
					//渲染dom
					container: document.getElementById('fengMap'),
					//地图数据位置
					mapServerURL: '../../../public/data/huijinguangchang/',
					//主题数据位置
					mapThemeURL: '../../../public/data/theme',
					//设置主题
					defaultThemeName: 'huijinguangchang',
					// 默认比例尺级别设置为20级
					defaultMapScaleLevel: 21,
					//开启2维，3维切换的动画显示
					viewModeAnimateMode: true,
					//开发者申请应用下web服务的key
					key: '83a75157d56ffe85317ed7ba1e8120ff',
					//开发者申请应用名称
					appName: 'hunjingguanchang'
					// mapScaleRange: [200, 4000],？
				});
				map.viewMode = fengmap.FMViewMode.MODE_2D
				//打开Fengmap服务器的地图数据和主题
				map.openMapById(fmapID);
				//添加热力图方法,根据json文件
				function createDtataHeatmap(map, groupID, data) {
					// 创建热力图对象
					if(!heatmapInstance) heatmapInstance = fengmap.FMHeatMap.create(map, {
						//热点半径
						radius: 10,
						//热力图透明度
						opacity: .5,
						//热力点value的最大值
						max: 100,
						//渐变色值，可配置
						gradient: {
							0.45: "rgb(201,135,255)",
							0.55: "rgb(189,97,255)",
							0.65: "rgb(155,49,255)",
							0.95: "yellow",
							1.0: "rgb(157,53,255)"
						}
					});

					var heatmapPoints = data.points;
					//移除热力点
					heatmapInstance.clearPoints();
					heatmapInstance.addPoints(data.points);

					//热力图应用到哪一楼层
					groupLayer = map.getFMGroup(groupID);
					groupLayer.applyHeatMap(heatmapInstance);
					return;
				};

				//移除热力图
				function removeHeatmap() {
					groupLayer = map.getFMGroup(map.focusGroupID);
					groupLayer.removeHeatMap(heatmapInstance);
				}

				var aBtn = document.querySelectorAll('.btn');
			

				//显示数据热力图
				$("#showData").click(function() {
					console.log(dataHeatmap)
					dataHeatmap = !dataHeatmap;
					if(dataHeatmap) {
						$.getJSON('../public/heatmap.json', function(data) {
							createDtataHeatmap(map, map.focusGroupID, data);
						});
						randomHeatmap = false;
						this.classList.add('btn-primary');
						$(this).html("清除热力图")
					} else {
						removeHeatmap();
						this.classList.remove('btn-primary');
						$(this).html("显示数据热力图")
					}
				})
				$("#2D").click(function() {
					map.viewMode = fengmap.FMViewMode.MODE_2D;
					$(this).addClass('btn-primary');
					$("#3D").removeClass('btn-primary');
				})
				$("#3D").click(function() {
					map.viewMode = fengmap.FMViewMode.MODE_3D;
					$(this).addClass('btn-primary');
					$("#2D").removeClass('btn-primary');
				})
			};

			//
			var mayChart2 = echarts.init(document.getElementById('rightDom'));
			option2 = {
				title: {
					text: '区域标签数据统计',
					subtext: '数据实况',
					x: 'bottom',
					color: "#fff"
				},
				tooltip: {
					trigger: 'axis',
					axisPointer: { // 坐标轴指示器，坐标轴触发有效
						type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
					}
				},
				legend: {
					data: ['设备报警', '区域报警', 'SOS报警', '健康报警']
				},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				xAxis: {
					type: 'value'
				},
				yAxis: {
					type: 'category',
					data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
				},
				series: [{
						name: '设备报警',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						barWidth: 30,
						barMinHeight: 20,
						data: [320, 302, 301, 334, 390, 330, 320]
					},
					{
						name: '区域报警',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [120, 132, 101, 134, 90, 230, 210]
					},
					{
						name: '健康报警',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [220, 182, 191, 234, 290, 330, 310]
					},
					{
						name: 'SOS报警',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [150, 212, 201, 154, 190, 330, 410]
					}
				]
			};
			mayChart2.setOption(option2)
		</script>
		<script type="text/javascript">
			var dom = document.getElementById("Characteristics");
			var myChart = echarts.init(dom);
			var app = {};
			option = null;
			var dataBJ = [
				[1, 55, 9, 56, 0.46, 18, 6, "良"],
				[2, 25, 11, 21, 0.65, 34, 9, "优"],
				[3, 56, 7, 63, 0.3, 14, 5, "良"],
				[4, 33, 7, 29, 0.33, 16, 6, "优"],
				[5, 42, 24, 44, 0.76, 40, 16, "优"],
				[6, 82, 58, 90, 1.77, 68, 33, "良"],
				[7, 74, 49, 77, 1.46, 48, 27, "良"],
				[8, 78, 55, 80, 1.29, 59, 29, "良"],
				[9, 267, 216, 280, 4.8, 108, 64, "心率超出"],
				[10, 185, 127, 216, 2.52, 61, 27, "心率超出"],
				[11, 39, 19, 38, 0.57, 31, 15, "优"],
				[12, 41, 11, 40, 0.43, 21, 7, "优"],
				[13, 64, 38, 74, 1.04, 46, 22, "良"],
				[14, 108, 79, 120, 1.7, 75, 41, "心率较高"],
				[15, 108, 63, 116, 1.48, 44, 26, "心率较高"],
				[16, 33, 6, 29, 0.34, 13, 5, "优"],
				[17, 94, 66, 110, 1.54, 62, 31, "良"],
				[18, 186, 142, 192, 3.88, 93, 79, "心率高"],
				[19, 57, 31, 54, 0.96, 32, 14, "良"],
				[20, 22, 8, 17, 0.48, 23, 10, "优"],
				[21, 39, 15, 36, 0.61, 29, 13, "优"],
				[22, 94, 69, 114, 2.08, 73, 39, "良"],
				[23, 99, 73, 110, 2.43, 76, 48, "良"],
				[24, 31, 12, 30, 0.5, 32, 16, "优"],
				[25, 42, 27, 43, 1, 53, 22, "优"],
				[26, 154, 117, 157, 3.05, 92, 58, "心率较高"],
				[27, 234, 185, 230, 4.09, 123, 69, "心率超出"],
				[28, 160, 120, 186, 2.77, 91, 50, "心率高"],
				[29, 134, 96, 165, 2.76, 83, 41, "心率较高"],
				[30, 52, 24, 60, 1.03, 50, 21, "良"],
				[31, 46, 5, 49, 0.28, 10, 6, "优"]
			];

			var dataGZ = [
				[1, 26, 37, 27, 1.163, 27, 13, "优"],
				[2, 85, 62, 71, 1.195, 60, 8, "良"],
				[3, 78, 38, 74, 1.363, 37, 7, "良"],
				[4, 21, 21, 36, 0.634, 40, 9, "优"],
				[5, 41, 42, 46, 0.915, 81, 13, "优"],
				[6, 56, 52, 69, 1.067, 92, 16, "良"],
				[7, 64, 30, 28, 0.924, 51, 2, "良"],
				[8, 55, 48, 74, 1.236, 75, 26, "良"],
				[9, 76, 85, 113, 1.237, 114, 27, "良"],
				[10, 91, 81, 104, 1.041, 56, 40, "良"],
				[11, 84, 39, 60, 0.964, 25, 11, "良"],
				[12, 64, 51, 101, 0.862, 58, 23, "良"],
				[13, 70, 69, 120, 1.198, 65, 36, "良"],
				[14, 77, 105, 178, 2.549, 64, 16, "良"],
				[15, 109, 68, 87, 0.996, 74, 29, "心率较高"],
				[16, 73, 68, 97, 0.905, 51, 34, "良"],
				[17, 54, 27, 47, 0.592, 53, 12, "良"],
				[18, 51, 61, 97, 0.811, 65, 19, "良"],
				[19, 91, 71, 121, 1.374, 43, 18, "良"],
				[20, 73, 102, 182, 2.787, 44, 19, "良"],
				[21, 73, 50, 76, 0.717, 31, 20, "良"],
				[22, 84, 94, 140, 2.238, 68, 18, "良"],
				[23, 93, 77, 104, 1.165, 53, 7, "良"],
				[24, 99, 130, 227, 3.97, 55, 15, "良"],
				[25, 146, 84, 139, 1.094, 40, 17, "心率较高"],
				[26, 113, 108, 137, 1.481, 48, 15, "心率较高"],
				[27, 81, 48, 62, 1.619, 26, 3, "良"],
				[28, 56, 48, 68, 1.336, 37, 9, "良"],
				[29, 82, 92, 174, 3.29, 0, 13, "良"],
				[30, 106, 116, 188, 3.628, 101, 16, "心率较高"],
				[31, 118, 50, 0, 1.383, 76, 11, "心率较高"]
			];

			var dataSH = [
				[1, 91, 45, 125, 0.82, 34, 23, "良"],
				[2, 65, 27, 78, 0.86, 45, 29, "良"],
				[3, 83, 60, 84, 1.09, 73, 27, "良"],
				[4, 109, 81, 121, 1.28, 68, 51, "心率较高"],
				[5, 106, 77, 114, 1.07, 55, 51, "心率较高"],
				[6, 109, 81, 121, 1.28, 68, 51, "心率较高"],
				[7, 106, 77, 114, 1.07, 55, 51, "心率较高"],
				[8, 89, 65, 78, 0.86, 51, 26, "良"],
				[9, 53, 33, 47, 0.64, 50, 17, "良"],
				[10, 80, 55, 80, 1.01, 75, 24, "良"],
				[11, 117, 81, 124, 1.03, 45, 24, "心率较高"],
				[12, 99, 71, 142, 1.1, 62, 42, "良"],
				[13, 95, 69, 130, 1.28, 74, 50, "良"],
				[14, 116, 87, 131, 1.47, 84, 40, "心率较高"],
				[15, 108, 80, 121, 1.3, 85, 37, "心率较高"],
				[16, 134, 83, 167, 1.16, 57, 43, "心率较高"],
				[17, 79, 43, 107, 1.05, 59, 37, "良"],
				[18, 71, 46, 89, 0.86, 64, 25, "良"],
				[19, 97, 71, 113, 1.17, 88, 31, "良"],
				[20, 84, 57, 91, 0.85, 55, 31, "良"],
				[21, 87, 63, 101, 0.9, 56, 41, "良"],
				[22, 104, 77, 119, 1.09, 73, 48, "心率较高"],
				[23, 87, 62, 100, 1, 72, 28, "良"],
				[24, 168, 128, 172, 1.49, 97, 56, "心率高"],
				[25, 65, 45, 51, 0.74, 39, 17, "良"],
				[26, 39, 24, 38, 0.61, 47, 17, "优"],
				[27, 39, 24, 39, 0.59, 50, 19, "优"],
				[28, 93, 68, 96, 1.05, 79, 29, "良"],
				[29, 188, 143, 197, 1.66, 99, 51, "心率高"],
				[30, 174, 131, 174, 1.55, 108, 50, "心率高"],
				[31, 187, 143, 201, 1.39, 89, 53, "心率较高"]
			];

			var schema = [{
					name: 'date',
					index: 0,
					text: '日'
				},
				{
					name: 'BMI',
					index: 1,
					text: 'BMI指数'
				},
				{
					name: '心率',
					index: 2,
					text: '心率'
				},
				{
					name: 'PM10',
					index: 3,
					text: 'PM10'
				},
				{
					name: 'CO',
					index: 4,
					text: '一氧化碳（CO）'
				},
				{
					name: 'NO2',
					index: 5,
					text: '二氧化氮（NO2）'
				},
				{
					name: 'SO2',
					index: 6,
					text: '血氧'
				}
			];

			var itemStyle = {
				normal: {
					opacity: 0.8,
					shadowBlur: 10,
					shadowOffsetX: 0,
					shadowOffsetY: 0,
					shadowColor: 'rgba(0, 0, 0, 0.5)'
				}
			};

			option = {
				title: {
					text: '健康指数监控统计(BMI)',
					subtext:"心率实时更新",
					x: 'center',
					textStyle: {
						color:"#fff"
					}
				},
				backgroundColor: '#b1b1b1',
				color: [
					'#dd4444', '#fec42c', '#80F1BE'
				],
				legend: {
					y: 'bottom',
					data: ['A000015', 'B00005', 'B00001'],
					textStyle: {
						color: '#fff',
						fontSize: 16
					}
				},
				grid: {
					x: '10%',
					x2: 150,
					y: '18%',
					y2: '10%'
				},
				tooltip: {
					padding: 10,
					backgroundColor: '#222',
					borderColor: '#777',
					borderWidth: 1,
					formatter: function(obj) {
						var value = obj.value;
						return '<div style="border-bottom: 1px solid rgba(255,255,255,.3); font-size: 18px;padding-bottom: 7px;margin-bottom: 7px">' +
							obj.seriesName + ' ' + value[0] + '日：' +
							value[7] +
							'</div>' +
							schema[2].text + '：' + value[2] + '<br>' +
							schema[6].text + '：' + value[6] + '<br>';
					}
				},
				xAxis: {
					type: 'value',
					name: '日期',
					nameGap: 16,
					nameTextStyle: {
						color: '#fff',
						fontSize: 14
					},
					max: 31,
					splitLine: {
						show: false
					},
					axisLine: {
						lineStyle: {
							color: '#eee'
						}
					}
				},
				yAxis: {
					type: 'value',
					name: 'BMI指数',
					nameLocation: 'end',
					nameGap: 20,
					nameTextStyle: {
						color: '#fff',
						fontSize: 16
					},
					axisLine: {
						lineStyle: {
							color: '#eee'
						}
					},
					splitLine: {
						show: false
					}
				},
				visualMap: [{
						left: 'right',
						top: '10%',
						dimension: 2,
						min: 0,
						max: 250,
						itemWidth: 30,
						itemHeight: 120,
						calculable: true,
						precision: 0.1,
						text: ['圆形大小：心率'],
						textGap: 30,
						textStyle: {
							color: '#fff'
						},
						inRange: {
							symbolSize: [10, 70]
						},
						outOfRange: {
							symbolSize: [10, 70],
							color: ['rgba(255,255,255,.2)']
						},
						controller: {
							inRange: {
								color: ['#c23531']
							},
							outOfRange: {
								color: ['#444']
							}
						}
					},
					{
						left: 'right',
						bottom: '5%',
						dimension: 6,
						min: 0,
						max: 50,
						itemHeight: 120,
						calculable: true,
						precision: 0.1,
						text: ['明暗：血氧'],
						textGap: 30,
						textStyle: {
							color: '#fff'
						},
						inRange: {
							colorLightness: [1, 0.5]
						},
						outOfRange: {
							color: ['rgba(255,255,255,.2)']
						},
						controller: {
							inRange: {
								color: ['#c23531']
							},
							outOfRange: {
								color: ['#444']
							}
						}
					}
				],
				series: [{
						name: 'A000015',
						type: 'scatter',
						itemStyle: itemStyle,
						data: dataBJ
					},
					{
						name: 'B00005',
						type: 'scatter',
						itemStyle: itemStyle,
						data: dataSH
					},
					{
						name: 'B00001',
						type: 'scatter',
						itemStyle: itemStyle,
						data: dataGZ
					}
				]
			};;
			if(option && typeof option === "object") {
				myChart.setOption(option, true);
			}
		</script>
	</body>

</html>