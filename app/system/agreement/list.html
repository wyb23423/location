<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../../../public/css/bootstrap.min.css">

		<link rel="stylesheet" type="text/css" href="../../../public/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="../../../public/css/style.css" />

		<link rel="stylesheet" type="text/css" href="../../../public/css/bootstrap-table.css" />
		<style type="text/css">
			.layui-border-box {
				width: 100% !important;
				margin: 0;
			}
			
			.layui-table-body {
				background: #FFFFFF;
			}
			
			.laytable-cell-1-department {
				width: 80px !important;
			}
			
			#table tbody tr td {
				vertical-align: middle;
			}
		</style>
	</head>

	<body class="clearfix">
		<div class="haderNav">
			<div id="header">

			</div>

		</div>
		<div class="content">
			<div class="left_silde layui-col-xs1">
				<ul class="layui-nav layui-nav-tree layui-inline" lay-filter="demo" style="width: 100%;">
					<li class="layui-nav-item  ">
							<a href="../area/area.html">区域选择</a>
						</li>
						<li class="layui-nav-item ">
							<a href="../navLink/navlinkIndex.html">路线规划</a>
						</li>
						<li class="layui-nav-item ">
							<a href="../confi/index.html">基站配置</a>
						</li>
						<li class="layui-nav-item ">
							<a href="javascript:;">摄像头</a>
							<dl class="layui-nav-child">
								<dd class="">
									<a href="../camera/index.html">摄像头添加</a>
								</dd>
								<dd>
									<a href="../camera/cameralist.html">摄像头列表</a>
								</dd>

							</dl>
						</li>


						<li class="layui-nav-item   ">
								<a href="../upMap/upmap.html">地图添加</a>
                        </li>
                        <li class="layui-nav-item  layui-nav-itemed ">
							<a href="javascript:;">协议</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="index.html">协议添加</a>
								</dd>
								<dd class="layui-this">
									<a href="list.html">协议列表</a>
								</dd>
								<dd>
									<a href="config.html">协议配置</a>
								</dd>

							</dl>
						</li>
				</ul>
			</div>
			<div id=" " class="min layui-col-xs11">

				<div class="minCont">

					<div class=" body-content" style="padding-top:50px;">
						<div class="panel panel-default">
							<div class="panel-heading">摄像头</div>
							<table id="test" lay-filter="test"></table>
							<script type="text/html" id="demo">
								<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
								<!--<a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit">配置</a>-->
							</script>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src=" ../../../public/js/jquery.js"></script>
		<script src="../../red/js/header.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../public/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../public/js/bootstrap-table.js" type="text/javascript" charset="utf-8"></script>

		<script src=" ../../../public/layuis/layui.js" type="text/javascript" charset="utf-8"></script>

		<script src=" ../../../public/layui/layui.all.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var datas = [];
			layui.use('table', function() {
				var table = layui.table;
				table.render({
					elem: '#test',
					url: '/api/protocol/getall',
					toolbar: '#toolbarDemo',
					request: {
						pageName: 'currentPage' //页码的参数名称，默认：page
							,
						limitName: 'pageSize' //每页数据量的参数名，默认：limit
					},
					parseData: function(res) { //res 即为原始返回的数据
						var rows = res.pagedData.datas;

						if(res.success == true) {
							res.success = 0
						};
						for(var a = 0; a < rows.length; a++) {

							console.log(rows[a])
							datas.push(rows[a])

						}
						return {
							"code": res.success, //解析接口状态
							"msg": res.message, //解析提示文本
							"count": res.pagedData.totalCount, //解析数据长度
							"data": datas //解析数据列表
						};
					},
					done: function(res, curr, count) {
						console.log(res)
					},
					title: '用户数据表',
					totalRow: true,
					cols: [
						[{
								field: 'id',
								title: 'ID',
								align: "center",
								width: "7%",
								templet: '#camearid'
							}, {
								field: 'name',
								title: '协议名称',
								align: "center",
								width: "16%",
								templet: '#ip',
							}, {
								field: 'port',
								align: "center",
								title: '协议端口号',
								width: "10%",
								templet: '#port'

							}, {
								align: "center",
								field: 'effect',
								title: '协议作用',
								templet: '#group_code'

							},
							{
								field: 'content',
								align: "center",
								title: '协议内容',
								
								templet: '#username'

							},
							{
								fixed: 'right',
								align: "center",
								title: '操作',
								width: "16%",
								toolbar: '#demo'
							}
						]
					]
				});
				table.on('tool(test)', function(obj) {
					var data = obj.data;
					if(obj.event === 'del') {

						layer.confirm('真的删除行么', function(index) {
							DeleteBook(data.id)
							layer.close(index);
						});
					} else if(obj.event === 'edit') {
						EditBook(data.id)
					}
				});
				//工具栏事件
				table.on('toolbar(test)', function(obj) {
					var checkStatus = table.checkStatus(obj.config.id);
					switch(obj.event) {
						case 'getCheckData':
							var data = checkStatus.data;
							layer.alert(JSON.stringify(data));
							break;
						case 'getCheckLength':
							var data = checkStatus.data;
							layer.msg('选中了：' + data.length + ' 个');
							break;
						case 'isAll':
							layer.msg(checkStatus.isAll ? '全选' : '未全选')
							break;
					};
				});
			});

			function EditBook(id) {
				alert("是否编辑设备：ID" + id);
				console.log(this)
				$("#exampleModal").modal("toggle")
				tagid = id

			}
			//删除操作
			function DeleteBook(id) {
				$.ajax({
					url: "/api/protocol/deleteProtocol?id=" + id,
					type: "post",
					contentType: "application/json",
					data: {
						id: id
					},
					success: function(red) {
						console.log(red)
						if(red.success == true) {
							alert(red.message)

							location.reload();
						} else {
							alert("服务繁忙，请重试")
						}
					}
				})

			}
		</script>
	</body>

</html>