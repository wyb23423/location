<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../../../public/css/bootstrap.min.css">

		<link rel="stylesheet" type="text/css" href="../../../public/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="../../../public/css/style.css" />
		<style type="text/css">
			.layui-border-box {
				width: 100% !important;
				margin: 0;
			}
			
			.layui-table-body {
				background: #FFFFFF;
			}
			
			.layui-upload-list {
				width: 34%;
				min-height: 165px;
				/*background: #c2c2c2;*/
			}
			
			.layui-upload-list>img {
				width: 100%;
			}
		</style>
	</head>

	<body class="clearfix">
		<div id="header">

		</div>

		<div class="content">
			<div class="left_silde layui-col-xs1">
				<ul class="layui-nav layui-nav-tree layui-inline" lay-filter="demo" style="width: 100%;">
					<li class="layui-nav-item  ">
						<a href="../area/area.html">电子围栏</a>
						</li>
						<li class="layui-nav-item ">
							<a href="../navLink/navlinkIndex.html">路线规划</a>
						</li>
						<li class="layui-nav-item ">
							<a href="../confi/index.html">基站配置</a>
						</li>
						<li class="layui-nav-item layui-nav-itemed">
							<a href="javascript:;">摄像头</a>
							<dl class="layui-nav-child">
								<dd class="">
									<a href="../camera/index.html">摄像头添加</a>
								</dd>
								<dd>
									<a href="../camera/cameralist.html">摄像头列表</a>
								</dd>

							</dl>
						</li>

						<li class="layui-nav-item   ">
								<a href="../upMap/upmap.html">地图添加</a>
						</li>
						<li class="layui-nav-item   ">
							<a href="javascript:;">协议</a>
							<dl class="layui-nav-child">
								<dd >
									<a href="../agreement/index.html">协议添加</a>
								</dd>
								<dd>
									<a href="../agreement/list.html">协议列表</a>
								</dd>
								<dd>
									<a href="../agreement/config.html">下发协议</a>
								</dd>

							</dl>
						</li>
				</ul>
			</div>
			<div id=" " class="min layui-col-xs11">
				<div class="minCont" style="padding-top: 3%;">
					<div class="listIcon formCont">
						<form class="layui-form" action="">
							<div class="flist" style="margin-bottom: 3%;">
								<h3 style="color: #009688;">摄像头添加</h3>
							</div>

							<div class="layui-form-item">
								<div class="layui-inline">
									<label class="layui-form-label">摄像头IP：</label>
									<div class="layui-input-inline">
										<input type="text" name="ip" lay-verify="required" autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-inline">
									<label class="layui-form-label">设备端口号：</label>
									<div class="layui-input-inline">
										<input type="text" name="port" lay-verify="required" autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-inline">
									<label class="layui-form-label">用户名：</label>
									<div class="layui-input-inline">
										<input type="text" name="username" lay-verify="required" autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-inline">
									<label class="layui-form-label">密码：</label>
									<div class="layui-input-inline">
										<input type="text" name="password" lay-verify="required" autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>

							<div class="layui-form-item">
								<div class="layui-inline" style="width: 100%;">
									<label class="layui-form-label" style="    width: 9.7%;">窗口分割数</label>
									<div class="layui-input-inline" style="width: 25%;">
										<select name="window_split">
											<option value="1">1X1</option>
											<option value="2">2X2</option>
											<option value="3">3X3</option>
											<option value="4">4X4</option>
										</select>
									</div>

								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-inline">
									<label class="layui-form-label">所在组号：</label>
									<div class="layui-input-inline">
										<input type="text" name="group_code"  autocomplete="off" class="layui-input">
									</div>
								</div>
							</div>

							<div class="layui-form-item" style="margin-top: 60px;">
								<div class="layui-input-block">
									<button class="layui-btn" lay-submit="" lay-filter="demo1" id="testListAction">立即提交</button>
									<button type="reset" class="layui-btn layui-btn-primary">重置</button>
								</div>
							</div>

						</form>
					</div>

				</div>
			</div>

		</div>

		<style type="text/css">
			
		</style>
		<script src=" ../../../public/js/jquery.js"></script>
		<script src="../../red/js/header.js" type="text/javascript" charset="utf-8"></script>
		<script src=" ../../../public/layui/layui.all.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../lib/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var urls = "/api/camera/addCamera";
			var imgurls = "";
			layui.use('upload', function() {
				var $ = layui.jquery,
					upload = layui.upload;

				//普通图片上传
				var uploadInst = upload.render({
					elem: '#test1',
					url: urls,
					bindAction: "upImg",
					before: function(obj) {
						var files = obj.pushFile();
						//预读本地文件示例，不支持ie8
						obj.preview(function(index, file, result) {
							imgurls = result
							console.log(file)
							$('#image').attr('src', result); //图片链接（base64）
						});

					},
					done: function(res) {}
				});

			});

			layui.use(['form', 'layedit', 'laydate'], function() {
				var form = layui.form,
					layer = layui.layer;
				form.on('submit(demo1)', function(data) {
					var Dat = new Date();
					var timestamp = new Date().getTime();
					var formeInfo = data.field;
					var create_use = $("#adminName .Idname").text();
					console.log(create_use)
					var data = {
						"createTime": timestamp,
						"createUser":create_use,
						"group_code": formeInfo.group_code,
						"ip":formeInfo.ip,
						"password": formeInfo.password,
						"port": formeInfo.port,
						"updateTime": timestamp,
						"updateUser": create_use,
						"username":formeInfo.username,
						"windowSplit": formeInfo.window_split

					};

					console.log(data)
					var data = JSON.stringify(data);

					postAjax(urls, data)

					return false;
				});
				//表单初始赋值

			});

			function postAjax(urls, data) {
				var contentType = "application/json;charset=UTF-8";
				console.log(data)
				$.ajax({
					type: "post",
					url: urls,
					async: true,
					data: data,
					contentType: contentType,
					success: function(red) {
						var cobackInfo = red.success;
						if(cobackInfo == true) {
							var ii = layer.load();
							//此处用setTimeout演示ajax的回调
							setTimeout(function() {
								layer.close(ii);
								layer.msg('添加成功');
								$(window).scrollTop(0);

								//
								//								window.location.href="anchornumInfo.html?id="+data.id
							}, 1000);
							setTimeout(function() {

																location.reload();

							}, 2000)
						}
					},
					error: function() {
						console.log("err")
						var ii = layer.load();
						//此处用setTimeout演示ajax的回调
						setTimeout(function() {
							layer.close(ii);
							layer.msg('添加失败，请重新填写');
							//							location.reload();
						}, 1000);
						setTimeout(function() {
														location.reload();
						}, 1000)
					}
				});
			}
		</script>
	</body>

</html>