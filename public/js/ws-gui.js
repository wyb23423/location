!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WsGui=e():t.WsGui=e()}(this,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){"use strict";t.exports=function(){return r(1)('!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";t.r(r);var n=function(){return(n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};function a(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,u=t.call(e),i=[];try{for(;(void 0===r||0<r--)&&!(n=u.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=u.return)&&t.call(u)}finally{if(a)throw a.error}}return i}function u(e,r){var t=new Map;return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var u=n.join(":");return t.has(u)||(r&&t.size>=r&&t.delete(t.keys().next().value),t.set(u,e.apply(null,n))),t.get(u)}}var i=u(function(e){return e.replace(/[-_]+(\\w)/g,function(e,r){return r.toUpperCase()})});u(function(e,r){return void 0===r&&(r="-"),e.replace(/[A-Z]/g,function(e){return r+e.toLowerCase()})}),new Set;"constructor prototype name".split(" ");var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(e){return(e=Math.round(e))<0?0:255<e?255:e}function c(e){return e<0?0:1<e?1:e}function s(e){return e.length&&"%"===e.charAt(e.length-1)?l(parseFloat(e)/100*255):l(parseInt(e,10))}function f(e){return e.length&&"%"===e.charAt(e.length-1)?c(parseFloat(e)/100):c(parseFloat(e))}function d(e,r,t){return t<0?t+=1:1<t&&(t-=1),6*t<1?e+(r-e)*t*6:2*t<1?r:3*t<2?e+(r-e)*(2/3-t)*6:e}function h(e){var r=(parseFloat(e[0])%360+360)%360/360,t=f(e[1]),n=f(e[2]),a=n<=.5?n*(t+1):n+t-n*t,u=2*n-a,i=[l(255*d(u,a,r+1/3)),l(255*d(u,a,r)),l(255*d(u,a,r-1/3)),1];return 4===e.length&&(i[3]=+e[3]),i}function g(e){return console.error(e+"不是有效的ccs颜色值"),[0,0,0,0]}u(function(e){if("string"!=typeof e||!e)return g(e);var r,t=e.replace(/ /g,"").toLowerCase();if(Reflect.has(o,t))return Array.from(Reflect.get(o,t));if(t.startsWith("#"))return 4===t.length?0<=(r=parseInt(t.substr(1),16))&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:g(t):7===t.length&&0<=(r=parseInt(t.substr(1),16))&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:g(t);var n=t.indexOf("("),a=t.indexOf(")");if(-1!==n&&a+1===t.length){var u=t.substr(0,n),i=t.substr(n+1,a-(n+1)).split(","),l=1;switch(u){case"rgba":if(4!==i.length)return g(t);l=f(i.pop());case"rgb":return 3!==i.length?g(t):[s(i[0]),s(i[1]),s(i[2]),l];case"hsla":return 4!==i.length?g(t):(i[3]=f(i[3])+"",h(i));case"hsl":return 3!==i.length?g(t):h(i)}}return g(t)},500);var p={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),-t*Math.pow(2,10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4))},elasticOut:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-r)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?t*Math.pow(2,10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4)*-.5:t*Math.pow(2,-10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4)*.5+1)},backIn:function(e){return e*e*(2.70158*e-1.70158)},backOut:function(e){return--e*e*(2.70158*e+1.70158)+1},backInOut:function(e){var r=2.5949095;return(e*=2)<1?e*e*((r+1)*e-r)*.5:.5*((e-=2)*e*((r+1)*e+r)+2)},bounceIn:function(e){return 1-p.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*p.bounceIn(2*e):.5*p.bounceOut(2*e-1)+.5}};self.addEventListener("message",function(e){var r=e.data,t=r.animation,n=function(e,r){var t,n,u={animation:e,isEnd:!1,attrs:new Map},i=Math.min(1,(r-e._startTime-e._pauseTime)/e.time);if(e._isPause)e._pauseTime+=r-e._prevTime;else try{for(var o=function(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}(e.el.entries()),l=o.next();!l.done;l=o.next()){var c=a(l.value,2),s=c[0],f=c[1];u.attrs.set(s,b(i,f,e))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r-e._startTime-e._pauseTime>e.time?(u.isEnd=!0,u):(e._prevTime=r,u)}(t,r.now);Reflect.deleteProperty(t,"el"),self.postMessage(n)});var y=["width","height","scaleX","scaleY","rotation","left","right","top","bottom","opacity","color","background","cellId"];function b(e,r,t){var a={},u=function(e){e=i(e);var r=Reflect.get(p,e);return"function"!=typeof r?(console.error("缓动函数"+e+"不存在"),p.linear):r}(t.easing);return y.forEach(function(i){var o=n({},Reflect.get(t,i));o[0]=null==o[0]?Reflect.get(r,i):o[0];var l=Object.keys(o).sort(function(e,r){return+e-+r}),c=l.findIndex(function(r){return e<=+r}),s=o[l[c]];if(null!=s){var f=o[l[c-1]],d=typeof s,h=typeof f;if(d===h){var g=1-(+l[c]-e)/(+l[c]-+l[c-1]);if(g=u(g),Array.isArray(s))s=s.map(function(e,r){return(e-f[r])*g+f[r]});else if("number"===d)s=(s-f)*g+f;else if("string"===d){var p=/^([\\+-]?\\d+)(.*)$/;s=p.test(s)?s.replace(p,function(e,r,n){var a=+parseFloat(f);return(p=new RegExp("^[\\\\+-]?\\\\d+"+n+"$")).test(f)||(m(i,t),a=0),(+r-a)*g+a+n}):0}}else"undefined"!==h&&m(i,t);Array.isArray(s)&&(s=function(e,r){if(e&&e.length){var t=e[0]+","+e[1]+","+e[2];return r+"("+(t+=","+e[3])+")"}}(s,"rgba")),Reflect.set(a,i,s)}}),a}function m(e,r){r.errKey.has(e)||(console.error("对属性"+e+"的设置存在类型不一样的设置"),r.errKey.add(e))}}]);\n//# sourceMappingURL=play.worker.d064b1d6.js.map',"workerworker/play.worker.d064b1d6.js")}},function(t,e,r){"use strict";var i=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var r;try{(r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),r=r.getBlob()}catch(e){r=new Blob([t])}return new Worker(i.createObjectURL(r))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(t){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},function(t,e,r){"use strict";r.r(e);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var o=function(){return(o=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function a(t,e,r,i){return new(r||(r=Promise))(function(n,o){function a(t){try{h(i.next(t))}catch(t){o(t)}}function s(t){try{h(i.throw(t))}catch(t){o(t)}}function h(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(a,s)}h((i=i.apply(t,e||[])).next())})}function s(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=0<(n=a.trys).length&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function l(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(i=o.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}function c(t,e){var r=new Map;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=i.join(":");return r.has(o)||(e&&r.size>=e&&r.delete(r.keys().next().value),r.set(o,t.apply(null,i))),r.get(o)}}var d=/\.(jpg|png|gif|jpeg)$/i;function f(t){return"string"==typeof t&&(d.test(t)||t.startsWith("data:image/"))}function p(t,e){var r=t.split(" ");return e&&(r=r.map(function(t){return t.toLowerCase()})),function(t){return e&&(t=t.toLowerCase()),r.includes(t)}}function y(t){return t>-Number.EPSILON&&t<Number.EPSILON}function g(t,e){for(var r=0,i=e-1,n=0;r<=i;){var o=t(n=Math.floor((i+r)/2));if(o<0)i=n-1;else{if(!(0<o))return n;r=n+1}}return r}c(function(t){return t.replace(/[-_]+(\w)/g,function(t,e){return e.toUpperCase()})}),c(function(t,e){return void 0===e&&(e="-"),t.replace(/[A-Z]/g,function(t){return e+t.toLowerCase()})});var v,m=new Set,b=(v=0,function(t){return m.has(t)&&(t=""+Date.now().toString(16)+v.toString(16).padStart(6,"0"),v++),m.add(t),t});p("constructor prototype name");var _=Math.max(window.devicePixelRatio||1,2),w=0;function x(t,e,r){var i=document.createElement("canvas");return Object.assign(i.style,{position:"absolute",left:0,top:0,width:t+"px",height:e+"px"}),i.setAttribute("data-dom-id",r||"canvas-"+w++),i.width=t*_,i.height=e*_,i}var M=c(function(){return document.createElement("canvas").getContext("2d")});function k(t,e){return"string"==typeof t?t.endsWith("%")?e*(parseFloat(t)||0)/100:(parseFloat(t)||0)*_:(t||0)*_}function P(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent?t.attachEvent("on"+e,r):t["on"+e]=r}function S(t,e,r){t.removeEventListener?t.removeEventListener(e,r,!1):t.detachEvent?t.detachEvent("on"+e,r):t["on"+e]=null}var T=function(){function t(){}return t.prototype.transform=function(t){},t.prototype.copy=function(t){return Object.assign(this,t),this},t.prototype.rotate=function(t){if(t){var e=Math.cos(t),r=Math.sin(t);this.transform([[e,-r,0],[r,e,0],[0,0,1]])}return this},t.prototype.scale=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),Array.isArray(t)&&(e=t[1],t=t[0]),1===t&&1===e||this.transform([[t,0,0],[0,e,0],[0,0,1]]),this},t.prototype.translate=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Array.isArray(t)&&(e=t[1],t=t[0]),(t||e)&&this.transform([[1,0,t],[0,1,e],[0,0,1]]),this},t}(),A=function(t){function e(e,r,i,n,o,a){void 0===e&&(e=1),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1),void 0===a&&(a=0);var s=t.call(this)||this;return s.a=e,s.c=r,s.e=i,s.b=n,s.d=o,s.f=a,s}return n(e,t),e.prototype.toUnit=function(){return this.a=this.d=1,this.c=this.e=this.b=this.f=0,this},e.prototype.toArray=function(){return[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]]},e.prototype.transform=function(t,r){t instanceof e&&(t=t.toArray());var i=this.toArray(),n=t,o=i;return r&&(n=i,o=t),this.a=n[0][0]*o[0][0]+n[0][1]*o[1][0],this.c=n[0][0]*o[0][1]+n[0][1]*o[1][1],this.e=n[0][0]*o[0][2]+n[0][1]*o[1][2]+n[0][2],this.b=n[1][0]*o[0][0]+n[1][1]*o[1][0],this.d=n[1][0]*o[0][1]+n[1][1]*o[1][1],this.f=n[1][0]*o[0][2]+n[1][1]*o[1][2]+n[1][2],this},e.prototype.invert=function(){var t=this.a*this.d-this.b*this.c||Number.EPSILON;return new e(this.d/t,-this.c/t,(this.c*this.f-this.d*this.e)/t,-this.b/t,this.a/t,(this.b*this.e-this.a*this.f)/t)},e}(T),C=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.w=r,this.h=i}return t.prototype.toArray=function(){return[[this.x,this.x+this.w,this.x+this.w,this.x],[this.y,this.y,this.y+this.h,this.y+this.h],[1,1,1,1]]},t.prototype.extend=function(t){var e=Math.min(t.x,this.x),r=Math.min(t.y,this.y);return this.w=Math.max(t.x+t.w,this.x+this.w)-e,this.h=Math.max(t.y+t.h,this.y+this.h)-r,this.x=e,this.y=r,this},t.prototype.transform=function(t){var e,r,i,n,o,a,s=this.toArray(),h=t.toArray();e=r=Number.MAX_VALUE,i=n=-Number.MAX_VALUE;for(var l=0;l<4;l++)o=h[0][0]*s[0][l]+h[0][1]*s[1][l]+h[0][2],a=h[1][0]*s[0][l]+h[1][1]*s[1][l]+h[1][2],e=Math.min(o,e),r=Math.min(a,r),i=Math.max(o,i),n=Math.max(a,n);return this.x=e,this.y=r,this.w=i-e,this.h=n-r,this},t.prototype.contain=function(t,e){return t>=this.x&&t<=this.x+this.w&&e>=this.y&&e<=this.y+this.h},t.prototype.intersect=function(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),e instanceof t&&(r=e.y,i=e.w,n=e.h,e=e.x);var o=this.x,a=this.x+this.w,s=this.y,h=this.y+this.h;return e<=a||o<=e+i||r<=h||s<=r+n},t.prototype.clone=function(){return new t(this.x,this.y,this.w,this.h)},t}(),O=new Map;function I(t){var e=O.get(t);e&&(e.count--,e.count<=0&&(e.image.onload=null,e.image.src="",O.delete(t)))}var E={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function R(t){return(t=Math.round(t))<0?0:255<t?255:t}function j(t){return t<0?0:1<t?1:t}function U(t){return t.length&&"%"===t.charAt(t.length-1)?R(parseFloat(t)/100*255):R(parseInt(t,10))}function z(t){return t.length&&"%"===t.charAt(t.length-1)?j(parseFloat(t)/100):j(parseFloat(t))}function L(t,e,r){return r<0?r+=1:1<r&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function W(t){var e=(parseFloat(t[0])%360+360)%360/360,r=z(t[1]),i=z(t[2]),n=i<=.5?i*(r+1):i+r-i*r,o=2*i-n,a=[R(255*L(o,n,e+1/3)),R(255*L(o,n,e)),R(255*L(o,n,e-1/3)),1];return 4===t.length&&(a[3]=+t[3]),a}function D(t){return console.error(t+"不是有效的ccs颜色值"),[0,0,0,0]}var q=c(function(t){if("string"!=typeof t||!t)return D(t);var e,r=t.replace(/ /g,"").toLowerCase();if(Reflect.has(E,r))return Array.from(Reflect.get(E,r));if(r.startsWith("#"))return 4===r.length?0<=(e=parseInt(r.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:D(r):7===r.length&&0<=(e=parseInt(r.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:D(r);var i=r.indexOf("("),n=r.indexOf(")");if(-1!==i&&n+1===r.length){var o=r.substr(0,i),a=r.substr(i+1,n-(i+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return D(r);s=z(a.pop());case"rgb":return 3!==a.length?D(r):[U(a[0]),U(a[1]),U(a[2]),s];case"hsla":return 4!==a.length?D(r):(a[3]=z(a[3])+"",W(a));case"hsl":return 3!==a.length?D(r):W(a)}}return D(r)},500);function B(t,e){if("string"!=typeof t||"string"!=typeof e)return t===e;var r=q(t),i=q(e);return r.every(function(t,e){return t===i[e]})}var V=p("rotation left top bottom right scale scaleX scaleY width height origin originX originY"),F=function(){function t(){this.color="rgba(0, 0, 0, 1)",this.border=0,this.borderColor="rgba(0, 0, 0, 1)",this.borderStyle=[],this.opacity=1,this.width="100%",this.height="100%",this.rotation=0,this.scale=[1,1],this.zIndex=0,this.clip=!1,this.origin=[.5,.5],this._res=new Set}return t.prototype.set=function(t,e){return"string"==typeof t?this.attr([t,e]):Object.entries(t).map(this.attr,this).includes(!0)},t.prototype.build=function(t,e,r){return a(this,void 0,void 0,function(){var i,n,o;return s(this,function(a){switch(a.label){case 0:return this.border&&(t.setLineDash(this.borderStyle),B(t.strokeStyle,this.borderColor)||(t.strokeStyle=this.borderColor),t.lineWidth!==this.border&&(t.lineWidth=this.border)),this.background?f(this.background)?(i=this.background,[4,this.loadImg(i)]):[3,2]:[3,3];case 1:return n=a.sent(),(o=t.createPattern(n,"no-repeat")).setTransform({a:e/n.width,d:r/n.height,b:0,c:0,e:0,f:0}),t.fillStyle=o,[3,3];case 2:B(t.fillStyle,this.background)||(t.fillStyle=this.background),a.label=3;case 3:return[2]}})})},t.prototype.setAlpha=function(t){var e=Math.max(0,Math.min(1,this.opacity));t.globalAlpha!==e&&(t.globalAlpha=e)},t.prototype.dispose=function(){this._res.forEach(I),this._res.clear()},t.prototype.equal=function(t,e){var r=Reflect.get(this,t);return null==r&&(r=Reflect.get(this,t.substr(0,t.length-1))),"border"===t&&(e*=_),Array.isArray(r)?Array.isArray(e)?("borderStyle"!==t||r.length===e.length)&&r.every(function(t,r){return t===e[r]}):t.endsWith("X")?r[0]===e:t.endsWith("Y")?r[1]===e:r.every(function(t){return t===e}):r===e},t.prototype.loadImg=function(t){if(void 0===t&&(t=this.src),!f(t))return console.warn(t+"不是有效的图片路径"),Promise.resolve(new Image);var e=!this._res.has(t);return this._res.add(t),function(t,e){void 0===e&&(e=!0);var r=O.get(t);if(r)return e&&r.count++,Promise.resolve(r.image);var i=new Image;return i.src=t,new Promise(function(e){i.onload=function(){O.set(t,{image:i,count:1}),e(i)},i.onerror=function(t){console.error(t)}})}(t,e)},t.prototype.attr=function(t){var e=l(t,2),r=e[0],i=e[1],n=V(r);switch(n&&(n=n&&!this.equal(r,i)),"src"!==r&&"background"!==r||"string"!=typeof i||f(i)||(i=function(t,e){if(t&&t.length){var r=t[0]+","+t[1]+","+t[2];return e+"("+(r+=","+t[3])+")"}}(q(i),"rgba")),r){case"borderRadius":this[r]=function(t){var e=new Array(4).fill(0);if(Array.isArray(t))switch(t.length){case 1:e[0]=e[1]=t[0];case 2:e[2]=e[0];case 3:e[3]=e[1];break;default:Object.assign(e,t)}else"number"==typeof t&&e.fill(t);return e}(i);break;case"scale":case"origin":this[r]=Array.isArray(i)?i:[i,i];break;case"scaleX":case"originX":case"scaleY":case"originY":this[r.substr(0,r.length-1)][r.endsWith("X")?0:1]=i;break;case"border":i*=_;default:Reflect.set(this,r,i)}return n},t}(),H=function(){function t(){this._handlers={}}return t.prototype.on=function(t,e){return(this._handlers[t]||(this._handlers[t]=new Set)).add(e),this},t.prototype.off=function(t,e){var r=this._handlers[t];return r&&r.delete(e),this},t.prototype.notify=function(t,e,r,i){var n=this._handlers[t];return n&&n.forEach(function(t){return t.call(i,r,e)}),r.cancelBubble},t.prototype.dispose=function(){this._handlers={}},t}();function X(t,e,r,i,n,o,a,s,h){if(Math.abs(i-n)>Number.EPSILON*Math.pow(2,10)){t.save();var l=n<i?1:i/n,u=n<i?n/i:1;t.translate(e,r),t.rotate(s),t.scale(l,u),t.arc(0,0,Math.max(i,n),o,a,!h),t.restore()}else t.arc(e,r,i,o,a,!h)}function N(t,e,r,i,n,o){var a,s,h,l,u,c;t.beginPath(),o?(a=t,s=e,h=r,l=i,u=n,c=o.map(function(t){var e=[t,t];return t<=1&&(e[0]*=l,e[1]*=u),e[0]=Math.min(e[0],l/2),e[1]=Math.min(e[1],u/2),e}),a.moveTo(s+l,h+c[1][1]),X(a,s+l-c[1][0],h+c[1][1],c[1][0],c[1][1],0,-Math.PI/2,0,0),.001<Math.abs(c[0][0]-l+c[1][0])&&a.lineTo(s+c[0][0],h),X(a,s+c[0][0],h+c[0][1],c[0][0],c[0][1],-Math.PI/2,Math.PI,0,0),.001<Math.abs(u-c[0][1]-c[3][1])&&a.lineTo(s,h+u-c[3][1]),X(a,s+c[3][0],h+u-c[3][1],c[3][0],c[3][1],Math.PI,Math.PI/2,0,0),.001<Math.abs(l-c[2][0]-c[3][0])&&a.lineTo(s+l-c[2][0],h+u),X(a,s+l-c[2][0],h+u-c[2][1],c[2][0],c[2][1],Math.PI/2,0,0,0),.001<Math.abs(c[1][1]-u+c[2][1])&&a.lineTo(s+l,h+c[1][1])):t.rect(e,r,i,n),t.closePath()}var Y=function(t){function e(e,r){void 0===e&&(e=0),void 0===r&&(r=e);var i=t.call(this)||this;return i.x=e,i.y=r,i}return n(e,t),e.createMin=function(t,r){return Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]),new e(Math.min.apply(Math,u(t)),Math.min.apply(Math,u(r)))},e.createMax=function(t,r){return Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]),new e(Math.max.apply(Math,u(t)),Math.max.apply(Math,u(r)))},e.prototype.toMin=function(t){return this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y),this},e.prototype.toMax=function(t){return this.x=Math.max(t.x,this.x),this.y=Math.max(t.y,this.y),this},e.prototype.transform=function(t){return t instanceof A&&(t=t.toArray()),this.x=t[0][0]*this.x+t[0][1]*this.y+t[0][2],this.y=t[1][0]*this.x+t[1][1]*this.y+t[1][2],this},e}(T),Z=function(){function t(t,e){void 0===e&&(e=!1),this.id=t,this.isStatic=e,this.type="element",this.index=0,this.transform=new A,this.events=new H,this.isVisible=!0,this.style=new F,this.origin=[0,0],this.width=0,this.height=0,this._needUpdate=!0,this._hadCalc=!1,this._parentWidth=0,this._parentHeight=0,this._ignore=!0,this._dirty=!0,this._checkedPoint=new Map,this.id=b(t)}return Object.defineProperty(t.prototype,"needUpdate",{get:function(){return this._needUpdate},set:function(t){this._needUpdate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},set:function(t){t!==this._animation&&(this._animation&&this._animation.el.delete(this),(this._animation=t)&&t.addElement(this))},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t;this.layer&&this.layer.remove(this,!1),this.parent&&this.parent.remove(this,!1),this.events.dispose(),this.style.dispose(),this._animation&&this._animation.el.delete(this),this._cached=this._animation=this.layer=this.parent=null,t=this.id,m.delete(t)},t.prototype.draw=function(t){return a(this,void 0,void 0,function(){var e,r,i;return s(this,function(n){switch(n.label){case 0:return this.beforeUpdate(),[4,this.getBoundingRect()];case 1:return n.sent(),this.afterUpdate(),(e=this.isPaint())?(this.beforeBuild(),this.isStatic||(this._cached=null),(i=(r=this)._cached)?[3,3]:[4,this.buildCached()]):[3,4];case 2:i=n.sent(),n.label=3;case 3:r._cached=i,this.setTransform(t),this.style.setAlpha(t),t.drawImage(this._cached,0,0,this._cached.width,this._cached.height),this.isStatic||(this._cached=null),t.setTransform(1,0,0,1,0,0),this.afterBuild(),n.label=4;case 4:return[2,e]}})})},t.prototype.attr=function(t,e){var r,i,n;"string"==typeof t&&((r={})[t]=e,t=r);var o=!0;try{for(var a=h(Object.entries(t)),s=a.next();!s.done;s=a.next()){var u=l(s.value,2),c=u[0],d=u[1];if(!this.style.equal(c,d)){o=!1;break}}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o||(this.style.set(t,e)&&(this.needUpdate=!0),this.markDirty()),this},t.prototype.getBoundingRect=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._needUpdate?[4,this.update()]:[3,2];case 1:t.sent(),this.rect=new C(0,0,this.width,this.height).transform(this.transform),this._needUpdate=!1,t.label=2;case 2:return[2,this.rect]}})})},t.prototype.markDirty=function(){this._dirty||(this._dirty=!0,this.parent&&this.parent.markDirty(),this.layer&&(this.layer.dirty=!0))},t.prototype.notifyEvent=function(t,e,r){var i=this.events.notify(t,e,r,this);i=i||["change","input","foucs","blur","scroll"].includes(t),this.parent&&!i&&this.parent.notifyEvent(t,e,r)},t.prototype.beforeUpdate=function(){this._ignore=!0},t.prototype.update=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._parentWidth=this._getBaseSize("width"),this._parentHeight=this._getBaseSize("height"),this.isStatic&&this._cached?[3,3]:this._hadCalc?[3,2]:[4,this.calcSize()];case 1:t.sent(),t.label=2;case 2:this.style.border=Math.min(this.style.border,this.width/2,this.height/2),this.style.border<0&&(this.style.border=0),this.origin[0]=this.style.origin[0]*this.width,this.origin[1]=this.style.origin[1]*this.height,t.label=3;case 3:return this.updateTransform(),this._checkedPoint.clear(),[2]}})})},t.prototype.afterUpdate=function(){this._dirty=this._hadCalc=!1},t.prototype.beforeBuild=function(){},t.prototype.build=function(t){return a(this,void 0,void 0,function(){var e,r,i;return s(this,function(n){switch(n.label){case 0:return e=this.style.border,r=this.width-e,i=this.height-e,N(t,0,0,r,i,this.style.borderRadius),[4,this.style.build(t,r,i)];case 1:return n.sent(),this.style.background&&t.fill(),e&&this.style.borderColor&&t.stroke(),[2]}})})},t.prototype.afterBuild=function(){this._ignore=!1},t.prototype.calcSize=function(){this.width=k(this.style.width,this._parentWidth),this.height=k(this.style.height,this._parentHeight),this._hadCalc=!0},t.prototype.updateTransform=function(){var t=this.style,e=this.left,r=this.top;if(null==e&&(e=null!=t.left?k(t.left,this._parentWidth):null!=t.right?this._parentWidth-k(t.right,this._parentWidth)-this.width:k("50%",this._parentWidth)-this.width/2),null==r&&(r=null!=t.top?k(t.top,this._parentHeight):null!=t.bottom?this._parentHeight-k(t.bottom,this._parentHeight)-this.height:k("50%",this._parentHeight)-this.height/2),this.transform.toUnit().translate(-this.origin[0],-this.origin[1]).scale(t.scale).rotate(t.rotation).translate(e+this.origin[0],r+this.origin[1]),this.parent){var i=this.parent;this.transform.translate(i.style.border,i.style.border).transform(i.transform)}},t.prototype.buildCached=function(t,e,r){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),void 0===r&&(r=new Y),a(this,void 0,void 0,function(){var i,n;return s(this,function(o){switch(o.label){case 0:return(i=document.createElement("canvas")).width=t,i.height=e,(n=i.getContext("2d")).translate(this.style.border/2+r.x,this.style.border/2+r.y),[4,this.build(n)];case 1:return o.sent(),[2,i]}})})},t.prototype.getTarget=function(t,e,r){return!!this._contain(t,e,r)&&this},t.prototype.setTransform=function(t){var e=(new A).copy(this.transform);this.parent&&e.transform(this.parent.transform.invert());var r=e.a,i=e.b,n=e.c,o=e.d,a=e.e,s=e.f;t.transform(r,i,n,o,a,s)},t.prototype.getParentSize=function(t){return"width"===t?this._parentWidth:"height"===t?this._parentHeight:0},t.prototype.isPaint=function(){if(this.isVisible&&this.style.opacity&&this.style.scale[0]&&this.style.scale[1]&&0<this.width&&0<this.height){var t=this.getParent(function(t){return t.style.clip});if(t)return this.rect.intersect(t.rect);var e=this.layer?this:this.getParent(function(t){return t.layer});return this.rect.intersect(0,0,e.getParentSize("width"),e.getParentSize("height"))}return!1},t.prototype._contain=function(t,e,r){if(this._ignore)return!1;var i=e+"_"+r;if(this._checkedPoint.has(i))return this._checkedPoint.get(i);if(this.rect&&!this.rect.contain(e,r))return this._checkedPoint.set(i,!1),!1;var n=this.getParent(function(t){return t.style.clip});if(n){var o=n.style.border;if(t.setTransform(n.transform),t.translate(o,o),N(t,0,0,n.width-2*o,n.height-2*o,n.style.borderRadius),!t.isPointInPath(e,r))return t.setTransform(1,0,0,1,0,0),this._checkedPoint.set(i,!1),!1}t.setTransform(this.transform),this.buildPath(t),t.setTransform(1,0,0,1,0,0);var a=t.isPointInPath(e,r);return this._checkedPoint.set(i,a),a},t.prototype.buildPath=function(t){N(t,0,0,this.width,this.height,this.style.borderRadius)},t.prototype.getParent=function(t){for(var e=this.parent;e;){if(t(e))return e;e=e.parent}},t.prototype._getBaseSize=function(t){var e=0;return this.parent?(e=this.parent[t],this.parent.style.border&&(e-=2*this.parent.style.border)):this.layer&&this.layer.canvas&&(e=this.layer.canvas[t]),Math.max(0,e)},t}(),K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="container",e.children=[],e._start=new Y,e}return n(e,t),Object.defineProperty(e.prototype,"needUpdate",{get:function(){return this._needUpdate},set:function(t){t!==this._needUpdate&&(!(this._needUpdate=t)||this.isStatic&&this._cached||this.children.forEach(function(t){return t.needUpdate=!0}))},enumerable:!0,configurable:!0}),e.prototype.attr=function(e,r){var i;return"string"==typeof e&&((i={})[e]=r,e=i),(Reflect.has(e,"clip")||Reflect.has(e,"border"))&&this.children.forEach(function(t){return t.needUpdate=!0}),t.prototype.attr.call(this,e,r),this},e.prototype.build=function(e){return a(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,t.prototype.build.call(this,e)];case 1:return r.sent(),this.style.clip&&N(e,this.style.border/2,this.style.border/2,this.width-2*this.style.border,this.height-2*this.style.border,this.style.borderRadius),e.setTransform(1,0,0,1,0,0),this.style.clip&&(e.save(),e.clip()),[2,this._renderChildren(e)]}})})},e.prototype.remove=function(t,e){if(void 0===e&&(e=!0),t){var r=this.children.findIndex(function(e){return e===t});0<=r&&(t.parent=null,this.children.splice(r,1),e&&t.dispose(),this.markDirty())}return this},e.prototype.add=function(t){var e=this;if(t){var r=t.parent||t.layer;if(r!==this){r&&r.remove(t,!1),t.parent=this,t.left=t.top=null,t.needUpdate=!0,t.index=this.children.length;var i=g(function(r){return t.style.zIndex-e.children[r].style.zIndex||1},this.children.length);this.children.splice(i,0,t),this.markDirty()}}return this},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.children.forEach(function(t){t.parent=null,t.dispose()}),this.children.length=0},e.prototype.setTransform=function(e){t.prototype.setTransform.call(this,e),e.translate(-this._start.x,-this._start.y)},e.prototype.buildCached=function(){return a(this,void 0,void 0,function(){var e,r;return s(this,function(i){switch(i.label){case 0:return e=null,this.style.clip?(e=new C(0,0,this.width,this.height),[3,3]):[3,1];case 1:return r=this.transform.invert(),[4,this._getMaxRect()];case 2:e=i.sent().transform(r),i.label=3;case 3:return this._start.x=-e.x,this._start.y=-e.y,[2,t.prototype.buildCached.call(this,e.w,e.h,this._start)]}})})},e.prototype.getTarget=function(t,e,r){for(var i=this.children.length-1;0<=i;i--){var n=this.children[i].getTarget(t,e,r);if(n)return n}return!!this._contain(t,e,r)&&this},e.prototype._renderChildren=function(t){var e=this;return new Promise(function(r){var i=function(n){return a(e,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return(e=this.children[n++])?(t.translate(this._start.x,this._start.y),[4,e.draw(t)]):[3,2];case 1:return o.sent(),i(n),[3,3];case 2:this.style.clip&&t.restore(),r(),o.label=3;case 3:return[2]}})})};i(0)})},e.prototype.update=function(){return a(this,void 0,void 0,function(){var e,r;return s(this,function(i){switch(i.label){case 0:return[4,t.prototype.update.call(this)];case 1:return i.sent(),this.needUpdate&&(e=this.isStatic,r=this,e||(r=this.getParent(function(t){return t}),e=!!r),e&&r._cached&&this._updateChildren()),[2]}})})},e.prototype._updateChildren=function(){this.children.forEach(function(t){t.beforeUpdate(),t.needUpdate=!0,t.getBoundingRect().then(function(){t.afterUpdate(),t.isPaint()&&(t.beforeBuild(),t.afterBuild())})})},e.prototype._getMaxRect=function(){return a(this,void 0,void 0,function(){var t,r,i,n,o,a,l,u;return s(this,function(s){switch(s.label){case 0:return[4,this.getBoundingRect()];case 1:i=s.sent().clone(),s.label=2;case 2:s.trys.push([2,7,8,9]),n=h(this.children),o=n.next(),s.label=3;case 3:return o.done?[3,6]:[4,(a=o.value)instanceof e?a._getMaxRect():a.getBoundingRect()];case 4:l=s.sent(),i.extend(l),s.label=5;case 5:return o=n.next(),[3,3];case 6:return[3,9];case 7:return u=s.sent(),t={error:u},[3,9];case 8:try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 9:return[2,i]}})})},e}(Z),Q=function(){function t(t,e,r){void 0===r&&(r=0),this.z=r,this.dirty=!0,this.roots=[],this._time=0,this.canvas=x(t,e,"layer"+r),this._drawCanvas=x(t,e,"layer_draw_"+r),this.ctx=this._drawCanvas.getContext("2d"),this._view=this.canvas.getContext("2d")}return t.prototype.add=function(t){var e=this;if(t){var r=t.parent||t.layer;if(r!==this){r&&r.remove(t,!1),t.layer=this,t.needUpdate=!0,t.left=t.top=null;var i=g(function(r){return t.style.zIndex-e.roots[r].style.zIndex||1},this.roots.length);this.roots.splice(i,0,t),this.dirty=!0}}return this},t.prototype.remove=function(t,e){if(void 0===e&&(e=!0),t){var r=this.roots.findIndex(function(e){return e===t});0<=r&&(t.layer=null,this.roots.splice(r,1),e&&t.dispose(),this.dirty=!0)}return this},t.prototype.dispose=function(t){this.roots.forEach(function(t){t.layer=null,t.dispose()}),this.roots.length=0,t.removeChild(this.canvas),this.canvas=this.ctx=this._drawCanvas=null},t.prototype.beforeRender=function(){},t.prototype.render=function(){this.beforeRender(),this.dirty&&(this.dirty=!1,this._time=Date.now(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._render(0))},t.prototype.afterRender=function(){this._view.clearRect(0,0,this.canvas.width,this.canvas.height),this._view.drawImage(this._drawCanvas,0,0)},t.prototype.getTarget=function(t,e){for(var r=this.roots.length-1;0<=r;r--){var i=this.roots[r].getTarget(this.ctx,t,e);if(i)return i}return!1},t.prototype.resize=function(t,e){var r=this;this.dirty=!0,this._resize(t,e,this.canvas),this._resize(t,e,this._drawCanvas),this.roots.forEach(function(t){r._clearCached(t),t.needUpdate=!0})},t.prototype._clearCached=function(t){t._cached=null,t instanceof K&&t.children.forEach(this._clearCached,this)},t.prototype._resize=function(t,e,r){Object.assign(r.style,{width:t+"px",height:e+"px"}),r.width=t*_,r.height=e*_},t.prototype._render=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(r){switch(r.label){case 0:return(e=this.roots[t++])?[4,e.draw(this.ctx)]:[3,2];case 1:return r.sent(),this._render(t),[3,3];case 2:this.afterRender(),r.label=3;case 3:return[2]}})})},t}(),$=["dbclick","click","mousedown","mouseup","mousemove","touchstart","touchmove","touchend"],G=function(){function t(t){var e=this;this._root=t,this._layers=new Map,this._isOut=!1,this._eventHandler=function(t){if(!e._isOut){t=t||window.event;var r=function(t,e){if(null!=e.offsetX&&null!=e.offsetY)return{x:e.offsetX,y:e.offsetY};if(t.getBoundingClientRect){var r=t.getBoundingClientRect(),i=e.clientX,n=e.clientY;if(e.touches){if(!e.touches.length)return{x:0,y:0};i=e.touches[0].clientX,n=e.touches[0].clientY}return{x:i-r.left,y:n-r.top}}return{x:0,y:0}}(e._root,t),i=r.x,n=r.y;i*=_,n*=_;var o=e._getTarget(i,n),a={x:i,y:n,target:o,cancelBubble:!1};"mousemove"!==t.type&&"touchmove"!==t.type||e._moveHandler(a,t,t.type),o&&"mousemove"!==t.type&&"touchmove"!==t.type&&o.notifyEvent(t.type,t,a)}},this._leave=function(){return e._isOut=!0},this._enter=function(){return e._isOut=!1},Object.assign(t.style,{"-webkit-tap-highlight-color":"transparent","-webkit-user-select":"none","user-select":"none","-webkit-touch-callout":"none","touch-action":"none"}),t.innerHTML="",["relative","absolute","fixed"].includes(t.style.position)||(t.style.position="relative"),$.forEach(function(t){P(e._root,t,e._eventHandler)}),P(t,"mouseleave",this._leave),P(t,"mouseenter",this._enter)}return Object.defineProperty(t.prototype,"width",{get:function(){return this._root?this._root.offsetWidth:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._root?this._root.offsetHeight:0},enumerable:!0,configurable:!0}),t.prototype.getLayer=function(t){return this._layers.get(t)},t.prototype.render=function(){this._layers.forEach(function(t){return t.render()}),this._root&&(this._timer=requestAnimationFrame(this.render.bind(this)))},t.prototype.addLayer=function(t){var e="number"==typeof t?t:t.z;return this._layers.has(e)?console.warn("层级"+e+"已存在"):("number"==typeof t&&(t=new Q(this._root.offsetWidth,this._root.offsetHeight,t)),this._addLayerToDom(t)._layers.set(e,t)),this},t.prototype.replaceLayer=function(t){var e=this._layers.get(t.z);return e&&e.dispose(this._root),this._addLayerToDom(t)._layers.set(t.z,t),this},t.prototype.removeLayer=function(t){var e="number"==typeof t?t:t.z,r=this._layers.get(e);return r&&(r.dispose(this._root),this._layers.delete(e)),this},t.prototype.dispose=function(){var t=this;this._timer&&cancelAnimationFrame(this._timer),this._layers.forEach(this.removeLayer,this),this._root&&($.forEach(function(e){S(t._root,e,t._eventHandler)}),S(this._root,"mouseleave",this._leave),S(this._root,"mouseenter",this._enter)),this._root=this._preTarget=null},t.prototype.resize=function(){var t=this;this._layers.forEach(function(e){return e.resize(t._root.offsetWidth,t._root.offsetHeight)})},t.prototype._addLayerToDom=function(t){var e,r;try{for(var i=h(Array.from(this._layers.values())),n=i.next();!n.done;n=i.next()){var o=n.value;if(o.z>t.z)return this._root.insertBefore(t.canvas,o.canvas),this}}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return this._root.appendChild(t.canvas),this},t.prototype._getTarget=function(t,e){var r,i,n=Array.from(this._layers.keys()).sort(function(t,e){return e-t});try{for(var o=h(n),a=o.next();!a.done;a=o.next()){var s=a.value,l=this._layers.get(s).getTarget(t,e);if(l)return l}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},t.prototype._moveHandler=function(t,e,r){this._preTarget===t.target?t.target&&t.target.notifyEvent(r,e,t):(this._preTarget&&this._preTarget.notifyEvent("mouseout",e,o({},t,{relatedTarget:t.target})),t.target&&t.target.notifyEvent("mouseover",e,o({},t,{relatedTarget:this._preTarget}))),this._preTarget=t.target},t}(),J=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="image",i._cellId=-1,i.style.width=i.style.height=0,i}return n(e,t),e.prototype.attr=function(e,r){var i;"string"==typeof e&&((i={})[e]=r,e=i),this._setCell(e);var n=Reflect.has(e,"src")&&e.src!==this.style.src;return t.prototype.attr.call(this,e,r),!n||this.style.width&&this.style.height||(this.needUpdate=!0),this},e.prototype.build=function(t){return a(this,void 0,void 0,function(){var e,r,i,n,o,a;return s(this,function(s){switch(s.label){case 0:return[4,this.style.loadImg()];case 1:return(e=s.sent())&&(r=Math.min(k(this._cellWidth,e.width),e.width),i=Math.min(k(this._cellHeight,e.height),e.height),0<=this._cellId&&0<r&&0<i?(n=Math.floor(this._cellId+1)*r,o=n%e.width-r,a=Math.floor(n/e.width)*i,y(n%e.width)&&(o=e.width-r,a-=i),o=Math.max(Math.min(o,e.width-r),0),a=Math.max(Math.min(a,e.height-i),0),t.drawImage(e,o,a,r,i,0,0,this.width,this.height)):t.drawImage(e,0,0,this.width,this.height)),[2]}})})},e.prototype.update=function(){return this.style.background="",this.style.border=0,t.prototype.update.call(this)},e.prototype.calcSize=function(){return a(this,void 0,void 0,function(){var e;return s(this,function(r){switch(r.label){case 0:return t.prototype.calcSize.call(this),this.width<=0||this.height<=0?[4,this.style.loadImg()]:[3,2];case 1:(e=r.sent())&&(this.width<=0&&this.height<=0?(this.width=e.width,this.height=e.height):this.width<=0?this.width=this.height*e.width/e.height:this.height<=0&&(this.height=this.width*e.height/e.width)),r.label=2;case 2:return[2]}})})},e.prototype._setCell=function(t){var e=this;["cellId","cellWidth","cellHeight"].forEach(function(r){Reflect.has(t,r)&&(Reflect.set(e,"_"+r,Reflect.get(t,r)),Reflect.deleteProperty(t,r))})},e}(Z),tt=c(function(t,e){return t.split("\n").reduce(function(t,r){return Math.max(t,et(r,e))},0)},5e3),et=c(function(t,e){var r=M(null);return e&&r.font!==e&&(r.font=e),r.measureText(t).width}),rt=p("fontStyle fontVariant fontWeight fontSize fontFamily"),it=p("lineHeight letterSpacing textWarp indent strokeWidth text"),nt=function(t){function e(e,r){void 0===r&&(r=!0);var i=t.call(this,e,r)||this;return i.type="text",i.text="",i.textMap=[],i._textAlign="left",i._verticalAlign="top",i._strokeColor="rgba(0, 0, 0, 1)",i._strokeWidth=0,i._lineHeight=0,i._letterSpacing=0,i._textWarp="warp",i._indent=0,i._font=[null,null,null,"12px","sans-serif"],i._modifyText=!1,i.style.height=0,i.style.color="",i}return n(e,t),Object.defineProperty(e.prototype,"fontStyle",{set:function(t){this._setFont(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontVariant",{set:function(t){this._setFont(t,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{set:function(t){"number"==typeof t&&(t=""+t),this._setFont(t,2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{set:function(t){t="number"==typeof t?t*_+"px":t.replace(/^(\d+)(.*)$/,function(t,e,r){return+(e||12)*_+(r||"px")}),this._setFont(t,3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{set:function(t){this._setFont(t,4)},enumerable:!0,configurable:!0}),e.prototype.build=function(e){return a(this,void 0,void 0,function(){var r,i,n,o=this;return s(this,function(a){switch(a.label){case 0:return(r=this.textMap[this.textMap.length-1])?this.style.background?[4,t.prototype.build.call(this,e)]:[3,2]:[3,3];case 1:a.sent(),a.label=2;case 2:"top"!==e.textBaseline&&(e.textBaseline="top"),(i=this.style.color||(this.parent?this.parent.style.color:""))&&!B(e.fillStyle,i)&&(e.fillStyle=i),this._strokeWidth&&!B(e.strokeStyle,this._strokeColor)&&(e.strokeStyle=this._strokeColor),(n=this._font.filter(function(t){return null!=t&&""!==t}).join(" "))&&e.font!==n&&(e.font=n),this.textMap.forEach(function(t){var i=o._adjustX(r,t),n=o._adjustY(r,t);o._strokeWidth&&e.strokeText(t.char,i,n),e.fillText(t.char,i,n)}),a.label=3;case 3:return this.isStatic&&(this.textMap.length=0),[2]}})})},e.prototype.setTextStyle=function(t,e){return this._modifyText=!1,"string"==typeof t?this._setTextStyle([t,e]):Object.entries(t).forEach(this._setTextStyle,this),this._modifyText&&!this.isStatic&&(!this.style.height&&null==this.style.top||!this.style.width&&null==this.style.left?this.needUpdate=!0:this.needUpdate||this._parseText()),this},e.prototype.beforeUpdate=function(){t.prototype.beforeUpdate.call(this),this.style.border=0},e.prototype.calcSize=function(){if(t.prototype.calcSize.call(this),this._parseText(),this.height<=0){this.height=0;var e=this.textMap[this.textMap.length-1];e&&(this.height=e.y+e.height)}},e.prototype._parseText=function(){var t,e;if(this.textMap.length=0,this.isStatic&&this._cached)return this.width=this._cached.width,void(this.height=this._cached.height);if(this.text){var r=this._font.filter(function(t){return null!=t&&""!==t}).join(" "),i=this._lineHeight||tt("国",r);this.style.width&&this.width||(this.width=1/0);var n=tt("...",r),o=this.text.replace(/\n*$/,"").split("\n"),a={y:0,lineHeight:i,font:r,ellipsisWidth:n},s=0;try{for(var l=h(o),u=l.next();!u.done;u=l.next()){var c=u.value;this._setTextMap(c,a);var d=this.textMap[this.textMap.length-1];if(d&&(s=Math.max(s,d.x+d.width)),a.y+=i,0<this.height&&a.y>this.height)break}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}this.width===1/0&&(this.width=s)}},e.prototype._setTextMap=function(t,e){var r=0;this.textMap.length||(r+=this._indent);for(var i=0;i<t.length;i++){i&&(r+=this._letterSpacing);var n=tt(t[i],e.font)+this._strokeWidth,o={char:t[i],x:r,y:e.y,width:n,height:e.lineHeight};if((r+=n)>this.width){if("warp"!==this._textWarp)return this._addEllipsis(o,e.ellipsisWidth);if(o.x=0,r=n,o.y+=e.lineHeight,e.y+=e.lineHeight,0<this.height&&e.y>this.height)return}else if("ellipsis"===this._textWarp&&i<t.length-1&&r+e.ellipsisWidth>this.width)return this._addEllipsis(o,e.ellipsisWidth);this.textMap.push(o)}},e.prototype._addEllipsis=function(t,e){"ellipsis"===this._textWarp&&(t.char="...",t.width=e,this.textMap.push(t))},e.prototype._setFont=function(t,e){t!==this._font[e]&&(this._font[e]=t,this._modifyText=!0,this.markDirty())},e.prototype._setTextStyle=function(t){var e=l(t,2),r=e[0],i=e[1];if(rt(r))this[r]=i;else{var n="text"===r?r:"_"+r;"number"==typeof i&&(i*=_),Reflect.get(this,n)!==i&&(Reflect.set(this,n,i),it(r)&&(this._modifyText=!0),this.markDirty())}},e.prototype._adjustX=function(t,e){var r=this.width-t.x-t.width;if(0<r&&e.y===t.y){if("center"===this._textAlign)return e.x+r/2;if("right"===this._textAlign)return e.x+r}return e.x},e.prototype._adjustY=function(t,e){var r=this.height-t.y-t.height;if(0<r){if("middle"===this._verticalAlign)return e.y+r/2;if("bottom"===this._verticalAlign)return e.y+r}return e.y},e}(Z),ot=["width","height","scaleX","scaleY","rotation","left","right","top","bottom","opacity","color","background","cellId"],at=Reflect.construct(r(0),[]);at.addEventListener("message",function(t){var e=t.data.animation.id,r=lt.get(e);r&&r.message(t.data)}),at.addEventListener("error",function(t){console.error(t),at.terminate()});var st,ht,lt=new Map,ut=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=1),void 0===r&&(r=0),void 0===i&&(i="linear"),this.time=t,this.count=e,this.delay=r,this.easing=i,this.el=new Map,this.id=ct++,this._endCall=new Set,this._startTime=0,this._pauseTime=0,this._prevTime=0,this._isStart=!1,this._isPause=!1,this.width={},this.height={},this.scaleX={},this.scaleY={},this.rotation={},this.left={},this.right={},this.top={},this.bottom={},this.opacity={},this.color={},this.background={},this.cellId={},this.errKey=new Set,lt.set(this.id,this)}return t.prototype.addFrame=function(t,e,r){var i=this;if(void 0===r&&(r=!0),this.errKey.clear(),t=this._parseFrame(t),Reflect.has(e,"scale")){var n=Array.isArray(e.scale)?e.scale:[e.scale,e.scale];e.scaleX=n[0],e.scaleY=n[1]}return ot.forEach(function(n){var o=Reflect.get(e,n),a=Reflect.get(i,n);""===o||!r&&Reflect.has(a,t)||("number"==typeof o||"string"==typeof o?("color"!==n&&"background"!==n||(o=q(o)),Reflect.set(a,t,o)):null!=o&&console.warn("只能用number及string类型设置动画"))}),this},t.prototype.addElement=function(t){if(!this.el.has(t)){var e=t.style,r={width:e.width,height:e.height,rotation:e.rotation,left:e.left,right:e.right,top:e.top,bottom:e.bottom,opacity:e.opacity,scaleX:e.scale[0],scaleY:e.scale[1]};"string"==typeof e.color&&(r.color=q(e.color)),"string"!=typeof e.background||f(e.background)||(r.background=q(e.background)),t instanceof J&&(r.cellId=0),this.el.set(t,r),t.animation!==this&&(t.animation=this)}return this},t.prototype.addEndCall=function(t){return this._endCall.add(t),this},t.prototype.removeEndCall=function(t){return this._endCall.delete(t),this},t.prototype.dispose=function(){this._timer&&cancelAnimationFrame(this._timer),this._endCall.clear(),this.el.forEach(function(t){return t.animation=null}),this.el.clear(),lt.delete(this.id)},t.prototype.start=function(t){void 0===t&&(t=Date.now()),this._isStart||(this.stop(),this._startTime=t+this.delay,this._isStart=!0,this._pauseTime=this._prevTime=0,this._play()),this._isPause=!1},t.prototype.pause=function(){this._isPause=!0},t.prototype.stop=function(){this._isStart=this._isPause=!1,this._timer&&cancelAnimationFrame(this._timer)},t.prototype.notify=function(){this._endCall.forEach(function(t){return t()})},t.prototype.message=function(t){Object.assign(this,t.animation),this.el.forEach(function(e,r){var i=t.attrs.get(r.id);i&&r.attr(i)}),t.isEnd&&this._end()},t.prototype._end=function(){this.stop(),this.notify(),0<--this.count&&this.start()},t.prototype._play=function(){var t=this;if(this._isStart&&this.el.size){var e=Date.now();e>=this._startTime&&at.postMessage(this._createMsg(e)),this._timer=requestAnimationFrame(function(){return t._play()})}},t.prototype._parseFrame=function(t){var e;return"string"==typeof t?(e=parseFloat(t)||0,t.endsWith("%")&&(e/=100)):e=t,Math.max(0,Math.min(e,1))},t.prototype._createMsg=function(t){var e=o({},this);return e.el=new Map,delete e._endCall,this.el.forEach(function(t,r){return e.el.set(r.id,t)}),{animation:e,now:t}},t}(),ct=1e3,dt=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.type="stack",i._isVertical=!0,i.style.width=i.style.height=0,i}return n(e,t),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(t){t!==this._isVertical&&(this._isVertical=t,this.needUpdate=!0)},enumerable:!0,configurable:!0}),e.prototype.remove=function(e,r){return void 0===r&&(r=!0),t.prototype.remove.call(this,e,r),this.style.width&&this.style.height||(this.needUpdate=!0),this},e.prototype.add=function(e){return t.prototype.add.call(this,e),this.style.width&&this.style.height||(this.needUpdate=!0),this},e.prototype.calcSize=function(){return a(this,void 0,void 0,function(){var e,r,i,n,o,a,h;return s(this,function(s){switch(s.label){case 0:return t.prototype.calcSize.call(this),e="height",r="width",i="top",this._isVertical||(e="width",i="left",r="height"),n=this[e],this[e]=this.getParentSize(e),[4,this._calcSize(e,i,r)];case 1:return o=l.apply(void 0,[s.sent(),2]),a=o[0],h=o[1],this[e]=n||a+2*this.style.border,this[r]=this[r]||h+2*this.style.border,[2]}})})},e.prototype._calcSize=function(t,e,r){return a(this,void 0,void 0,function(){var i,n,o,a,l,u,c,d,f,p;return s(this,function(s){switch(s.label){case 0:a=o=0,l="left"===e?"right":"bottom",u=Array.from(this.children).sort(function(t,e){return t.index-e.index}),s.label=1;case 1:s.trys.push([1,7,8,9]),c=h(u),d=c.next(),s.label=2;case 2:return d.done?[3,6]:(f=d.value,o+=k(f.style[e],0),f[e]=o,f.isStatic&&f._cached?[3,4]:[4,f.calcSize()]);case 3:s.sent(),s.label=4;case 4:o+=f[t]+k(f.style[l],0),a=Math.max(a,f[r]),f.isVisible=!!f[t]&&f.isVisible,s.label=5;case 5:return d=c.next(),[3,2];case 6:return[3,9];case 7:return p=s.sent(),i={error:p},[3,9];case 8:try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}return[7];case 9:return[2,[o,a]]}})})},e}(K),ft=function(t){function e(e){var r=t.call(this,e)||this;return r.type="scroll",r.children=[],r.move=0,r.more=10,r.maxMove=0,r._isVertical=!0,r._isDown=!1,r._downPoint=0,r._upCall=function(){r._isDown=!1,(0<r.move||r.move<-r.maxMove)&&(r.move=Math.min(0,Math.max(r.move,-r.maxMove)),r.children[0].needUpdate=!0,r.markDirty())},t.prototype.add.call(r,new dt("__scroll__"+e).attr("zIndex",-Number.MAX_VALUE)),r.events.on("mousedown",r._downCall),r.events.on("mousemove",r._moveCall),r.events.on("touchstart",r._downCall),r.events.on("touchmove",r._moveCall),P(document,"mouseup",r._upCall),P(document,"touchend",r._upCall),r}return n(e,t),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(t){t!==this._isVertical&&(this._isVertical=t,this.move=0,this.needUpdate=!0,this.children[0].isVertical=t)},enumerable:!0,configurable:!0}),e.prototype.remove=function(e,r){return void 0===r&&(r=!0),this.children.length||t.prototype.add.call(this,new dt("__scroll__0").attr("zIndex",-Number.MAX_VALUE)),this.children[0].remove(e,r),this},e.prototype.add=function(e){return this.children.length||t.prototype.add.call(this,new dt("__scroll__0").attr("zIndex",-Number.MAX_VALUE)),this.children[0].add(e),this},e.prototype.dispose=function(){t.prototype.dispose.call(this),S(document,"mouseup",this._upCall),S(document,"touchend",this._upCall)},e.prototype.beforeUpdate=function(){t.prototype.beforeUpdate.call(this),this.style.clip=!0,this.children.length=1;var e=this.children[0];e[this._isVertical?"top":"left"]=this.move,e.isVertical=this._isVertical,e.isStatic=this.isStatic=!1,this._setBuild(e)},e.prototype.getTarget=function(e,r,i){var n=t.prototype.getTarget.call(this,e,r,i);return n===this.children[0]?this:n},e.prototype._downCall=function(t){this._isDown=!0,this._downPoint=this._isVertical?t.y:t.x},e.prototype._moveCall=function(t,e){if(this._isDown){e.preventDefault?e.preventDefault():e.returnValue=!1;var r=((this._isVertical?t.y:t.x)-this._downPoint)/_,i=this._isVertical?"height":"width";this.maxMove=this.children[0][i]-this[i]+2*this.style.border,.001<Math.abs(r)&&1<=this.maxMove&&(this.move+=r,this.move=Math.min(this.more,Math.max(this.move,-this.maxMove-this.more)),this.children[0].needUpdate=!0,this.markDirty(),this.notifyEvent("scroll",null,t))}},e.prototype._setBuild=function(t){if(!t.hasOwnProperty("buildCached")){var e=this._isVertical?"height":"width",r=this;t.buildCached=function(){return a(this,void 0,void 0,function(){var t,i;return s(this,function(n){switch(n.label){case 0:return t=this.transform.invert(),[4,this._getMaxRect()];case 1:return(i=n.sent().transform(t))[e[0]]>r[e]&&(i[this._isVertical?"y":"x"]=-r.move,i[e[0]]=r[e]),this._start.x=-i.x,this._start.y=-i.y,[2,Z.prototype.buildCached.call(this,i.w,i.h,this._start)]}})})}}},e}(K),pt=c(function(t){if((t=Math.trunc(t))<0)return[];var e=[];e[0]=e[1]=1;for(var r=3;r<=t;r++){var i=e.slice(0,r-1);e[0]=e[r-1]=1;for(var n=0;n<r-2;n++)e[n+1]=i[n]+i[n+1]}return e});function yt(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var i=e.length-1,n=pt(i+1);return e.reduce(function(e,r,o){return e+n[o]*r*Math.pow(1-t,i-o)*Math.pow(t,o)},0)}function gt(t,e,r,i){var n=9*e+3*i-3*t-9*r,o=6*r-12*e+6*t,a=3*e-3*t,s=[];if(y(n))y(o)||0<=(l=-a/o)&&l<=1&&s.push(l);else{var h=o*o-4*n*a;if(!y(h)&&0<h){var l,u=Math.sqrt(h),c=(-o-u)/(2*n);0<=(l=(-o+u)/(2*n))&&l<=1&&s.push(l),0<=c&&c<=1&&s.push(c)}}return s}function vt(t,e,r){var i=t+r-2*e;return 0===i?.5:Math.max(Math.min((t-e)/i,1),0)}function mt(t,e,r,i){return[Y.createMin([t,r],[e,i]),Y.createMax([t,r],[e,i])]}function bt(t,e,r,i,n,o,a,s){var h=Y.createMin([t,a],[e,s]),l=Y.createMax([t,a],[e,s]);return gt(t,r,n,a).forEach(function(e){var i=yt(e,t,r,n,a);h.x=Math.min(h.x,i),l.x=Math.max(l.x,i)}),gt(e,i,o,s).forEach(function(t){var r=yt(t,e,i,o,s);h.y=Math.min(h.y,r),l.y=Math.max(l.y,r)}),[h,l]}function _t(t,e,r,i,n,o,a){var s=Math.abs(n-o),h=2*Math.PI;if(s%h<1e-4&&1e-4<s)return[new Y(t-r,e-i),new Y(t+r,e+i)];var l=[],u=[];l[0]=Math.cos(n)*r+t,l[1]=Math.cos(o)*r+t,u[0]=Math.sin(n)*i+e,u[1]=Math.sin(o)*i+e;var c=Y.createMin(l,u),d=Y.createMax(l,u);if((n%=h)<0&&(n+=h),(o%=h)<0&&(o+=h),o<n&&!a?o+=h:n<o&&a&&(n+=h),a){var f=o;o=n,n=f}for(var p=0;p<o;p+=Math.PI/2)if(n<p){var y=new Y(Math.cos(p)*r+t,Math.sin(p)*i+e);c.toMin(y),d.toMax(y)}return[c,d]}(ht=st||(st={}))[ht.M=1]="M",ht[ht.L=2]="L",ht[ht.C=3]="C",ht[ht.Q=4]="Q",ht[ht.A=5]="A",ht[ht.Z=6]="Z",ht[ht.R=7]="R";var wt=function(){function t(){this.lineDash=[],this._len=0}return Object.defineProperty(t.prototype,"context",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"len",{get:function(){return this._len},enumerable:!0,configurable:!0}),t.prototype.beginPath=function(t){return this._ctx=t,this._len=0,t&&(t.beginPath(),t.setLineDash(this.lineDash)),this},t.prototype.moveTo=function(t,e){return this.addData(st.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this},t.prototype.lineTo=function(t,e){return this.addData(st.L,t,e),this._ctx&&this._ctx.lineTo(t,e),this},t.prototype.bezierCurveTo=function(t,e,r,i,n,o){return this.addData(st.C,t,e,r,i,n,o),this._ctx&&this._ctx.bezierCurveTo(t,e,r,i,n,o),this},t.prototype.quadraticCurveTo=function(t,e,r,i){return this.addData(st.Q,t,e,r,i),this._ctx&&this._ctx.quadraticCurveTo(t,e,r,i),this},t.prototype.arc=function(t,e,r,i,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),Array.isArray(t)||(t=[t,t]),Array.isArray(e)||(e=[e,e]),this.addData(st.A,t[0],t[1],e[0],e[1],r,i,n,o),this._ctx&&X(this._ctx,t[0],t[1],e[0],e[1],r,i,n,o),this},t.prototype.rect=function(t,e,r,i){return this.addData(st.R,t,e,r,i),this._ctx&&this._ctx.rect(t,e,r,i),this},t.prototype.closePath=function(){return this.addData(st.Z),this._ctx&&this._ctx.closePath(),this},t.prototype.setData=function(t){var e=this._len=t.length;this.data&&this.data.length===e||(this.data=new Float32Array(e));for(var r=0;r<e;r++)this.data[r]=t[r];return this},t.prototype.appendPath=function(t){var e=this;Array.isArray(t)||(t=[t]);var r=t.reduce(function(t,e){return t+e.len},0);return this.data=new Float32Array(this._len+r),t.forEach(function(t){if(t.data)for(var r=0;r<t.data.length;r++)e.data[e._len++]=t.data[r]}),this},t.prototype.getBoundingRect=function(){for(var t,e,r,i,n,o,a,s,h,u,c,d,f,p=new Y(Number.MAX_VALUE),y=new Y(-Number.MAX_VALUE),g=this.data||[],v=0,m=0,b=0,_=0,w=0;w<this._len;){var x=new Y(Number.MAX_VALUE),M=new Y(-Number.MAX_VALUE);switch(w||(b=v=g[w+1],_=m=g[w+2]),g[w++]){case st.M:x.x=M.x=v=b=g[w++],x.y=M.y=m=_=g[w++];break;case st.L:x=(t=l(mt(v,m,g[w],g[w+1]),2))[0],M=t[1],v=g[w++],m=g[w++];break;case st.C:x=(e=l(bt(v,m,g[w++],g[w++],g[w++],g[w++],g[w],g[w+1]),2))[0],M=e[1],v=g[w++],m=g[w++];break;case st.Q:x=(r=l((o=v,a=m,s=g[w++],h=g[w++],u=g[w],c=g[w+1],d=yt(vt(o,s,u),o,s,u),f=yt(vt(a,h,c),a,h,c),[Y.createMin([o,u,d],[a,c,f]),Y.createMax([o,u,d],[a,c,f])]),2))[0],M=r[1],v=g[w++],m=g[w++];break;case st.A:var k=1===w,P=g[w++],S=g[w++],T=g[w++],A=g[w++],O=g[w++],I=g[w++];w++;var E=1-g[w++];k&&(b=Math.cos(O)*T+P,_=Math.sin(O)*A+S),x=(i=l(_t(P,S,T,A,O,I,E),2))[0],M=i[1],v=Math.cos(I)*T+P,m=Math.sin(I)*A+S;break;case st.R:b=v=g[w++],_=m=g[w++],x=(n=l(mt(v,m,v+g[w++],m+g[w++]),2))[0],M=n[1];break;case st.Z:v=b,m=_}p.toMin(x),y.toMax(M)}return new C(p.x,p.y,y.x-p.x,y.y-p.y)},t.prototype.rebuildPath=function(t){for(var e=this.data||[],r=0;r<this._len;)switch(e[r++]){case st.M:t.moveTo(e[r++],e[r++]);break;case st.L:t.lineTo(e[r++],e[r++]);break;case st.C:t.bezierCurveTo(e[r++],e[r++],e[r++],e[r++],e[r++],e[r++]);break;case st.Q:t.quadraticCurveTo(e[r++],e[r++],e[r++],e[r++]);break;case st.A:X(t,e[r++],e[r++],e[r++],e[r++],e[r++],e[r++],e[r++],e[r++]);break;case st.R:t.rect(e[r++],e[r++],e[r++],e[r++]);break;case st.Z:t.closePath();break;default:return void console.error("data数据错误。未找到对应的绘图命令: "+e[r-1])}},t.prototype.addData=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.data;return(!i||this._len+e.length>i.length)&&(i=this._expandData()),e.forEach(function(e){return i[t._len++]=e}),this.toStatic(i),this},t.prototype._expandData=function(){var t=[];if(this.data)for(var e=0;e<this._len;e++)t[e]=this.data[e];return t},t.prototype.toStatic=function(t){Array.isArray(t)&&(t.length=this._len,this.data=new Float32Array(t))},t.CMD=st,t}(),xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._path=new wt,e}return n(e,t),e.prototype.moveTo=function(t,e){return this._path.moveTo(t,e),this},e.prototype.lineTo=function(t,e){return this._path.lineTo(t,e),this},e.prototype.bezierCurveTo=function(t,e,r,i,n,o){return this._path.bezierCurveTo(t,e,r,i,n,o),this},e.prototype.quadraticCurveTo=function(t,e,r,i){return this._path.quadraticCurveTo(t,e,r,i),this},e.prototype.arc=function(t,e,r,i,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),this._path.arc(t,e,r,i,n,o),this},e.prototype.rectPath=function(t,e,r,i){return this._path.rect(t,e,r,i),this},e.prototype.closePath=function(){return this._path.closePath(),this},e.prototype.setData=function(t){return this._path.setData(t),this},e.prototype.appendPath=function(t){return this._path.appendPath(t),this},e.prototype.build=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this._path.len?(this.buildPath(t),[4,this.style.build(t,this.width,this.height)]):[2];case 1:return e.sent(),this.style.background&&t.fill(),t.stroke(),[2]}})})},e.prototype.buildCached=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(r){switch(r.label){case 0:return(t=document.createElement("canvas")).width=this.getParentSize("width"),t.height=this.getParentSize("height"),e=t.getContext("2d"),[4,this.build(e)];case 1:return r.sent(),[2,t]}})})},e.prototype.getBoundingRect=function(){return this._needUpdate&&(this.update(),this.rect.transform(this.transform),this._needUpdate=!1),Promise.resolve(this.rect)},e.prototype.beforeUpdate=function(){t.prototype.beforeUpdate.call(this),this.style.border=this.style.border||1},e.prototype.calcSize=function(){t.prototype.calcSize.call(this);var e=this._path.getBoundingRect();this.width=e.w,this.height=e.h,e.w+=this.style.border,e.h+=this.style.border,this.rect=e},e.prototype.updateTransform=function(){this.transform.toUnit(),this.parent&&this.transform.transform(this.parent.transform)},e.prototype.buildPath=function(t){t.beginPath(),this._path.rebuildPath(t)},e}(Z);r.d(e,"Layer",function(){return Q}),r.d(e,"Engine",function(){return G}),r.d(e,"Canvas2DElement",function(){return Z}),r.d(e,"Container",function(){return K}),r.d(e,"Canvas2DImage",function(){return J}),r.d(e,"TextBlock",function(){return nt}),r.d(e,"Canvas2DAnimation",function(){return ut}),r.d(e,"Stack",function(){return dt}),r.d(e,"Scroll",function(){return ft}),r.d(e,"PathElement",function(){return xt}),r.d(e,"Path",function(){return wt}),r.d(e,"devicePixelRatio",function(){return _})}])});
//# sourceMappingURL=ws-gui.js.map